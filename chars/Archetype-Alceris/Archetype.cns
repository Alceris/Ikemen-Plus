[Data]
life = 1000
power = 7000
attack = 100;000
defence = 100
fall.defence_up = 50
liedown.time = 30
airjuggle = 15
sparkno = 2
guard.sparkno = 40
KO.echo = 0
volume = 255			
IntPersistIndex = 0
FloatPersistIndex = 0

[Size]
xscale = 1.00
yscale = 1.00
ground.back = 15
ground.front = 15
air.back = 15
air.front = 15
height = 65
attack.dist = 160
proj.attack.dist = 90
proj.doscale = 0
head.pos = -7, -93
mid.pos = -2, -63
shadowoffset = 0
draw.offset = 0,0

[Velocity]
walk.fwd  = 3.7
walk.back = -3.7
run.fwd  = 8.7, 0
run.back = -10,-4
jump.neu = 0,-11
jump.back = -2.5
jump.fwd = 2.5
runjump.back = -4.5,-11
runjump.fwd = 7.395,-11
airjump.neu = 0,-5.4
airjump.back = -2.8
airjump.fwd = 2.8

[Movement]
airjump.num = 0
airjump.height = 54
yaccel = .52
stand.friction = .85
crouch.friction = .82

[Statedef 0]
type = S
physics = N
sprpriority = 0

[State 0, CtrlSet]
type = CtrlSet
trigger1 = roundstate = 2
value = 1

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = 0.85

[State 0, 1]
type = ChangeAnim
trigger1 = Anim != 0 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0 ;Turn anim over
value = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = P2Dist X < 0
value = 5

[State 0, Turn]
type = Turn
trigger1 = P2Dist X < 0

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0

[State 0, 2]
type = VelSet
trigger1 = 1
y = 0

[State 0, 3] ;Stop moving if low velocity or 4 ticks pass
type = Null;VelSet
trigger1 = abs(vel x) < Const(movement.stand.friction.threshold)
trigger2 = Time = 4
x = 0

[State 0, 4] ;Are you dead?
type = ChangeState
trigger1 = !alive
value = 5050
ctrl = 0

;---------------------------------------------------------------------------
; Stand to Crouch
[Statedef 10]
type    = C
physics = C
ctrl = 1

[State 0, Turn]
type = Turn
trigger1 = p2dist X < 0

[State 0, 1]
type = ChangeAnim
trigger1 = Anim != 10
value = 10

[State 10, 2] ;Stop moving if low velocity
type = VelSet
trigger1 = abs(vel x) < Const(movement.crouch.friction.threshold)
x = 0

[State 10, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; Crouching
[Statedef 11]
type    = C
physics = C
ctrl = 1
sprpriority = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = p2dist X < 0
value = 6

[State 0, Turn]
type = Turn
trigger1 = p2dist X < 0

[State 0, 1]
type = ChangeAnim
trigger1 = Anim != 11 && Anim != 6
trigger2 = Anim = 6 && AnimTime = 0 ;Turn anim over
value = 11

[State 11, 2] ;Stop moving if low velocity
type = VelSet
trigger1 = abs(vel x) < Const(movement.crouch.friction.threshold)
x = 0

;---------------------------------------------------------------------------
; Crouch to Stand
[Statedef 12]
type    = S
physics = S
ctrl = 1

[State 0, Turn]
type = Turn
trigger1 = p2dist X < 0

[State 0, 1]
type = ChangeAnim
trigger1 = Anim != 12
value = 12

[State 12, 1]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Walk
[Statedef 20]
type    = S
physics = S
ctrl = 1
sprpriority = 0

[State 20, 1]
type = VelSet
trigger1 = command = "holdfwd" && command != "holdback"
x = const(velocity.walk.fwd.x)

[State 20, 1]
type = VelSet
trigger1 = command = "holdback" && command != "holdfwd"
x = -const(velocity.walk.fwd.x)

[State 20, 3]
type = ChangeAnim
triggerall = vel x > 0
trigger1 = Anim != 20 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0
value = 20

[State 20, 3]
type = ChangeAnim
triggerall = vel x < 0
trigger1 = Anim != 21 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0
value = 21

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = P2Dist X < 0
value = 5

[State 0, Turn]
type = Turn
trigger1 = P2Dist X < 0

[Statedef 40]
type    = A
physics = N
;anim = 40
ctrl = 0
sprpriority = 1
facep2 = 0

[State 0, ChangeAnim]
type = Null;ChangeAnim
trigger1 = anim != 40
value = 40

[State 40, 1]
type = VarSet
trigger1 = !time
sysvar(1) = 0
ignorehitpause = 1

[State 40, 2]
type = VarSet
trigger1 = command = "holdfwd"
sysvar(1) = 1
ignorehitpause = 1

[State 40, 3]
type = VarSet
trigger1 = command = "holdback"
sysvar(1) = -1
ignorehitpause = 1

[State 40, 1]
type = VarSet
trigger1 = command = "holdfwd"
trigger1 = command = "holdback"
sysvar(1) = 0
ignorehitpause = 1

[State 40, 4]
type = VelSet
trigger1 = 1;AnimTime = 0
x = ifelse(sysvar(1)=0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x)))
y = const(velocity.jump.y)
ignorehitpause = 1

[State 40, 5]
type = VelSet
;trigger1 = AnimTime = 0
trigger1 = anim = 100 ;RUN_FWD
trigger1 = sysvar(1) = 1
x = const(velocity.runjump.fwd.x)
ignorehitpause = 1

[State 0, Turn]
type = Turn
;trigger1 = !AnimTime
trigger1 = p2dist X < 0
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = 1
sysvar(3) = 1

[State 40, 6]
type = ChangeState
triggerall = palno != 12
;trigger1 = AnimTime = 0
trigger1 = command = "holdback"
value = 132
anim = 43
ctrl = 1
;ignorehitpause = 1

[State 40, 6]
type = ChangeState
trigger1 = 1;AnimTime = 0
value = 50
ctrl = 1
;ignorehitpause = 1

[Statedef 45]
type    = A
physics = N
;anim = 40
ctrl = 0
sprpriority = 1
facep2 = 0

[State 0, ChangeAnim]
type = Null;ChangeAnim
trigger1 = anim != 40
value = 40

[State 40, 1]
type = VarSet
trigger1 = !time
sysvar(1) = 0
ignorehitpause = 1

[State 40, 2]
type = VarSet
trigger1 = command = "holdfwd"
sysvar(1) = 1
ignorehitpause = 1

[State 40, 3]
type = VarSet
trigger1 = command = "holdback"
sysvar(1) = -1
ignorehitpause = 1

[State 40, 1]
type = VarSet
trigger1 = command = "holdfwd"
trigger1 = command = "holdback"
sysvar(1) = 0
ignorehitpause = 1

[State 40, 4]
type = VelSet
trigger1 = 1;AnimTime = 0
x = ifelse(sysvar(1)=0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x)))
y = const(velocity.jump.y)
ignorehitpause = 1

[State 0, Turn]
type = Turn
;trigger1 = !AnimTime
trigger1 = p2dist X < 0
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = !hitpausetime
anim = 13490
ID = 13490
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = 0
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = 1
sysvar(3) = 2

[State 40, 6]
type = ChangeState
triggerall = palno != 12
;trigger1 = AnimTime = 0
trigger1 = command = "holdback"
value = 132
anim = 43
ctrl = 1
;ignorehitpause = 1

[State 40, 6]
type = ChangeState
trigger1 = 1;AnimTime = 0
value = 50
anim = 41
ctrl = 1
;ignorehitpause = 1

;---------------------------------------------------------------------------
; Jump Up
[Statedef 50]
type    = A
physics = A
ctrl = 1

[State 50, 1]
type = VarSet
trigger1 = !time
sysvar(1) = 0

[State 50, 2]
type = ChangeAnim
trigger1 = anim != [41,44]
value = ifelse((vel x)=0, 41, ifelse((vel x)>0, 42, 43))

[State 50, 3]
type = ChangeAnim
trigger1 = Vel y > 0
trigger1 = anim != 44
value = 44

[State 0, VelSet]
type = VelSet
triggerall = ctrl
trigger1 = command = "holdfwd" && command != "holdback"
trigger1 = vel X < const(velocity.walk.fwd.x)
trigger2 = command = "holdback" && command != "holdfwd"
trigger2 = vel X > -const(velocity.walk.fwd.x)
x = ifelse(command = "holdback",-const(velocity.walk.fwd.x),const(velocity.walk.fwd.x))

[Statedef 52]
type    = S
physics = N
ctrl = 1
;anim = 47

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 47
value = 47

[State 52, 1]
type = VelSet
trigger1 = animelem = 1
y = 0

[State 52, 2]
type = PosSet
trigger1 = animelem = 1
y = 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 52, 5]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

[Statedef 100]
type    = S
movetype = I
physics = N
;anim = 100
sprpriority = 1
ctrl = 1

[State 100, イントロムーバー消去]
type = DestroySelf
trigger1 = Ishelper

[State 0, Turn]
type = Turn
trigger1 = p2dist X < 0

[State 100, 通常]
type = VelSet
triggerall = !time
trigger1 = (command = "holdright" && command != "holdleft") || (command != "holdright" && command = "holdleft")
x = ifelse((command = "holdleft" && facing = 1) || (command = "holdright" && facing = -1),-const(velocity.run.fwd.x),const(velocity.run.fwd.x))
y = 0

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = (command = "holdright" && command != "holdleft") || (command != "holdright" && command = "holdleft")
trigger1 = anim != ifelse(vel X < 0,105,100)
value = ifelse(vel X < 0,105,100)

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(3) = 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(4) = 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(6) = 0

[State 100, SE]
type = PlaySnd
trigger1 = !time
value = S20, 4

[State 100, ボイス]
type = Null;PlaySnd
trigger1 = animelem = 1
trigger1 = random%10 < 6
value = S100, 91
channel = 4

[State 100, 2]
type = AssertSpecial
trigger1 = 1
flag = NoWalk
flag2 = NoAutoTurn
flag3 = NoGuard

[State 100, 4]
type = ChangeState
trigger1 = (command != "holdright" || command = "holdleft") && ifelse(facing = 1,vel X > 0,vel X < 0)
trigger2 = (command != "holdleft" || command = "holdright") && ifelse(facing = 1,vel X < 0,vel X > 0)
trigger3 = (command != "holdright" && command != "holdleft") || (command = "holdright" && command = "holdleft")
value = 101

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AP
time = 1
dodge = 1
ignorehitpause = 1

[State 100, 2]
type = AssertSpecial
trigger1 = vel X < 0
flag = Guard

[Statedef 101]
type    = S
movetype = I
physics = N
;anim = 101
sprpriority = 1
ctrl = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 101

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 101, SE]
type = PlaySnd
trigger1 = !time
value = S20,3

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 101, 8フレまで慣性持続]
type = VelSet
trigger1 = animelemtime(1) >= 9
x = 0

[State 101, イントロムーバー消去]
type = DestroySelf
trigger1 = Ishelper

[State 101, 1]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

[Statedef 105]
type    = A
physics = N
ctrl = 0
;anim = 105
velset = 0,0
sprpriority = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 105
value = 105
ignorehitpause = 1

[State 105, 無敵（イクリプス）]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(3) = 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(4) = 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(6) = 0

[State 105, ボイス]
type = PlaySnd
trigger1 = !time
value = S100,cond(random%2,12,94+random%2)
channel = 4

[State 105, 移動距離（イクリプス）]
type = VelSet
trigger1 = !time
x = -12
y = -1.5

[State 105, 2]
type = VelAdd
trigger1 = time >= 3 && time <= 12
y = .3

[State 105, 2]
type = VelAdd
trigger1 = time >= 12
y = .02

[State 105, 2]
type = VelMul
trigger1 = time >= 9
x = .89

[State 105, イントロムーバー消去]
type = DestroySelf
trigger1 = Ishelper

[State 105, 3]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 106

;---------------------------------------------------------------------------
; バックステップ着地
[Statedef 106]
type    = S
physics = S
ctrl = 0
velset = -3,0
;anim = 106

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 106
value = 106

[State 106, 2]
type = PosSet
trigger1 = animelem = 1
y = 0

[State 106, イントロムーバー消去]
type = DestroySelf
trigger1 = Ishelper

[State 106, 4]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

[Statedef 110]
type    = A
movetype = I
physics = N
;anim = 100
sprpriority = 1
ctrl = 1

[State 100, イントロムーバー消去]
type = DestroySelf
trigger1 = Ishelper

[State 0, Turn]
type = Turn
trigger1 = p2dist X < 0

[State 100, 通常]
type = VelSet
triggerall = !time
trigger1 = (command = "holdright" && command != "holdleft") || (command != "holdright" && command = "holdleft")
x = ifelse((command = "holdleft" && facing = 1) || (command = "holdright" && facing = -1),-const(velocity.run.fwd.x),const(velocity.run.fwd.x))
y = 0

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = (command = "holdright" && command != "holdleft") || (command != "holdright" && command = "holdleft")
trigger1 = anim != ifelse(vel X < 0,115,110)
value = ifelse(vel X < 0,115,110)

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(3) = 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(4) = 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(6) = 0

[State 100, SE]
type = PlaySnd
trigger1 = !time
value = S20, 1

[State 100, ボイス]
type = Null;PlaySnd
trigger1 = !time
trigger1 = random%4 = 0
value = S100, 91
channel = 4

[State 100, 2]
type = AssertSpecial
trigger1 = 1
flag = NoWalk
flag2 = NoAutoTurn
flag3 = NoGuard

[State 100, 4]
type = ChangeState
trigger1 = (command != "holdright" || command = "holdleft") && ifelse(facing = 1,vel X > 0,vel X < 0)
trigger2 = (command != "holdleft" || command = "holdright") && ifelse(facing = 1,vel X < 0,vel X > 0)
trigger3 = (command != "holdright" && command != "holdleft") || (command = "holdright" && command = "holdleft")
value = 111

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AP
time = 1
dodge = 1
ignorehitpause = 1

[State 100, 2]
type = AssertSpecial
trigger1 = vel X < 0
flag = Guard

[Statedef 111]
type    = A
movetype = I
physics = N
;anim = 100
sprpriority = 1
ctrl = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = ifelse(anim = 115,116,111)

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = .9

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 50
ctrl = 1

[Statedef 120]
type = U
physics = N
ctrl = 1

[State 120, Hi to Lo]
type = StateTypeSet
trigger1 = statetype = S && command = "holddown"
statetype = C

[State 120, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown"
statetype = S

[State 120, 5]
type = ChangeState
trigger1 = 1
value = 130 + (statetype = C) + (statetype = A)*2

[State 120, Stop Guarding]
type = ChangeState
trigger1 = command != "holdback"
value = 0

;---------------------------------------------------------------------------
; Stand guard (guarding)
[Statedef 130]
type    = S
physics = N
ctrl = 0

[State 130, 1]
type = ChangeAnim
triggerall = anim != 120
triggerall = inguarddist
triggerall = Anim != 130
triggerall = command = "holdback" || anim != 140
triggerall = Anim != [150,152]
trigger1 = anim = 5 || anim = 12
trigger1 = !animtime
trigger2 = anim != 5 && anim != 12
value = 120

[State 130, 1]
type = ChangeAnim
triggerall = Anim != 130
triggerall = command = "holdback"
trigger1 = Anim = 120
trigger1 = !AnimTime
trigger2 = anim = [150,152]
value = 130

[State 140, 1]
type = ChangeAnim
triggerall = !inguarddist || command != "holdback"
trigger1 = anim = [120,131]
trigger2 = anim = [150,152]
value = 140

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = p2dist X < 0
value = 5

[State 0, Turn]
type = Turn
trigger1 = p2dist X < 0

[State 0, VelSet]
type = VelSet
trigger1 = !time
y = 0

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 20, 4]
type = ChangeState
triggerall = command != "holdfwd"
trigger1 = command = "holdback"
value = 20
ctrl = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = command = "holddown"
value = 10
elem = 1
ignorehitpause = 1

[State 130, Hi to Lo]
type = ChangeState
trigger1 = command = "holddown"
value = 131
ctrl = 0
ignorehitpause = 1

[State 130, Stop Guarding]
type = ChangeState
trigger1 = anim = 140 && !animtime
value = 0
ctrl = 1

[State 0, ChangeState]
type = ChangeState
triggerall = !inguarddist || command != "holdback"
trigger1 = anim != [120,155]
value = ifelse(anim = 12,12,0)
ctrl = 1

;---------------------------------------------------------------------------
; Crouch guard (guarding)
[Statedef 131]
type    = C
physics = N
ctrl = 0

[State 130, 1]
type = ChangeAnim
triggerall = anim != 121
triggerall = inguarddist
triggerall = Anim != 131
triggerall = command = "holdback" || anim != 141
triggerall = Anim != [150,152]
trigger1 = anim = 6 || anim = 10
trigger1 = !animtime
trigger2 = anim != 6 && anim != 10
value = 121

[State 130, 1]
type = ChangeAnim
triggerall = Anim != 131
triggerall = command = "holdback"
trigger1 = Anim = 121
trigger1 = !AnimTime
trigger2 = anim = [150,152]
value = 131

[State 140, 1]
type = ChangeAnim
triggerall = !inguarddist || command != "holdback"
trigger1 = anim = [120,131]
trigger2 = anim = [150,152]
value = 141

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = p2dist X < 0
value = 6

[State 0, Turn]
type = Turn
trigger1 = p2dist X < 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 0, VelSet]
type = VelSet
trigger1 = !time
y = 0

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = command != "holddown"
value = 12
elem = 1
ignorehitpause = 1

[State 131, Lo to Hi]
type = ChangeState
trigger1 = command != "holddown"
value = 130
ctrl = 0
ignorehitpause = 1

[State 131, Stop Guarding]
type = ChangeState
trigger1 = anim = 141 && !animtime
value = 11
ctrl = 1

[State 0, ChangeState]
type = ChangeState
triggerall = !inguarddist || command != "holdback"
trigger1 = anim != [120,155]
value = ifelse(anim = 10,10,11)
ctrl = 1

;---------------------------------------------------------------------------
; Air guard (guarding)
[Statedef 132]
type    = A
physics = N
ctrl = 1

[State 132, 1]
type = ChangeAnim
trigger1 = Anim != 122
trigger1 = Anim != 132
trigger1 = Anim != 142
trigger1 = Anim != 152
trigger1 = InGuardDist
value = 122

[State 132, 1]
type = ChangeAnim
trigger1 = Anim = 122
trigger1 = !AnimTime
trigger2 = Anim = 152
value = 132

[State 132, 1]
type = ChangeAnim
trigger1 = Anim = 132 || Anim = 152
trigger1 = !InGuardDist
value = 142

[State 132, 1]
type = ChangeAnim
trigger1 = Anim = 142
trigger1 = !AnimTime
trigger2 = anim = [41,43]
trigger2 = vel Y > 0
value = 44

[State 132, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 132, 3]
type = Null;VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 132, 4]
type = Null;VelSet
trigger1 = sysvar(0)
y = 0

[State 132, 5]
type = Null;PosSet
trigger1 = sysvar(0)
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = command = "holdfwd" && command != "holdback"
trigger1 = vel X < const(velocity.walk.fwd.x)
trigger2 = command = "holdback" && command != "holdfwd"
trigger2 = vel X > -const(velocity.walk.fwd.x)
x = ifelse(command = "holdback",-const(velocity.walk.fwd.x),const(velocity.walk.fwd.x))

[State 132, 6]
type = ChangeState
trigger1 = (pos y >= 0) && (vel y > 0)
trigger1 = command = "holdback"
value = 130

[State 132, 7]
type = ChangeState
trigger1 = (pos y >= 0) && (vel y > 0)
value = 52

[State 0, ChangeState]
type = ChangeState
trigger1 = anim != 122 && anim != 132 && anim != 142 && anim != 152
trigger1 = command != "holdback"
value = 50
ctrl = 1

[State 132, Stop Guarding]
type = Null;ChangeState
trigger1 = command != "holdback"
value = 140

;---------------------------------------------------------------------------
; Guard (end)
[Statedef 140]
type = U    ;Leave state type unchanged
physics = N
ctrl = 1

[State 140, 1]
type = Null;ChangeAnim
trigger1 = !time
value = 140 + (statetype = C) + (statetype = A)*2

[State 140, 4]
type = StateTypeSet
trigger1 = !time && statetype = A
physics = A

[State 140, Hi to Lo]
type = StateTypeSet
trigger1 = statetype = S && command = "holddown"
statetype = C

[State 140, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown"
statetype = S

;---------------------------------------------------------------------------
; Stand guard hit (shaking)
[Statedef 150]
type    = S
movetype= H
physics = N
velset = 0,0
ctrl = 0

[State -3, 立ちガードエフェクト]
type = Explod
trigger1 = !time
anim = 10032
id = 10032
pos = 0,-45
postype = p1
ownpal = 1
bindtime = -1
supermovetime = 999
pausemovetime = 999
sprpriority = 80
ignorehitpause = 1

[State 150, 1]
type = ChangeAnim
trigger1 = 1
value = 150

[State 150, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 151

[State 150, 3]
type = ForceFeedback
trigger1 = !time
waveform = square
time = 3

;---------------------------------------------------------------------------
; Stand guard hit (knocked back)
[Statedef 151]
type    = S
movetype= H
physics = N
ctrl = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 150
value = 150
ignorehitpause = 1

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 151, 1]
type = HitVelSet
trigger1 = !time
x = 1

[State 151, 2]
type = Null;VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 151, 3]
type = CtrlSet
trigger1 = Time >= GetHitVar(ctrltime)
value = 1

[State 151, Hi to Lo]
type = StateTypeSet
trigger1 = statetype = S && command = "holddown"
statetype = C

[State 151, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown"
statetype = S

[State 151, 4]
type = ChangeState
trigger1 = HitOver
value = 130
ctrl = 1

;---------------------------------------------------------------------------
; Crouch guard hit (shaking)
[Statedef 152]
type    = C
movetype= H
physics = N
velset = 0,0
ctrl = 0

[State -3, しゃがみガードエフェクト]
type = Explod
trigger1 = !time
anim = 10031
id = 10031
pos = 0,-30
postype = p1
ownpal = 1
bindtime = -1
supermovetime = 999
pausemovetime = 999
sprpriority = 80
ignorehitpause = 1

[State 152, 1]
type = ChangeAnim
trigger1 = 1
value = 151

[State 152, 3]
type = ChangeState
trigger1 = HitShakeOver
value = 153

[State 152, 4]
type = ForceFeedback
trigger1 = !time
waveform = square
time = 4

;---------------------------------------------------------------------------
; Crouch guard hit (knocked back)
[Statedef 153]
type    = C
movetype= H
physics = N
ctrl = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 151
value = 151

[State 153, 1]
type = HitVelSet
trigger1 = !time
x = 1

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 151, 2]
type = Null;VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 153, 3]
type = CtrlSet
trigger1 = Time >= GetHitVar(ctrltime)
value = 1

[State 153, Hi to Lo]
type = StateTypeSet
trigger1 = statetype = S && command = "holddown"
statetype = C

[State 153, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown"
statetype = S

[State 153, 4]
type = ChangeState
trigger1 = HitOver
value = 131
ctrl = 1

;---------------------------------------------------------------------------
; Air guard hit (shaking)
[Statedef 154]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0

[State -3, しゃがみガードエフェクト]
type = Explod
trigger1 = !time
anim = 10030
id = 10030
pos = 0,-45
postype = p1
ownpal = 1
bindtime = -1
supermovetime = 999
pausemovetime = 999
sprpriority = 80
ignorehitpause = 1

[State 154, 1]
type = ChangeAnim
trigger1 = 1
value = 152

[State 154, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 155 ;AGUARDHIT2

[State 154, 3]
type = ForceFeedback
trigger1 = !time
waveform = square
time = 4

;---------------------------------------------------------------------------
; Air guard hit (knocked away)
[Statedef 155]
type    = A
movetype= H
physics = N
ctrl = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 152
value = 152

[State 155, 1]
type = HitVelSet
trigger1 = !time
x = 1
y = 1

[State 155, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 155, 3]
type = CtrlSet
trigger1 = Time >= GetHitVar(ctrltime)
value = 1

[State 155, 6]
type = ChangeState
trigger1 = pos Y >= 0 && vel Y > 0
trigger1 = command = "holdback"
value = 130

[State 155, 7]
type = ChangeState
trigger1 = pos Y >= 0 && vel Y > 0
value = 52

;---------------------------------------------------------------------------
; 勝利 - 分岐
[Statedef 180]
type = S
ctrl = 0
anim = 0
velset = 0,0

[State 180, 勝利へ]
type = ChangeState
trigger1 = ifelse(Numhelper(14005),time = 62, !time)	;perfect時は62F待つ
value = 181

;---------------------------------------------------------------------------
; 勝利
[Statedef 181]
type = S
ctrl = 0
anim = 181
velset = 0,0

[State 0, VarRandom]
type = VarRandom
trigger1 = time = 5
v = 4
range = 1,12

[State 181, ボイス1]
type = PlaySnd
trigger1 = time = 5
trigger1 = var(4) = 1
value = S100, 14

[State 181, ボイス2]
type = PlaySnd
trigger1 = time = 5
trigger1 = var(4) = 2
value = S100, 16

[State 181, ボイス3]
type = PlaySnd
trigger1 = time = 5
trigger1 = var(4) = 3
value = S100, 20

[State 181, ボイス4]
type = PlaySnd
trigger1 = time = 5
trigger1 = var(4) = 4
value = S100, 21

[State 181, ボイス5]
type = PlaySnd
trigger1 = time = 5
trigger1 = var(4) = 5
value = S100, 22

[State 181, ボイス6]
type = PlaySnd
trigger1 = time = 5
trigger1 = var(4) = 6
value = S100, 23

[State 181, ボイス7]
type = PlaySnd
trigger1 = time = 5
trigger1 = var(4) = 7
value = S100, 24

[State 181, ボイス8]
type = PlaySnd
trigger1 = time = 5
trigger1 = var(4) = 8
value = S100, 25

[State 181, ボイス9]
type = PlaySnd
trigger1 = time = 5
trigger1 = var(4) = 9
value = S100, 26

[State 181, ボイス10]
type = PlaySnd
trigger1 = time = 5
trigger1 = var(4) = 10
value = S100, 27

[State 181, ボイス11]
type = PlaySnd
trigger1 = time = 5
trigger1 = var(4) = 11
value = S100, 28

[State 181, ボイス12]
type = PlaySnd
trigger1 = time = 5
trigger1 = var(4) = 12
value = S100, 29

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(10) = (backedgedist <= 30 || frontedgedist <= 30)

[State 0, Trans]
type = Trans
triggerall = var(10)
trigger1 = time >= 22 && time < 32
trans = addalpha
alpha = ifelse(time < 27,256-(256/5)*(time-21),(256/5)*(time-26)),ifelse(time >= 27,256-(256/5)*(time-26),(256/5)*(time-21))

[State 0, PosSet]
type = PosSet
triggerall = var(10)
trigger1 = time >= 27
x = 0

[State 181, 勝利時Ass Spのintro指定]
type = AssertSpecial
trigger1 = time <= 320
flag = RoundNotOver

;---------------------------------------------------------------------------
; 勝利 - 分岐
[Statedef 191]
type = S
movetype = I
physics = N
ctrl = 0
anim = 192

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,0

[State 0, Gravity]
type = Gravity
trigger1 = anim = 192

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = -gameheight-100

[State 0, PosSet]
type = PosSet
trigger1 = pos Y + vel Y >= 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = pos Y + vel Y >= 0
y = 0

[State 5110, ダウンSE]
type = PlaySnd
trigger1 = anim = 192
trigger1 = pos y = 0
value = S30,1

[State 5110, 揺れ]
type = EnvShake
trigger1 = anim = 192
trigger1 = pos y = 0
time = 10
freq = 80
ampl = 4

[State 5110, 砂煙]
type = Explod
trigger1 = anim = 192
trigger1 = pos y = 0
anim = 10080
id = 10080
pos = 0,0
postype = p1
ownpal = 1
bindtime = 1
pausemovetime = -1
supermovetime = -1
sprpriority = 3

[State 5110, 砂煙（影）]
type = Explod
trigger1 = anim = 192
trigger1 = pos y = 0
anim = 12190
id = 12190
pos = 0,0
postype = p1
ownpal = 1
bindtime = 1
pausemovetime = -1
supermovetime = -1
sprpriority = 2

[State 5110, ダウンエフェクト]
type = Explod
trigger1 = anim = 192
trigger1 = pos y = 0
anim = 13501
id = 13501
pos = 0,10
postype = p1
ownpal = 1
pausemovetime = -1
supermovetime = -1
scale = 0.5,0.5
sprpriority = -1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim = 192
trigger1 = pos y = 0
value = 1920

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 1920 && animelemtime(5) = 59
value = S192,0

[State 0, Helper]
type = Helper
trigger1 = anim = 1920 && animelemtime(5) = 59
ID = 1921
stateno = 1921
pausemovetime = -1
supermovetime = -1
ownpal = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 1920 && animelem = 6
value = S100,199+(random%2)
channel = 4

[State 0, ChangeState]
type = ChangeState
trigger1 = anim = 1920 && !animtime
value = 0
ctrl = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = intro

[Statedef 1921]
type = S
movetype = I
physics = N
ctrl = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = 1
value = 1920
elem = 5

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 1
add = 256,256,256

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = 1+(.05*(time+1.0)),1+(.05*(time+1.0))

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, Trans]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256-(256/20)*time+1,(256/20)*time+1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 19

[statedef 200]
Type = S
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 2
Facep2 = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 200

[State 0, VarSet]
type = VarAdd
trigger1 = !time
var(2) = -var(2)%10

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 200, 立ちA素振り音]
type = PlaySnd
;trigger1 = !var(7)
trigger1 = animelem = 2
value = S0,0

[State 200, ボイス]
type = PlaySnd
;trigger1 = !var(7)
trigger1 = animelem = 2
trigger1 = random%10 < 2
value = S100,30
channel = 4

[State 200, 剣閃エフェ]
type = Explod
;trigger1 = !var(7)
trigger1 = animelem = 3
anim = 10034
id = 10034
pos = 11,-75
postype = p1
ownpal = 1
bindtime = -1
removeongethit = 0
sprpriority = 3
persistent = 0
ignorehitpause = 1

[State -1]
Type = HitDef
triggerall = var(0)%10 < 6
trigger1 = !movecontact && !movereversed && !moveclash
Attr = S, NA
Damage = Ceil(17/(fvar(0)-fvar(1)))
AnimType = Light
GuardFlag = M
HitFlag = MAFDP
Priority = ifelse(palno = 12,777,3), Hit
PauseTime = 5, 5
Guard.PauseTime = 6, 6
HitSound = s5, 0                                        ;ヒットした時の音（ｓ*,*にすると自分の音を使う）
GuardSound = s10, 0                                     ;ガードした時の音（同上）
SparkXY = -Random%20, -60-Random%20
SparkNo = -1
Guard.SparkNo = S10000
Ground.Type = High                                        ;相手のくらった場所（High：頭、体, Low：足, Trip：足払い）
Ground.SlideTime = 10                                    ;相手が後にすべる時間
Ground.HitTime  = 10                                     ;コンボが繋がる時間（高くしすぎない事）
Ground.Velocity = -5                                   ;地上で攻撃をくらった場合の相手の移動状況（ｘとｙで小数点可）
Air.Type = High                                          ;空中で相手がくらった場所（上と同じ）
Air.Velocity = -1.8,-6.2
Down.Velocity = -3.6,-2.5
ground.cornerpush.veloff = 0
YAccel = .48
Kill = 1
Guard.Kill = 0
Fall = 0
Air.Fall = 1
Fall.Recover = IfElse(P2MoveType = A,0,1)
Fall.RecoverTime = 20
GetPower = 40, Ceil(0.85*40)
GivePower = 20, Floor(0.50*20)
ID = 200
Down.Bounce = 1
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
var(0) = 1
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
fvar(0) = .5
ignorehitpause = 1
persistent = 0

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AA,AP
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 3
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = 0

[State 0, CtrlSet]
type = CtrlSet
trigger1 = animelemtime(6) >= -1
value = 1

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
triggerall = command = "holdup"
triggerall = command != "holddown"
trigger1 = MoveHit || MoveClash || MoveClashed
value = 40
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

[statedef 210]
Type = S
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 2
Facep2 = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 210

[State 0, VarSet]
type = VarAdd
trigger1 = !time
var(2) = -floor(var(2)/10)%10*10

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 200, 立ちA素振り音]
type = PlaySnd
;trigger1 = !var(7)
trigger1 = animelem = 3
value = S0,0

[State 200, ボイス]
type = PlaySnd
;trigger1 = !var(7)
trigger1 = animelem = 3
value = S100,31+(random%3)
channel = 4

[State 200, 剣閃エフェ]
type = Explod
;trigger1 = !var(7)
trigger1 = animelem = 3
anim = 10058
id = 10058
pos = 24,-40
postype = p1
ownpal = 1
bindtime = -1
pausemovetime = 999
supermovetime = 999
removeongethit = 0
sprpriority = 3
persistent = 0
ignorehitpause = 1

[State -1]
Type = HitDef
triggerall = floor(var(0)/10)%10 < 2
trigger1 = !movecontact && !movereversed && !moveclash
Attr = S, NA
Damage = Ceil(27/(fvar(0)-fvar(1)))
AnimType = Medium
GuardFlag = M
HitFlag = MAFDP
Priority = ifelse(palno = 12,777,4), Hit
PauseTime = 8, 12
Guard.PauseTime = 8, 8
HitSound = s5, 2                                        ;ヒットした時の音（ｓ*,*にすると自分の音を使う）
GuardSound = s10, 0                                     ;ガードした時の音（同上）
SparkXY = -Random%20, -60-Random%20
SparkNo = -1
Guard.SparkNo = S10000
Ground.Type = High                                        ;相手のくらった場所（High：頭、体, Low：足, Trip：足払い）
Ground.SlideTime = 15                                    ;相手が後にすべる時間
Ground.HitTime  = 15                                     ;コンボが繋がる時間（高くしすぎない事）
Ground.Velocity = -7                                   ;地上で攻撃をくらった場合の相手の移動状況（ｘとｙで小数点可）
Air.Type = High                                          ;空中で相手がくらった場所（上と同じ）
Air.Velocity = -2.1,-6.2
Down.Velocity = -3.8,-2.5
ground.cornerpush.veloff = 0
YAccel = .48
Kill = 1
Guard.Kill = 0
Fall = 0
Air.Fall = 1
Fall.Recover = Cond(P2MoveType = A,0,1)
Fall.RecoverTime = 40
GetPower = 80, Ceil(0.85*80)
GivePower = 40, Floor(0.50*40)
ID = 210
Down.Bounce = 1
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
fvar(0) = .22
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = VarAdd
triggerall = floor(var(0)/10)%10 < 2
trigger1 = MoveHitTrue = 1
var(0) = 10
ignorehitpause = 1
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AA,AP
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 4
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = 0

[State 0, ChangeState]
type = ChangeState
triggerall = command = "holdup"
triggerall = command != "holddown"
trigger1 = MoveHit || MoveClash || MoveClashed
value = 40
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

[Statedef 220]
type = S
movetype = A
physics = N
ctrl = 0
SprPriority = 2
Facep2 = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 220

[State 0, VarSet]
type = VarAdd
trigger1 = !time
var(2) = -floor(var(2)/100)%10*100

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 220, 移動停止]
type = VelAdd
trigger1 = animelem = 2
x = 6-(vel X *(vel X < 0))

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = animelem = 6
value = S0,0

[State 220, ボイス]
type = PlaySnd
trigger1 = animelem = 6
value = S100,cond(random%3=0,90,33+(random%3))
channel = 4

[State 220, 剣閃エフェ]
type = Explod
trigger1 = !NumExplod(10037)
trigger1 = animelem = 6
anim = 10037
id = 10037
pos = 13,-65
postype = p1
ownpal = 1
bindtime = -1
pausemovetime = 999
supermovetime = 999
removeongethit = 0
sprpriority = 3
persistent = 0
ignorehitpause = 1

[State 220, 立ちC攻撃 - hitdef定義]
type = HitDef
triggerall = floor(var(0)/100)%10 < 2
trigger1 = !movecontact && !movereversed && !moveclash
attr = S, NA
damage = Ceil(60/(fvar(0)-fvar(1)))
animtype = hard
ground.type = low
guardflag = M
hitflag = MAFDP
priority = ifelse(palno = 12,777,6), Hit
pausetime = 10,15
guard.pausetime = 13,9
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-73
hitsound = s30, 2
guardsound = S10,0
ground.slidetime = 20
ground.hittime = 20
guard.ctrltime = 15
guard.velocity = -9
ground.velocity = -10
air.velocity = -2,-7
down.velocity = -4,-2
airguard.velocity = -4,-3
getpower = 81,71
givepower = 35, 29
ground.cornerpush.veloff = 0
fall = cond(p2movetype = A||p2statetype = L,1,0)
air.fall = 1
Fall.Recover = Cond(P2MoveType = A,0,1)
ID = 220
yaccel = .48
fall.recovertime = 40
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
fvar(0) = .14
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = VarAdd
triggerall = floor(var(0)/100)%10 < 2
trigger1 = MoveHitTrue = 1
var(0) = 100
ignorehitpause = 1
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AA,AP
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 6
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

[State 220, ヒット時揺れ]
type = EnvShake
trigger1 = movehit
time = 8
ampl = 3
freq = 110
persistent = 0
ignorehitpause = 1

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = 0

[State 0, ChangeState]
type = ChangeState
triggerall = command = "holdup"
triggerall = command != "holddown"
trigger1 = MoveHit || MoveClash || MoveClashed
value = 40
ignorehitpause = 1

[State 220, 立ちA終了 - ステート移動]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

[Statedef 225]
type = S
movetype = A
physics = N
ctrl = 0
SprPriority = 2
Facep2 = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 225

[State 0, VarSet]
type = VarAdd
trigger1 = !time
var(2) = -floor(var(2)/100)%10*100

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 220, 移動停止]
type = VelAdd
trigger1 = animelem = 2
x = 6-(vel X *(vel X < 0))

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = animelem = 5
value = S0,0

[State 220, ボイス]
type = PlaySnd
trigger1 = animelem = 5
value = S100,cond(random%3=0,90,33+(random%3))
channel = 4

[State 220, 剣閃エフェ]
type = Explod
trigger1 = animelem = 5
anim = 10045
id = 10045
pos = 30,-91
postype = p1
angle = 5
ownpal = 1
bindtime = 4
pausemovetime = -1
supermovetime = -1
removeongethit = 0
scale = .6,.6
sprpriority = 3
ignorehitpause = 1

[State 220, 立ちC攻撃 - hitdef定義]
type = HitDef
triggerall = floor(var(0)/100)%10 < 2
trigger1 = !movecontact && !movereversed && !moveclash
attr = S, NA
damage = Ceil(60/(fvar(0)-fvar(1)))
animtype = hard
ground.type = high
guardflag = M
hitflag = MAFDP
priority = ifelse(palno = 12,777,6), Hit
pausetime = 10,15
guard.pausetime = 13,9
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-73
hitsound = s30, 2
guardsound = S10,0
ground.slidetime = 20
ground.hittime = 20
guard.ctrltime = 15
guard.velocity = -9
ground.velocity = -10
air.velocity = -2,-7
down.velocity = -4,-2
airguard.velocity = -4,-3
getpower = 81,71
givepower = 35, 29
ground.cornerpush.veloff = 0
fall = cond(p2movetype = A||p2statetype = L,1,0)
air.fall = 1
Fall.Recover = Cond(P2MoveType = A,0,1)
ID = 220
yaccel = .48
fall.recovertime = 40
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
fvar(0) = .14
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = VarAdd
triggerall = floor(var(0)/100)%10 < 2
trigger1 = MoveHitTrue = 1
var(0) = 100
ignorehitpause = 1
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AA,AP
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 6
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

[State 220, ヒット時揺れ]
type = EnvShake
trigger1 = movehit
time = 8
ampl = 3
freq = 110
persistent = 0
ignorehitpause = 1

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = 0

[State 0, ChangeState]
type = ChangeState
triggerall = command = "holdup"
triggerall = command != "holddown"
trigger1 = MoveHit || MoveClash || MoveClashed
value = 40
ignorehitpause = 1

[State 220, 立ちA終了 - ステート移動]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

[statedef 400]
Type = C
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 2
Facep2 = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 400

[State 0, VarSet]
type = VarAdd
trigger1 = !time
var(2) = -var(2)%10

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 200, 立ちA素振り音]
type = PlaySnd
;trigger1 = !var(7)
trigger1 = animelem = 2
value = S0,0

[State 200, ボイス]
type = PlaySnd
;trigger1 = !var(7)
trigger1 = animelem = 2
trigger1 = random%10 < 2
value = S100,30
channel = 4

[State 200, 剣閃エフェ]
type = Explod
;trigger1 = !var(7)
trigger1 = animelem = 3
anim = 10039
id = 10039
pos = 12,-28
postype = p1
ownpal = 1
bindtime = -1
removeongethit = 0
sprpriority = 3
persistent = 0
ignorehitpause = 1

[State -1]
Type = HitDef
triggerall = var(0)%10 < 6
trigger1 = !movecontact && !movereversed && !moveclash
Attr = C, NA
Damage = Ceil(17/(fvar(0)-fvar(1)))
AnimType = Light
GuardFlag = L
HitFlag = MAFDP
Priority = ifelse(palno = 12,777,3), Hit
PauseTime = 5, 5
Guard.PauseTime = 6, 6
HitSound = s5, 0                                        ;ヒットした時の音（ｓ*,*にすると自分の音を使う）
GuardSound = s10, 0                                     ;ガードした時の音（同上）
SparkXY = -Random%20, -60-Random%20
SparkNo = -1
Guard.SparkNo = S10000
Ground.Type = Low
Ground.SlideTime = 10                                    ;相手が後にすべる時間
Ground.HitTime  = 10                                     ;コンボが繋がる時間（高くしすぎない事）
Ground.Velocity = -5                                   ;地上で攻撃をくらった場合の相手の移動状況（ｘとｙで小数点可）
Air.Type = Low
Air.Velocity = -1.8,-6.2
Down.Velocity = -3.6,-2.5
ground.cornerpush.veloff = 0
YAccel = .48
Kill = 1
Guard.Kill = 0
Fall = 0
Air.Fall = 1
Fall.Recover = IfElse(P2MoveType = A,0,1)
Fall.RecoverTime = 20
GetPower = 40, Ceil(0.85*40)
GivePower = 20, Floor(0.50*20)
ID = 200
Down.Bounce = 1
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
fvar(0) = .5
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
var(0) = 1
ignorehitpause = 1
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AA,AP
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 3
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = 0

[State 0, ChangeState]
type = ChangeState
triggerall = command = "holdup"
triggerall = command != "holddown"
trigger1 = MoveHit || MoveClash || MoveClashed
value = 40
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 11
ctrl = 1

[statedef 410]
Type = C
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 2
Facep2 = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 410

[State 0, VarSet]
type = VarAdd
trigger1 = !time
var(2) = -floor(var(2)/10)%10*10

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 200, 立ちA素振り音]
type = PlaySnd
;trigger1 = !var(7)
trigger1 = animelem = 3
value = S0,0

[State 200, ボイス]
type = PlaySnd
;trigger1 = !var(7)
trigger1 = animelem = 3
value = S100,31+(random%3)
channel = 4

[State 200, 剣閃エフェ]
type = Explod
;trigger1 = !var(7)
trigger1 = animelem = 3
anim = 10041
id = 10041
pos = -13,-50
postype = p1
ownpal = 1
bindtime = -1
pausemovetime = 999
supermovetime = 999
removeongethit = 0
sprpriority = 3
persistent = 0
ignorehitpause = 1

[State -1]
Type = HitDef
triggerall = floor(var(0)/10)%10 < 2
trigger1 = !movecontact && !movereversed && !moveclash
Attr = C, NA
Damage = Ceil(27/(fvar(0)-fvar(1)))
AnimType = Medium
GuardFlag = L
HitFlag = MAFDP
Priority = ifelse(palno = 12,777,4), Hit
PauseTime = 8, 12
Guard.PauseTime = 8, 8
HitSound = s5, 2                                        ;ヒットした時の音（ｓ*,*にすると自分の音を使う）
GuardSound = s10, 0                                     ;ガードした時の音（同上）
SparkXY = -Random%20, -60-Random%20
SparkNo = -1
Guard.SparkNo = S10000
Ground.Type = Low
Ground.SlideTime = 15                                    ;相手が後にすべる時間
Ground.HitTime  = 15                                     ;コンボが繋がる時間（高くしすぎない事）
Ground.Velocity = -7                                   ;地上で攻撃をくらった場合の相手の移動状況（ｘとｙで小数点可）
Air.Velocity = -2.1,-6.2
Down.Velocity = -3.8,-2.5
ground.cornerpush.veloff = 0
YAccel = .48
Kill = 1
Guard.Kill = 0
Fall = 0
Air.Fall = 1
Fall.Recover = Cond(P2MoveType = A,0,1)
Fall.RecoverTime = 40
GetPower = 80, Ceil(0.85*80)
GivePower = 40, Floor(0.50*40)
ID = 210
Down.Bounce = 1
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
fvar(0) = .25
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = VarAdd
triggerall = floor(var(0)/10)%10 < 2
trigger1 = MoveHitTrue = 1
var(0) = 10
ignorehitpause = 1
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AA,AP
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 4
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = 0

[State 0, ChangeState]
type = ChangeState
triggerall = command = "holdup"
triggerall = command != "holddown"
trigger1 = MoveHit || MoveClash || MoveClashed
value = 40
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 11
ctrl = 1

[Statedef 420]
type = C
movetype = A
physics = N
ctrl = 0
SprPriority = 2
Facep2 = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 420

[State 0, VarSet]
type = VarAdd
trigger1 = !time
var(2) = -floor(var(2)/100)%10*100

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = animelem = 4
value = S0,0

[State 220, ボイス]
type = PlaySnd
trigger1 = animelem = 4
value = S100,cond(random%3=0,90,33+(random%3))
channel = 4

[State 220, 剣閃エフェ]
type = Explod
trigger1 = !NumExplod(10037)
trigger1 = animelem = 4
anim = 10053
id = 10053
pos = 44,-17
postype = p1
ownpal = 1
bindtime = -1
pausemovetime = 999
supermovetime = 999
removeongethit = 0
sprpriority = 3
persistent = 0
ignorehitpause = 1

[State 220, 立ちC攻撃 - hitdef定義]
type = HitDef
triggerall = floor(var(0)/100)%10 < 2
trigger1 = !movecontact && !movereversed && !moveclash
attr = C, NA
damage = Ceil(60/(fvar(0)-fvar(1)))
animtype = hard
ground.type = low
guardflag = L
hitflag = MAFDP
priority = ifelse(palno = 12,777,6), Hit
pausetime = 10,15
guard.pausetime = 13,9
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-73
hitsound = s30, 2
guardsound = S10,0
ground.slidetime = 20
ground.hittime = 20
guard.ctrltime = 15
guard.velocity = -9
ground.velocity = -2,-4
air.velocity = -2,-7
down.velocity = -4,-2
airguard.velocity = -4,-3
getpower = 81,71
givepower = 35, 29
ground.cornerpush.veloff = 0
fall = 1
ID = 220
yaccel = .48
fall.recovertime = 40
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
fvar(0) = .17
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = VarAdd
triggerall = floor(var(0)/100)%10 < 2
trigger1 = MoveHitTrue = 1
var(0) = 100
ignorehitpause = 1
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AA,AP
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 6
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

[State 220, ヒット時揺れ]
type = EnvShake
trigger1 = movehit
time = 8
ampl = 3
freq = 110
persistent = 0
ignorehitpause = 1

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = 0

[State 0, ChangeState]
type = ChangeState
triggerall = command = "holdup"
triggerall = command != "holddown"
trigger1 = MoveHit || MoveClash || MoveClashed
value = 40
ignorehitpause = 1

[State 220, 立ちA終了 - ステート移動]
type = ChangeState
trigger1 = animtime = 0
value = 11
ctrl = 1

[Statedef 425]
type = S
movetype = A
physics = N
ctrl = 0
SprPriority = 2
Facep2 = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 425

[State 0, VarSet]
type = VarAdd
trigger1 = !time
var(2) = -floor(var(2)/100)%10*100

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = animelem = 4
value = S0,0

[State 220, ボイス]
type = PlaySnd
trigger1 = animelem = 4
value = S100,cond(random%3=0,90,33+(random%3))
channel = 4

[State 220, 剣閃エフェ]
type = Explod
trigger1 = animelem = 4
anim = 10038
id = 10038
pos = 31,-103
postype = p1
ownpal = 1
bindtime = -1
pausemovetime = -1
supermovetime = -1
removeongethit = 0
sprpriority = 3
ignorehitpause = 1

[State 220, 立ちC攻撃 - hitdef定義]
type = HitDef
triggerall = floor(var(0)/100)%10 < 2
trigger1 = !movecontact && !movereversed && !moveclash
attr = C, NA
damage = Ceil(60/(fvar(0)-fvar(1)))
animtype = up
ground.type = high
guardflag = M
hitflag = MAFDP
priority = ifelse(palno = 12,777,6), Hit
pausetime = 10,15
guard.pausetime = 13,9
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-73
hitsound = s30, 2
guardsound = S10,0
ground.slidetime = 20
ground.hittime = 20
guard.ctrltime = 15
guard.velocity = -9
ground.velocity = -2,-11
air.velocity = -2,-7
down.velocity = -4,-2
airguard.velocity = -4,-3
getpower = 81,71
givepower = 35, 29
ground.cornerpush.veloff = 0
fall = 1
ID = 220
yaccel = .48
fall.recovertime = 40
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(6) < 0
value = A,NA,SA
time = 1
ignorehitpause = 1

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
fvar(0) = .14
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = VarAdd
triggerall = floor(var(0)/100)%10 < 2
trigger1 = MoveHitTrue = 1
var(0) = 100
ignorehitpause = 1
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = SC,AA
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 6
nothitstate = 1
hotype = 2

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AP
slot = 2
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 6
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

[State 220, ヒット時揺れ]
type = EnvShake
trigger1 = movehit
time = 8
ampl = 3
freq = 110
persistent = 0
ignorehitpause = 1

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = 0

[State 0, ChangeState]
type = ChangeState
triggerall = command = "holdup"
triggerall = command != "holddown"
trigger1 = MoveHit || MoveClash || MoveClashed
value = 40
ignorehitpause = 1

[State 220, 立ちA終了 - ステート移動]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

[statedef 600]
Type = A
MoveType = A
Physics  = A
Ctrl = 0
SprPriority = 2
Facep2 = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 600

[State 0, VarSet]
type = VarAdd
trigger1 = !time
var(2) = -var(2)%10

[State 0, ChangeState]
type = ChangeState
triggerall = pos Y >= 0
trigger1 = vel Y > 0
value = 52
ctrl = 1

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 200, 立ちA素振り音]
type = PlaySnd
triggerall = pos Y + vel Y < 0
;trigger1 = !var(7)
trigger1 = animelem = 3
value = S0,0

[State 200, ボイス]
type = PlaySnd
triggerall = pos Y + vel Y < 0
;trigger1 = !var(7)
trigger1 = animelem = 3
trigger1 = random%10 < 2
value = S100,30
channel = 4

[State 200, 剣閃エフェ]
type = Explod
triggerall = pos Y + vel Y < 0
;trigger1 = !var(7)
trigger1 = animelem = 3
anim = 10043
id = 10043
pos = 11,-75
postype = p1
ownpal = 1
bindtime = -1
removeongethit = 0
sprpriority = 3
persistent = 0
ignorehitpause = 1

[State -1]
Type = HitDef
triggerall = floor(var(0)/1000)%10 < 6
trigger1 = !movecontact && !movereversed && !moveclash
Attr = A, NA
Damage = Ceil(17/(fvar(0)-fvar(1)))
AnimType = Light
GuardFlag = HA
HitFlag = MAFDP
Priority = ifelse(palno = 12,777,3), Hit
PauseTime = 5, 5
Guard.PauseTime = 6, 6
HitSound = s5, 0                                        ;ヒットした時の音（ｓ*,*にすると自分の音を使う）
GuardSound = s10, 0                                     ;ガードした時の音（同上）
SparkXY = -Random%20, -60-Random%20
SparkNo = -1
Guard.SparkNo = S10000
Ground.Type = High                                        ;相手のくらった場所（High：頭、体, Low：足, Trip：足払い）
Ground.SlideTime = 10                                    ;相手が後にすべる時間
Ground.HitTime  = 10                                     ;コンボが繋がる時間（高くしすぎない事）
Ground.Velocity = -5                                   ;地上で攻撃をくらった場合の相手の移動状況（ｘとｙで小数点可）
Air.Type = High                                          ;空中で相手がくらった場所（上と同じ）
Air.Velocity = -1.8,-6.2
Down.Velocity = -3.6,-2.5
ground.cornerpush.veloff = 0
YAccel = .48
Kill = 1
Guard.Kill = 0
Fall = 0
Air.Fall = 1
Fall.Recover = IfElse(P2MoveType = A,0,1)
Fall.RecoverTime = 20
GetPower = 40, Ceil(0.85*40)
GivePower = 20, Floor(0.50*20)
ID = 200
Down.Bounce = 1
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
fvar(0) = .5
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = VarAdd
triggerall = floor(var(0)/1000)%10 < 6
trigger1 = MoveHitTrue = 1
var(0) = 1000
ignorehitpause = 1
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AA,AP
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 3
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = 0

[State 0, ChangeState]
type = ChangeState
triggerall = (sysvar(3) & 2) = 0
triggerall = command = "holdup" && (sysvar(3) & 1) = 0
trigger1 = MoveHit || MoveClash || MoveClashed
value = 45
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 50
ctrl = 1

[statedef 610]
Type = A
MoveType = A
Physics  = A
Ctrl = 0
SprPriority = 2
Facep2 = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 610

[State 0, VarSet]
type = VarAdd
trigger1 = !time
var(2) = -floor(var(2)/10)%10*10

[State 0, ChangeState]
type = ChangeState
triggerall = pos Y >= 0
trigger1 = vel Y > 0
value = 52
ctrl = 1

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 200, 立ちA素振り音]
type = PlaySnd
triggerall = pos Y + vel Y < 0
;trigger1 = !var(7)
trigger1 = animelem = 2
value = S0,0

[State 200, ボイス]
type = PlaySnd
triggerall = pos Y + vel Y < 0
;trigger1 = !var(7)
trigger1 = animelem = 2
value = S100,31+(random%3)
channel = 4

[State 200, 剣閃エフェ]
type = Explod
triggerall = pos Y + vel Y < 0
;trigger1 = !var(7)
trigger1 = animelem = 2
anim = 10037
id = 10037
pos = 19,-72
postype = p1
ownpal = 1
bindtime = -1
pausemovetime = 999
supermovetime = 999
removeongethit = 0
sprpriority = 3
persistent = 0
ignorehitpause = 1

[State -1]
Type = HitDef
triggerall = floor(var(0)/10000)%10 < 2
trigger1 = !movecontact && !movereversed && !moveclash
Attr = A, NA
Damage = Ceil(27/(fvar(0)-fvar(1)))
AnimType = Medium
GuardFlag = HA
HitFlag = MAFDP
Priority = ifelse(palno = 12,777,4), Hit
PauseTime = 8, 12
Guard.PauseTime = 8, 8
HitSound = s5, 2                                        ;ヒットした時の音（ｓ*,*にすると自分の音を使う）
GuardSound = s10, 0                                     ;ガードした時の音（同上）
SparkXY = -Random%20, -60-Random%20
SparkNo = -1
Guard.SparkNo = S10000
Ground.Type = High                                        ;相手のくらった場所（High：頭、体, Low：足, Trip：足払い）
Ground.SlideTime = 15                                    ;相手が後にすべる時間
Ground.HitTime  = 15                                     ;コンボが繋がる時間（高くしすぎない事）
Ground.Velocity = -7                                   ;地上で攻撃をくらった場合の相手の移動状況（ｘとｙで小数点可）
Air.Type = High                                          ;空中で相手がくらった場所（上と同じ）
Air.Velocity = -2.1,-6.2
Down.Velocity = -3.8,-2.5
ground.cornerpush.veloff = 0
YAccel = .48
Kill = 1
Guard.Kill = 0
Fall = 0
Air.Fall = 1
Fall.Recover = Cond(P2MoveType = A,0,1)
Fall.RecoverTime = 40
GetPower = 80, Ceil(0.85*80)
GivePower = 40, Floor(0.50*40)
ID = 210
Down.Bounce = 1
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
fvar(0) = .21
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = VarAdd
triggerall = floor(var(0)/10000)%10 < 2
trigger1 = MoveHitTrue = 1
var(0) = 10000
ignorehitpause = 1
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AA,AP
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 4
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = 0

[State 0, ChangeState]
type = ChangeState
triggerall = (sysvar(3) & 2) = 0
triggerall = command = "holdup" && (sysvar(3) & 1) = 0
trigger1 = MoveHit || MoveClash || MoveClashed
value = 45
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 50
ctrl = 1

[Statedef 620]
type = A
movetype = A
physics = A
ctrl = 0
SprPriority = 2
Facep2 = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 620

[State 0, VarSet]
type = VarAdd
trigger1 = !time
var(2) = -floor(var(2)/100)%10*100

[State 0, ChangeState]
type = ChangeState
triggerall = pos Y >= 0
trigger1 = vel Y > 0
value = 52
ctrl = 1

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 220, 立ちC素振り音]
type = PlaySnd
triggerall = pos Y + vel Y < 0
trigger1 = animelem = 5
value = S0,0

[State 220, ボイス]
type = PlaySnd
triggerall = pos Y + vel Y < 0
trigger1 = animelem = 5
value = S100,cond(random%3=0,90,33+(random%3))
channel = 4

[State 220, 剣閃エフェ]
type = Explod
triggerall = pos Y + vel Y < 0
trigger1 = animelem = 5
anim = 10062
id = 10062
pos = 13,-21
postype = p1
ownpal = 1
bindtime = -1
pausemovetime = 999
supermovetime = 999
removeongethit = 0
sprpriority = 3
ignorehitpause = 1

[State 220, 立ちC攻撃 - hitdef定義]
type = HitDef
triggerall = floor(var(0)/100000)%10 < 2
trigger1 = !movecontact && !movereversed && !moveclash
attr = A, NA
Damage = Ceil(60/(fvar(0)-fvar(1)))
animtype = hard
ground.type = low
guardflag = HA
hitflag = MAFDP
priority = ifelse(palno = 12,777,6), Hit
pausetime = 10,15
guard.pausetime = 13,9
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-73
hitsound = s30, 2
guardsound = S10,0
ground.slidetime = 20
ground.hittime = 20
guard.ctrltime = 15
guard.velocity = -9
ground.velocity = -10
air.velocity = -2,-7
down.velocity = -4,-2
airguard.velocity = -4,-3
getpower = 81,71
givepower = 35, 29
ground.cornerpush.veloff = 0
fall = cond(p2movetype = A||p2statetype = L,1,0)
air.fall = 1
Fall.Recover = Cond(P2MoveType = A,0,1)
ID = 220
yaccel = .48
fall.recovertime = 40
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
fvar(0) = .13
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = VarAdd
triggerall = floor(var(0)/100000)%10 < 2
trigger1 = MoveHitTrue = 1
var(0) = 100000
ignorehitpause = 1
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AA,AP
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 6
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

[State 220, ヒット時揺れ]
type = EnvShake
trigger1 = movehit
time = 8
ampl = 3
freq = 110
persistent = 0
ignorehitpause = 1

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = 0

[State 0, ChangeState]
type = ChangeState
triggerall = (sysvar(3) & 2) = 0
triggerall = command = "holdup" && (sysvar(3) & 1) = 0
trigger1 = MoveHit || MoveClash || MoveClashed
value = 45
ignorehitpause = 1

[State 220, 立ちA終了 - ステート移動]
type = ChangeState
trigger1 = animtime = 0
value = 50
ctrl = 1

[Statedef 700]
Type = U
MoveType = I
Physics = N
sprpriority = 0
ctrl = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 700

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y >= 0
statetype = S

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y < 0
statetype = A

[State 0, PosSet]
type = PosSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, Gravity]
type = Gravity
trigger1 = statetype = A

[State 0, VelMul]
type = VelMul
trigger1 = statetype = S
x = const(movement.stand.friction)

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S100,70+random%2
channel = 4

[State 0, PlaySnd]
type = PlaySnd
triggerall = roundstate = 2
trigger1 = enemynear,power > 0
trigger1 = time = 45
value = S700,0
pan = p2dist X

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = animelem = 1
id = 700

[State 0, Explod]
type = Explod
trigger1 = animelem = 7
anim = 1006
ID = 700
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -animelemtime(16)
pausemovetime = -(palno = 12)
supermovetime = -(palno = 12)
sprpriority = 1
ownpal = 0
removeongethit = 0
ignorehitpause = 0

[State 0, Explod]
type = Explod
triggerall = roundstate = 2
trigger1 = enemy,power > 0
trigger1 = time = 45
anim = 7880
ID = 7880
pos = 0,enemynear,const(size.mid.pos.y)
postype = p2
bindtime = -1
vfacing = -1
removetime = -2
scale = .5,1
sprpriority = 4
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, PowerAdd]
type = EnemyPowerAdd
triggerall = roundstate = 2
trigger1 = time = 45
value = -1000

[State 0, CtrlSet]
type = CtrlSet
trigger1 = time >= 51
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

[Statedef 760]
type    = U
movetype = I
physics = N
ctrl = 0
sprpriority = -1

[State 0, Gravity]
type = VelAdd
trigger1 = Vel Y + Pos Y < 0
y = .22

[State 0, PosSet]
type = PosSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = 0.9

[State 105, イントロムーバー消去]
type = DestroySelf
trigger1 = Ishelper

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(13) = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1
dodge = 1
ignoreproj = -1
ignorehelper = -1

[State 105, ボイス]
type = PlaySnd
trigger1 = !time
value = S100,cond(random%2,12,94+random%2)
channel = 4

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 105, 移動距離（イクリプス）]
type = VelSet
trigger1 = !time
x = ifelse((command = "holdleft" && command != "holdright" && facing = 1) || (command = "holdright" && command != "holdleft" && facing = -1),-17,ifelse((command = "holdleft" && command != "holdright" && facing = -1) || (command = "holdright" && command != "holdleft" && facing = 1),17,0))
y = ifelse(statetype = A,-2.2,0)

[State 0, Turn]
type = Turn
triggerall = p2dist X < 0
trigger1 = !time
trigger2 = animelemtime(17) < 0
trigger2 = anim = 760 || anim = 761
trigger3 = animelemtime(9) < 0
trigger3 = anim = 765 || anim = 766

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(10) = facing

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
trigger2 = anim = 760 || anim = 761
trigger2 = animelemtime(17) < 0
trigger3 = anim = 765 || anim = 766
trigger3 = animelemtime(9) < 0
;trigger2 = anim = 765+(Vel X < 0)
value = 760+((Vel X < 0) || (!vel X && facing != var(10)))+((statetype = A)*5)
elem = ifelse((anim = [760,766]),animelemno(0),1)

[State 0, VarSet]
type = Null;VarSet
trigger1 = !time
fv = 5
value = -0.5

[State 0, VarSet]
type = Null;VarAdd
trigger1 = time
fv = 5
value = 0.125

[State -2, Rainbow]
type = Null;PalFX
trigger1 = 1
time = 1
add = Floor(sin((fvar(5)+90))*(256/32)*-AnimTime),Floor(sin(fvar(5))*(256/32)*-AnimTime),Floor(sin((fvar(5)-90))*(256/32)*-AnimTime)

[State 0, Trans]
type = Null;Trans
trigger1 = 1
trans = addalpha
alpha = 256-((128/32)*-AnimTime),(128/32)*-AnimTime

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 1
add = (128/32)*-AnimTime,(128/32)*-AnimTime,(128/32)*-AnimTime

[State 0, VarSet]
type = VarSet
trigger1 = !numtarget
fvar(0) = 3

[State 0, VarSet]
type = VarSet
trigger1 = !numtarget
var(1) = 20

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = (StateType = A)*50
ctrl = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = StateType = A
trigger1 = Vel Y + Pos Y >= 0
value = 52
ctrl = 1

[statedef 800]
Type = S
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = -1
Facep2 = 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 800
ignorehitpause = 1

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, HitDef]
type = HitDef
trigger1 = 1
attr = S,NT
hitflag = M
guardflag = 
animtype = back
damage = 0,0
pausetime = 0,0
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = S5,0
guardsound = -1
ground.type = High
fall = 1
fall.recover = 0
p1stateno = 801
p2stateno = 805
p1sprpriority = -1
p2sprpriority = 0
id = 800
hitonce = 1
numhits = 0
abshit = enemynear,authorname = "nns"

[State 800, ミスボイス 1]
type = PlaySnd
trigger1 = animelem = 2
value = s100,73+(random%4)
channel = 4

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

[statedef 801]
Type = S
MoveType = A
Physics  = N
Ctrl = 0
velset = 0,0
SprPriority = -1

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = command = "holdright" && facing = -1
trigger2 = command = "holdleft" && facing = 1

[State 0, Width]
type = Width
trigger1 = 1
edge = 80,0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 801

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S100,68
channel = 4

[State 0, TargetBind]
type = TargetBind
trigger1 = animelemtime(2) < 0
time = 1
id = 800
pos = 32,0

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 2
x = 23

[State 0, TargetBind]
type = TargetBind
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
time = 1
id = 800
pos = 9,0

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 3
x = 16

[State 0, TargetBind]
type = TargetBind
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 0
time = 1
id = 800
pos = -16,0

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 3
x = 22

[State 0, TargetBind]
type = TargetBind
trigger1 = animelemtime(4) >= 0 && animelemtime(5) < 0
time = 1
id = 800
pos = -38,0

[State 0, TargetFacing]
type = TargetFacing
triggerall = NumTarget(800)
trigger1 = animelemtime(5) <= 0
value = -1
ID = 800

[State 0, TargetState]
type = TargetState
triggerall = NumTarget(800)
trigger1 = animelem = 5
value = 806
ID = 800

[State 0, SprPriority]
type = SprPriority
trigger1 = animelem = 3
value = 1

[State 0, SprPriority]
type = SprPriority
trigger1 = animelem = 5
value = -1

[State 0, PlaySnd]
type = PlaySnd
triggerall = NumTarget(800)
trigger1 = animelem = 5
value = S30,2

[State 0, Explod]
type = Explod
triggerall = NumTarget(800)
trigger1 = animelem = 5
anim = 1005
ID = 800
pos = 42,-90
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 0
removetime = -2
scale = .25,.5
angle = 25
sprpriority = 0
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, TargetVelSet]
type = TargetVelSet
triggerall = NumTarget(800)
trigger1 = animelem = 5
x = -4.48
y = -4.48
ID = 800

[State 0, TargetLifeAdd]
type = TargetLifeAdd
triggerall = NumTarget(800)
trigger1 = animelem = 5
value = -Ceil(78/(fvar(0)-fvar(1)))
ID = 800
kill = 1
absolute = 0

[State 0, VarAdd]
type = VarAdd
triggerall = NumTarget(800)
trigger1 = animelem = 5
fvar(0) = 3.0

[State 0, HitAdd]
type = HitAdd
triggerall = NumTarget(800)
trigger1 = animelem = 5
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

[statedef 805]
Type = S
MoveType = H
Physics  = N
Ctrl = 0
SprPriority = 0

[State 0, ChangeAnim]
type = ChangeAnim2
trigger1 = !time
value = 805

[State 0, SelfState]
type = SelfState
trigger1 = time > 59
value = 0
ctrl = 1

[statedef 806]
Type = A
MoveType = H
Physics  = A
Ctrl = 0
SprPriority = 0

[State 0, PosAdd]
type = PosAdd
trigger1 = !time
x = -80

[State 0, SelfState]
type = SelfState
trigger1 = 1
value = 5050
ctrl = 0

[statedef 900]
Type = S
MoveType = I
Physics  = N
Ctrl = 0
SprPriority = -1
Facep2 = 0;1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
trigger1 = anim != 900
value = 900
ignorehitpause = 1

[State 0, Turn]
type = Turn
triggerall = animelem = 1
trigger1 = p2dist X < 0
trigger2 = enemynear,name = "ARCHETYPE:ALCERIS" && (enemynear,stateno = 1205 || enemynear,stateno = 2200) && enemynear,facing = facing

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 1
var(0) = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 1
value = S20,4

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 1
value = S40,0

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 1
trigger1 = pos Y >= 0
x = 0

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = anim = 900
trigger1 = animelemtime(4) >= 0
trigger1 = command != "hold_z"
trigger2 = power <= 0
value = 901

[State 0, CtrlSet]
type = CtrlSet
trigger1 = anim = 901
trigger1 = helper(910),var(7)
value = 1

[State 0, PowerAdd]
type = PowerAdd
triggerall = fighting
trigger1 = anim = 900
value = -10

[State 0, PlayerPush]
type = PlayerPush
trigger1 = anim = 900
trigger1 = animelemtime(4) >= 0
value = 0

[State 0, SprPriority]
type = SprPriority
trigger1 = anim = 901
value = 1

[State 0, VarSet]
type = VarSet
trigger1 = facing = 1
trigger1 = pos X+camerapos X < enemynear,pos X+camerapos X
trigger2 = facing = -1
trigger2 = enemynear,pos X+camerapos X < pos X+camerapos X
fvar(0) = enemynear,pos X+camerapos X
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
triggerall = anim = 900
triggerall = p2name != "ARCHETYPE:ALCERIS"
trigger1 = facing = 1
trigger1 = pos X+camerapos X < fvar(0)
trigger2 = facing = -1
trigger2 = fvar(0) < pos X+camerapos X
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1
ignoreproj = -1
ignorehelper = -1

[State 0, VarSet]
type = VarSet
trigger1 = var(10)
fvar(0) = enemynear,pos X+camerapos X
ignorehitpause = 1

[State 0, VarAdd]
type = VarSet
trigger1 = 1
var(10) = fvar(0) != enemynear,pos X+camerapos X

[State 0, NotHitBy]
type = NotHitBy
trigger1 = anim = 900
trigger1 = enemynear,name = "ARCHETYPE:ALCERIS"
value = SCA,AA,AP,NT,ST
value2 = SA,HT
time = 1
ignorehitpause = 1
dodge = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = var(0)
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1
dodge = 1
ignoreproj = -1
ignorehelper = -1

[State 0, Helper]
type = Helper
trigger1 = anim = 900
trigger1 = !numhelper(910)
helpertype = player
name = "Karmic Barrier"
ID = 910
stateno = 910
pos = 10,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
size.height = 136
supermovetime = 9999999999999
pausemovetime = 9999999999999

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y >= 0
statetype = S

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y < 0
statetype = A

[State 0, PosSet]
type = PosSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, Gravity]
type = Gravity
trigger1 = statetype = A

[State 0, VelMul]
type = VelMul
trigger1 = statetype = S
x = const(movement.stand.friction)

[State 0, ChangeState]
type = ChangeState
trigger1 = anim = 901
trigger1 = !animtime
value = (statetype = A)*50
ctrl = 1
ignorehitpause = 1

[statedef 910]
Type = S
MoveType = I
Physics  = N
Ctrl = 0
SprPriority = 0

[State 0, Turn]
type = Turn
trigger1 = facing != parent,facing
ignorehitpause = 1 

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1

[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
pos = 10,0
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = 1
x = parent,pos X + (10*facing)
y = parent,pos Y
ignorehitpause = 1

[State 0, ChangeAnim]
type = Null;ChangeAnim
trigger1 = anim != 910
value = 910
ignorehitpause = 1

[State 0, HitOverride]
type = Null;HitOverride
trigger1 = 1
attr = SCA,AA,AP,AT
slot = 0
stateno = 910
time = 1
forceair = 0
ignorehitpause = 1
persistent = 1

[State 0, ParentVarSet]
type = ParentVarSet
trigger1 = !hitshakeover
trigger2 = gethitvar(hitcount) > var(7)
var(0) = 10

[State 0, VarSet]
type = VarSet
trigger1 = 1
var(7) = gethitvar(hitcount)

[State 0, ParentVarSet]
type = ParentVarSet
trigger1 = parent,movetype = H
var(0) = 0

[State 0, PowerAdd]
type = Null;PowerAdd
trigger1 = GetHitVar(damage)
value = GetHitVar(damage)*7
ignorehitpause = 1
persistent = 0

[State 0, NotHitBy]
type = NotHitBy
triggerall = !parent,var(0)
triggerall = parent,anim = 900 || parent,stateno = 900
trigger1 = p2name = "ARCHETYPE:ALCERIS"
value = C,HT
time = 1
ignorehitpause = 1

[State 0, Offset]
type = Offset
trigger1 = 1
y = -70
ignorehitpause = 1

[State 0, SprPriority]
type = SprPriority
trigger1 = parent,anim != 900
value = 2
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = parent,anim = 900
value = 1
ignorehitpause = 1

[State 0, VarSet]
type = Null;VarSet
trigger1 = parent,var(3) != gametime
trigger1 = !var(1)
v = 1
value = animelemno(0)

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = pause || super
value = 910
elem = var(1)
ignorehitpause = 1

[State 0, VarAdd]
type = Null;VarAdd
trigger1 = time
trigger1 = var(0) < 10
trigger1 = parent,anim = 900
trigger1 = parent,var(3) = gametime
v = 0
value = 1
ignorehitpause = 1

[State 0, VarAdd]
type = Null;VarAdd
triggerall = var(0) > 0
trigger1 = parent,anim != 900
trigger1 = parent,var(3) = gametime
trigger2 = parent,stateno != 900
v = 0
value = -1
ignorehitpause = 1

[State 0, AngleDraw]
type = Null;AngleDraw
trigger1 = 1
scale = var(0)*0.03,var(0)*0.04
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = 1
movetype = I

[State 0, DestroySelf]
type = DestroySelf
trigger1 = var(0) = 0
trigger1 = parent,anim != 900
ignorehitpause = 1

[Statedef 930,ゲジマユ]
	Type=U
	MoveType=A
	physics=N
	Ctrl=0
	velset=0,0
	sprPriority=2

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 930
value = 930
ignorehitpause = 1

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

	[State 6669,汎用初期化];
		type = Varset
		Trigger1=time = 0
		var(0) = 0
		IgnoreHitPause=1

	[State -2, 時間設定]
		type = VarSet
triggerall = roundstate = 2
		trigger1 = !time
		var(21) = Power
[State -2];
	type = Varset
triggerall = roundstate = 2
	trigger1 = AnimElem = 4
	var(12) = power

[State 930, 無敵]
type = NotHitBy
trigger1 = time <= 15
value = SCA
ignorehitpause = 1

[State 930,揺れ]
type = EnvShake
trigger1 = animelem = 4
time = 20
ampl = 5

[State 930, 発動SE]
type = PlaySnd
trigger1 = animelem = 4
value = S30,8

[State 580, ボイス1]
type = PlaySnd
trigger1 = animelem = 1
value = S100,ifelse(random%2,41,ifelse(random%2,random%2,ifelse(random%2,106,39)))

[State 580, 青リングエフェ]
type = Explod
trigger1 = animelemtime(4) = -4
id = 10970
anim = 10970
postype = p1
pos = 0,0
supermovetime = -1
pausemovetime = -1
ownpal = 1
scale = 0.5,0.5
sprpriority = 3
ignorehitpause = 1

[State 580, 月世界背景]
type = Explod
trigger1 = !NumExplod(10910)
trigger1 = animelem = 2
anim = 10910
id = 10910
pos = 0,0
postype = back
bindtime = 999
ownpal = 1
supermovetime = -1
pausemovetime = -1
scale = 0.4,0.4
sprpriority = -5
ignorehitpause = 1

[State 580, 青リングエフェ]
type = Explod
trigger1 = !NumExplod(10260)
trigger1 = animelem = 3
id = 10260
anim = 10260
postype = p1
pos = 0,-85
supermovetime = -1
pausemovetime = -1
ownpal = 1
persistent = 0
scale = 0.5,0.5
ignorehitpause = 1

[State 580, 衝撃波（サークル）]
type = Explod
trigger1 = !NumExplod(10908)
trigger1 = animelem = 5
anim = 10908
id = 10908
pos = 0,-80
postype = p1
bindtime = 1
supermovetime = -1
pausemovetime = -1
ownpal = 1
scale = 0.5,0.5
sprpriority = 3
ignorehitpause = 1

[State 580, 衝撃波（刃）]
type = Explod
trigger1 = animelem = 5
anim = 13556
id = 13556
pos = -5,-90
postype = p1
bindtime = 1
angle = 10+(random%82)
supermovetime = -1
pausemovetime = -1
ownpal = 1
scale = 0.5,0.5
persistent = 0
sprpriority = 3
ignorehitpause = 1

[State 580, 衝撃波（刃）]
type = Explod
trigger1 = animelem = 5
anim = 13556
id = 13556
pos = -5,-90
postype = p1
bindtime = 1
angle = -10-(random%82)
supermovetime = -1
pausemovetime = -1
ownpal = 1
scale = 0.5,0.5
persistent = 0
sprpriority = 3
ignorehitpause = 1

[State 580, 砂煙 - 右]
type = Explod
trigger1 = animelemtime(4) >= 0 && time <= 35
trigger1 = timemod = 3,1
anim = 11800
id = 11800
pos = 7,1
facing = -1
vel = 4.6875,0
accel = -.1953125,0
postype = p1
supermovetime = -1
pausemovetime = -1
ownpal = 1
scale = 1.0,1.0
removeongethit = 0
sprpriority = 4
persistent = 5
ignorehitpause = 1

[State 580, 砂煙影 - 右]
type = Explod
trigger1 = animelemtime(4) >= 0 && time <= 35
trigger1 = timemod = 3,1
anim = 11850
id = 11850
pos = 7,1
facing = -1
vel = 4.6875,0
accel = -.1953125,0
postype = p1
supermovetime = -1
pausemovetime = -1
ownpal = 1
scale = 1.0,1.0
removeongethit = 0
sprpriority = 3
persistent = 5
ignorehitpause = 1

[State 580, 砂煙 - 左]
type = Explod
trigger1 = animelemtime(4) >= 0 && time <= 35
trigger1 = timemod = 3,1
anim = 11800
id = 11800
pos = -7,1
facing = 1
vel = -4.6875,0
accel = .1953125,0
postype = p1
supermovetime = -1
pausemovetime = -1
ownpal = 1
scale = 1.0,1.0
removeongethit = 0
sprpriority = 4
persistent = 5
ignorehitpause = 1

[State 580, 砂煙影 - 左]
type = Explod
trigger1 = animelemtime(4) >= 0 && time <= 35
trigger1 = timemod = 3,1
anim = 11850
id = 11850
pos = -7,1
facing = 1
vel = -4.6875,0
accel = .1953125,0
postype = p1
supermovetime = -1
pausemovetime = -1
ownpal = 1
scale = 1.0,1.0
removeongethit = 0
sprpriority = 3
persistent = 5
ignorehitpause = 1

[State 580, 十字エフェ]
type = Explod
trigger1 = !NumExplod(11900)
trigger1 = animelem = 5
anim = 11900
id = 11900
pos = 6,-94
postype = p1
supermovetime = -1
pausemovetime = -1
ownpal = 1
bindtime = 999
scale = 0.5,0.5
sprpriority = 3
removeongethit = 0
ignorehitpause = 1

[State 930, サーキットスパーク攻撃 - hitdef定義]
type = HitDef
trigger1 = animelem = 4
attr = 
damage = 0,0
animtype = light
ground.type = high
guardflag = 
hitflag = MAFP
priority = ifelse(palno = 12,777,3), Hit
pausetime = 0,18
getpower = 0,0
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-73
hitsound = -1
guardsound = S10,0
ground.slidetime = 11
ground.hittime = 11
guard.velocity = -4.6
ground.velocity = -1.5,-6.8
air.velocity = -1.5,-6.8
airguard.velocity = -4,-5
ground.cornerpush.veloff = -6.5
air.cornerpush.veloff = -6.5
fall = 1
fall.recovertime = Ceil((2*(53.65*(6.65/0.55)-0.5*0.55*((6.65/0.55)**2)-(EnemyNear,Pos Y))/0.55)**0.5+(6.65/0.55))-var(16)
yaccel = .54
kill = 0
abshit = 1

[State 0, VarSet]
type = VarSet
trigger1 = movehit
var(1) = 1
ignorehitpause = 1

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1
fvar(0) = 5.0
ignorehitpause = 1
persistent = 0

[State 930, 相手引き込み]
type = Null;TargetState
trigger1 = movehit && EnemyNear,hitshakeover
value = 937
persistent = 0
ignorehitpause = 1

[State 930, サーキットスパーク終了 - ステート移動]
type = ChangeState
trigger1 = animtime = 0
value = ifelse(statetype = A,50,0)
ctrl = 1

[statedef 970]
Type = S
MoveType = I
Physics  = N
Ctrl = 0
velset = 0,0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 970

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, PowerSet]
type = PowerSet
triggerall = anim = 970
triggerall = animelemtime(3) >= 0
triggerall = power < 6000
trigger1 = (power+3) >= 6000
value = 6000
ignorehitpause = 1

[State 6500, パワーゲージ増減]
type = PowerAdd
triggerall = anim = 970
triggerall = power < 6000
trigger1 = animelemtime(3)>=0
value = ((power < 1000)*9)+((power < 2000)*5)+((power < 3000)*5)+((power < 4000)*3)+((power < 5000)*2)+((power < 6000)*3)

[State 0, Helper]
type = Helper
trigger1 = anim = 970
trigger1 = animelemtime(3) >= 0
trigger1 = (time-8)%4 = 0
name = "RAINBOWLIGHTNING"
ID = 971
stateno = 971
pos = 30,-88
postype = p1
facing = 1
ownpal = 1

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = anim = 970
triggerall = animelemtime(3) >= 1
trigger1 = command != "hold_y"
trigger2 = power >= 6000
value = 971

[State 0, ChangeState]
type = ChangeState
trigger1 = anim = 971
trigger1 = !animtime
value = 0
ctrl = 1

[statedef 971]
Type = S
MoveType = I
Physics  = N
Ctrl = 0
sprpriority = 2

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 13150
value = 13150

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = !time
value = S40,0

[State 0, AngleSet]
type = AngleSet
trigger1 = !time
value = -(45+random%91)

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(10) = random

[State 三粒の天滴_R]
type = Varset
triggerall = !time
trigger1 = (var(10)*36)%1536 = [0,255]
trigger1 = fvar(37) := 256-(var(10)*36)%256
trigger2 = (var(10)*36)%1536 = [256,767]
trigger2 = fvar(37) := 0
trigger3 = (var(10)*36)%1536 = [768,1023]
trigger3 = fvar(37) := (var(10)*36)%256
trigger4 = (var(10)*36)%1536 = [1024,1535]
trigger4 = fvar(37) := 256
fvar(37) = fvar(37)

[State 三粒の天滴_G]
type = Varset
triggerall = !time
trigger1 = (var(10)*36)%1536 = [0,512]
trigger1 = fvar(38) := 256
trigger2 = (var(10)*36)%1536 = [512,767]
trigger2 = fvar(38) := 256-(var(10)*36)%256
trigger3 = (var(10)*36)%1536 = [768,1279]
trigger3 = fvar(38) := 0
trigger4 = (var(10)*36)%1536 = [1280,1535]
trigger4 = fvar(38) := (var(10)*36)%256
fvar(38) = fvar(38)

[State 三粒の天滴_B]
type = Varset
triggerall = !time
trigger1 = ((var(10)*36)%1536 = [0,255]) + ((var(10)*36)%1536 = [1280,1535])
trigger1 = fvar(39) := 0
trigger2 = (var(10)*36)%1536 = [256,511]
trigger2 = fvar(39) := (var(10)*36)%256
trigger3 = (var(10)*36)%1536 = [512,1023]
trigger3 = fvar(39) := 256
trigger4 = (var(10)*36)%1536 = [1024,1279]
trigger4 = fvar(39) := 256-(var(10)*36)%256
fvar(39) = fvar(39)

[State 三粒の天滴_PalFX]
type = PalFX
trigger1 = 1
time = 1
mul = 256+floor(fvar(37)),256+floor(fvar(38)),256+floor(fvar(39))
invertall = 0
color = 0
IgnoreHitPause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime

[statedef 1000]
Type = U
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 1000
value = 1000

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VarAdd]
type = VarAdd
trigger1 = !time
var(0) = 1000000

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 1
var(3) = 0

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 1
var(6) = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y >= 0
statetype = S

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y < 0
statetype = A

[State 0, PosSet]
type = PosSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = cond(Pos Y < 0,0.9,const(movement.stand.friction))
y = 0.9

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3 && random%2
value = S100,161+random%7
channel = 4

[State 0, Helper]
type = Helper
trigger1 = animelemtime(7) = -10
helpertype = normal ;player
name = "eh"
ID = 1006
stateno = 1003
pos = 40,-80
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0

[State 0, Helper]
type = Helper
trigger1 = animelem = 7
helpertype = normal ;player
name = "Starlight Ball"
ID = 1001
stateno = 1001
pos = 37,-79
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = (StateType = A)*50

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = (StateType = A)*50
ctrl = 1

[statedef 1050]
Type = U
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 1050
value = 1050

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VarAdd]
type = VarAdd
trigger1 = !time
var(0) = 1000000

[State 0, VarSet]
type = VarSet
trigger1 = animelem = 1
var(6) = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y >= 0
statetype = S

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y < 0
statetype = A

[State 0, PosSet]
type = PosSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = cond(Pos Y < 0,0.9,const(movement.stand.friction))
y = 0.9

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3 && random%2
value = S100,161+random%7
channel = 4

[State 0, Explod]
type = Explod
trigger1 = animelem = 7
anim = 1006
ID = 1006
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -animelemtime(13)
sprpriority = 2
ownpal = 0
removeongethit = 0
ignorehitpause = 0

[State 0, Helper]
type = Helper
trigger1 = animelem = 7, = 10
helpertype = normal ;player
name = "Starlight Ball"
ID = 1005
stateno = 1001
pos = 37,-79
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0

[State 0, Helper]
type = Helper
trigger1 = animelem = 7
helpertype = normal ;player
name = "eh"
ID = 1006
stateno = 1003
pos = 40,-80
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = (StateType = A)*50

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = (StateType = A)*50
ctrl = 1

[statedef 1001]
MoveType = A
Physics  = N
Anim = 1001
SprPriority = 6
Ctrl = 0

[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,stateno = 3700
recursive = 1
removeexplods = 1
ignorehitpause = 1

[State 10038, SE]
type = PlaySnd
trigger1 = !time
value = S40, 0

[State 10361, 残像]
Type          = Null;AfterImage
Trigger1      = MoveContact || MoveReversed
Time          = 0
ignorehitpause = 1

[state 10361]
type     = AssertSpecial
trigger1 = 1
flag     = noshadow
ignorehitpause = 1

[State -2]
Type = Helper
triggerall = anim != 1004
trigger1 = MoveHit || MoveGuarded || MoveReversed || MoveClash || MoveClashed
StateNo = 1003
ID = 1003
PosType = P1
Pos = 0,0
Ownpal = 1
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = anim != 1004
trigger1 = MoveHit || MoveGuarded || MoveReversed || MoveClash || MoveClashed
value = 1004
elem = 1
ignorehitpause = 1

[State 0, PosFreeze]
type = PosFreeze
trigger1 = Anim = 1004
value = 1
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Anim = 1004
movetype = I
ignorehitpause = 1

[State 10361, 変数] ;相殺強度
type     = Varadd
Trigger1 = anim = 1004
var(0)   = 1
ignorehitpause = 1

[state 11201, 透過]
type     = Trans
trigger1 = 1
trans    = add
alpha    = 256-(16*var(0)), 256
ignorehitpause = 1

;-------------------------------------------------[演出]

[State 12802, 設定反映]
type     = AngleDraw
trigger1 = 1
scale    = 0.2+(var(0)*0.02),0.2+(var(0)*0.02)
value    = ifelse(anim = 1001,random%360,0)
ignorehitpause = 1

[State 10361, 残像]
Type          = Null;AfterImage
Trigger1      = !time
Time          = -1					;残像の時間
Length        = 5					;履歴保存数
TimeGap       = 1					;履歴保存間隔
FrameGap      = 1					;履歴表示間隔
PalContrast   = 128,128,255
PalBright     = 0,0,0
PalPostBright = 0,0,0
PalAdd        = 0,0,0
PalMul        = 0.9,0.9,0.9
Trans         = Add

[State -2]
Type = Null;Helper
trigger1 = anim != 1004
Trigger1 = time%4 = 0
StateNo = 1002
ID = 1002
PosType = P1
Pos = 0,0
Ownpal = 1
SprPriority = 4
size.yscale = 0.8

[State 3201, Angle 4]
type = Null;Angleset
trigger1 = !time
trigger1 = parent,vel X != 0
value = -180/pi * atan((parent,vel y) / (parent,vel x*cond(parent,vel X < 0,-1,1)))

[State 3201, Angle 4]
type = Null;Angleset
trigger1 = !time
trigger1 = parent,vel X = 0
value = -90 * cond(parent,vel y < 0,-1,1)

[state 10361, 変数] ;三角関数用
type     = Varset
trigger1 = !Time
var(2)   = 0

[state 10361, 変数] ;三角関数用
type = Varadd
trigger1 = 1
var(2)   = 6

[State -1]
Type     = VarSet
Trigger1 = !time
fvar(4) = Pi*(facing = -1)

[State 0, VarSet]
type = VarSet
triggerall = roundstate = 2
trigger1 = !MoveContact
fvar(0) = pos X+7*Cos(fvar(4))

[State 0, VarSet]
type = VarSet
triggerall = roundstate = 2
trigger1 = !MoveContact
fvar(1) = pos Y-7*Sin(fvar(4))

[State -1]
Type = VarSet
triggerall = roundstate = 2
trigger1 = !MoveContact
fvar(2) = EnemyNear,Pos Y-EnemyNear,spritecenter.y

[State 0, VarSet]
type = VarSet
triggerall = roundstate = 2
trigger1 = !MoveContact
fvar(3) = ((enemynear,pos X-pos X)*(fvar(1)-pos Y))-(fvar(2) - pos Y)*(fvar(0)-pos X)

[State 0, VarSet]
type = VarSet
triggerall = roundstate = 2
trigger1 = !MoveContact
fvar(5) = ATan((enemynear,pos X-pos X)/(fvar(2)-pos Y))-((.5*Pi)*IfElse(((fvar(2)-pos Y)<0),-1,1))

[State 0, VarSet]
type = VarSet
triggerall = !MoveContact
trigger1 = roundstate = 2
var(1) = ifelse(abs(fvar(5) - fvar(4)) <= ifelse(ishelper(1006),28,14)*(Pi/180.0),1,0)

[State 0, VarSet]
type = VarSet
trigger1 = var(1)
fvar(4) = fvar(5)

[State 0, VarAdd]
type = VarAdd
triggerall = !var(1)
triggerall = roundstate = 2
trigger1 = !MoveContact && !ishelper(1006)
fvar(4) = ifelse(fvar(3) < 0,-7,7)*(Pi/180.0)

[State 0, VarAdd]
type = VarAdd
triggerall = !var(1)
triggerall = roundstate = 2
trigger1 = !MoveContact && ishelper(1006)
fvar(4) = ifelse(fvar(3) < 0,-14,14)*(Pi/180.0)

[State 0, VarAdd]
type = VarAdd
trigger1 = fvar(4) > Pi
fvar(4) = -2*Pi

[State 0, VarAdd]
type = VarAdd
trigger1 = fvar(4) < -Pi
fvar(4) = 2*Pi

[State -1]
Type     = VelSet
trigger1 = anim != 1004
X        = (7+!ishelper(1001)*7)*Cos(FVar(4))*facing
Y        = (-7-!ishelper(1001)*7)*Sin(FVar(4))

[State 0, Explod]
type = Explod
trigger1 = anim != 1004
Trigger1 = time%ifelse(!ishelper(1001),2,4) = 0
anim = 1005
ID = 1005
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 0
removetime = -2
pausemovetime = 0
scale = .15,.5
angle = ifelse(vel X = 0,0,-180/pi * atan(vel y / vel x))
sprpriority = 4
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
ignorehitpause = 1

;-------------------------------------------------[ヒット定義]

[State 10361, HitDef]
type                = HitDef
trigger1 = p2name != "ARCHETYPE:ALCERIS" || (p2stateno != [900,910]) || (facing = enemynear,facing && vel X < 0) || (facing != enemynear,facing && vel X > 0)
trigger1 = !ishelper(1006)
trigger1            = !MoveContact && !MoveReversed
attr                = S, NP
hitflag             = MAFP
guardflag           = MA
damage              = Ceil(60/(root,fvar(0)-root,fvar(1)))
animtype            = Hard
air.animtype        = Back
ground.type         = Low
priority            = ifelse(palno = 12,777,3), Hit
p1sprpriority = 6
pausetime           = 0, 4
sparkno             = -1
sparkxy             = -Random%20, Random%10*Cond(Random%2,-1,1)
guard.sparkno       = S10000
hitsound            = S30,2
guardsound          = S10,0
ground.slidetime    = 17 + ((p2movetype=A)*7)
ground.hittime      = 17 + ((p2movetype=A)*7)
guard.slidetime     = 15
guard.hittime       = 15
air.hittime         = 17 + ((p2movetype=A)*7)
ground.velocity     = -6.25*Cos(FVar(4))*facing, -6.25*Sin(FVar(4))
guard.velocity      = -8*Cos(FVar(4))*facing
air.velocity        = -6.25*Cos(FVar(4))*facing, -6.25*Sin(FVar(4))
airguard.velocity   = -6*Cos(FVar(4))*facing, -3*Sin(FVar(4))
fall                = 1
air.fall            = 1
fall.recovertime    = ceil(35*(1+(0.5*(p2movetype=A))))
getpower            = 60, 60
givepower           = 30, 0
Ground.CornerPush.VelOff   = 0
Air.CornerPush.VelOff      = 0
Down.CornerPush.VelOff     = 0
Guard.CornerPush.VelOff    = 0
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 10361, HitDef]
type                = HitDef
trigger1 = p2name != "ARCHETYPE:ALCERIS" || (p2stateno != [900,910]) || (facing = enemynear,facing && vel X < 0) || (facing != enemynear,facing && vel X > 0)
trigger1 = ishelper(1006)
trigger1            = !MoveContact && !MoveReversed
attr                = S, HP
hitflag             = MAFP
guardflag           = MA
damage              = Ceil(60/(root,fvar(0)-root,fvar(1))),Ceil(10/(root,fvar(0)-root,fvar(1)))
animtype            = Hard
air.animtype        = Back
ground.type         = Low
priority            = ifelse(palno = 12,777,3), Hit
p1sprpriority = 6
pausetime           = 0, 4
sparkno             = -1
sparkxy             = -Random%20, Random%10*Cond(Random%2,-1,1)
guard.sparkno       = S10000
hitsound            = S30,2
guardsound          = S10,0
ground.slidetime    = 17 + ((p2movetype=A)*7)
ground.hittime      = 17 + ((p2movetype=A)*7)
guard.slidetime     = 15
guard.hittime       = 15
air.hittime         = 17 + ((p2movetype=A)*7)
ground.velocity     = -6.25*Cond(Vel X < 0,-1,1), -6.25
guard.velocity      = -8*Cond(Vel X < 0,-1,1)
air.velocity        = -6.25*Cond(Vel X < 0,-1,1), -6.25
airguard.velocity   = -6*Cond(Vel X < 0,-1,1), -3
fall                = 1
air.fall            = 1
fall.recovertime    = ceil(35*(1+(0.5*(p2movetype=A))))
getpower            = 0, 0
givepower           = 30, 0
Ground.CornerPush.VelOff   = 0
Air.CornerPush.VelOff      = 0
Down.CornerPush.VelOff     = 0
Guard.CornerPush.VelOff    = 0
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarAdd]
type = RootVarAdd
triggerall = !ishelper(1006)
trigger1 = Floor(Root,Var(0)/1000000)%10 = 0
var(0) = 1000000

[State 0, VarSet]
type = RootVarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, DelegateTarget]
type = DelegateTarget
trigger1 = NumTarget
ignorehitpause = 1

[State 10361, ヘルパー消滅]  ;終了(相手に接触)
Type     = DestroySelf
;Trigger1 = Root,Movetype = H
;Trigger1 = Anim != 1004
Trigger1 = Anim = 1004
Trigger1 = var(0) = 16
Trigger2 = MoveContact || roundstate > 2
Trigger2 = Anim = 1001
Trigger2 = BackEdgeDist < -40 || FrontEdgeDist < -40 || Pos Y < TopEdge-40 || Pos Y > BottomEdge-40
ignorehitpause = 1

[Statedef 1002]
type     = A
movetype = I
physics  = N
ctrl     = 0
Anim     = 1002
sprpriority = 7

[State 0, Turn]
type = Turn
trigger1 = !time
trigger1 = parent,vel X < 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
trigger1 = parent,vel X < 0
var(0) = 1

[state 11201]
type     = AssertSpecial
trigger1 = 1
flag     = noshadow

;-------------------------------------------------[透過設定]

[State 11201, 変数]
type     = VarAdd
trigger1 = time >= 6
var(2)   = 15

[state 11201, 透過]
type     = Trans
trigger1 = 1
trans    = add
alpha    = 256-var(2), 256

;-------------------------------------------------[サイズ設定]

[State 3201, Angle 4]
type = Angleset
trigger1 = !time
trigger1 = parent,vel X != 0
value = -180/pi * atan((parent,vel y) / (parent,vel x*cond(parent,vel X < 0,-1,1)))

[State 3201, Angle 4]
type = Angleset
trigger1 = !time
trigger1 = parent,vel X = 0
value = -90 * cond(parent,vel y < 0,-1,1)

[State 11205, 設定反映]
type     = AngleDraw
trigger1 = 1
scale    = 0.125+time*0.005, (0.25+time*0.01)*cond(var(0),-1,1)

;-------------------------------------------------[終了]

[State 11205, ヘルパー消滅]
Type     = DestroySelf
Trigger1 = var(2) >= 256

[Statedef 1003]
type     = A
movetype = I
physics  = N
ctrl     = 0
Anim     = 1003
sprpriority = 7

[State 0, Turn]
type = Turn
trigger1 = !time
trigger1 = parent,vel X < 0
trigger1 = parent,ishelper

[State 0, VarSet]
type = VarSet
trigger1 = !time
trigger1 = parent,vel X < 0
trigger1 = parent,ishelper
var(0) = 1

[state 11201]
type     = AssertSpecial
trigger1 = 1
flag     = noshadow

[State 3201, Angle 4]
type = Angleset
trigger1 = !time
trigger1 = parent,vel X != 0
value = (-180/pi * atan((parent,vel y) / (parent,vel x*cond(parent,vel X < 0,-1,1))))-25*cond(var(0),-1,1)

[State 3201, Angle 4]
type = Angleset
trigger1 = !time
trigger1 = parent,vel X = 0
value = (-90 * cond(parent,vel y < 0,-1,1))-25*cond(var(0),-1,1)

[State 3201, Angle 4]
type = Angleset
trigger1 = !time
trigger1 = !ishelper(1003)
trigger1 = !ishelper(3002)
value = -25

[State 0, BindToParent]
type = BindToParent
trigger1 = ishelper(1006)
time = 99
pos = 40,-80

[State 11205, 設定反映]
type     = AngleDraw
trigger1 = ishelper(1003)
scale    = 0.25+(time*0.01),(0.25+(time*0.01))*cond(var(0),-1,1)

[State 11205, 設定反映]
type     = AngleDraw
trigger1 = !ishelper(1003)
trigger1 = !ishelper(3002)
scale    = 0.25-(time*0.025),0.25-(time*0.025)

[State 11205, 設定反映]
type     = AngleDraw
trigger1 = ishelper(3002)
scale    = 1.25+(time*0.1),(1.25+(time*0.1))*cond(var(0),-1,1)

[State 0, VarSet]
type = VarSet
trigger1 = !time
trigger1 = ishelper(1007)
fvar(0) = -parentdist X

[State 0, VarSet]
type = VarSet
trigger1 = !time
trigger1 = ishelper(1007)
fvar(1) = -parentdist Y

[State 0, BindToParent]
type = BindToParent
trigger1 = ishelper(1007)
time = 99
pos = fvar(0),fvar(1)

[State 0, Helper]
type = Helper
trigger1 = time = 10
trigger1 = ishelper(1007)
helpertype = normal ;player
name = "Starlight Ball"
ID = 1006
stateno = 1001
pos = -3,1
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime
trigger2 = time = 10
trigger2 = !ishelper(1003)
trigger2 = !ishelper(3002)
trigger3 = parent,movetype = H

[statedef 1100]
Type = U
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 1100
value = 1100

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 11
value = S100,cond(random%2,172+(random%2),158+(random%3))
channel = 4

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y >= 0
statetype = S

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y < 0
statetype = A

[State 0, PosSet]
type = PosSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = cond(Pos Y < 0,0.9,const(movement.stand.friction))
y = 0.9

[State 0, Explod]
type = Explod
trigger1 = animelem = 7
anim = 1101
ID = 1101
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -animelemtime(17)
sprpriority = 2
pausemovetime = 0
supermovetime = 0
ownpal = 0
removeongethit = 0
ignorehitpause = 0

[State 0, Helper]
type = Null;Helper
trigger1 = !time
helpertype = normal ;player
name = "eh"
ID = 11000
stateno = 11000
pos = 5,-80+(random%10*cond(random%2,-1,1))
postype = p1    ;p2,front,back,left,right
ownpal = 1

[State 0, Helper]
type = Null;Helper
trigger1 = time = 10
helpertype = normal ;player
name = "eh"
ID = 11000
stateno = 11000
pos = 5,-80+(random%10*cond(random%2,-1,1))
postype = p1    ;p2,front,back,left,right
ownpal = 1

[State 0, Helper]
type = Null;Helper
trigger1 = time = 20
helpertype = normal ;player
name = "eh"
ID = 11000
stateno = 11000
pos = 5,-80+(random%10*cond(random%2,-1,1))
postype = p1    ;p2,front,back,left,right
ownpal = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 1;animelemtime(17) = 0;-6
name = "Starlight Cannon"
ID = 11000
stateno = 11000
pos = 0,0;45,-80
postype = p1    ;p2,front,back,left,right
ownpal = 1

[State 4701, AD/AADズコーン時の波動エフェ 2]
type = Explod
trigger1 = animelem = 17
anim = 10083
id = 10083
pos = 45,-80
postype = p1
bindtime = 0
ownpal = 1
scale = 0.5,0.5
removeongethit = 0
sprpriority = 8
ownpal = 1

;[State 0, VarSet]
;type = VarSet
;trigger1 = !AnimTime
;v = 20
;value = (StateType = A)*50

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = (StateType = A)*50
ctrl = 1

[statedef 11000]
Type = S
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 8
;Anim = 110000;10064

[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,stateno = 3700
recursive = 1
removeexplods = 1
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 110001
trigger1 = parent,animelemtime(17) < 0
value = 110001

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 110000
trigger1 = parent,animelemtime(17) >= 0
value = 110000

[State 0, BindToParent]
type = BindToParent
trigger1 = anim = 110001
time = 1
pos = 45,-80

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT

[State 10038, SE]
type = PlaySnd
trigger1 = anim = 110001
trigger1 = animelem = 3
value = S30,17

[State 10038, SE]
type = PlaySnd
trigger1 = anim = 110000
trigger1 = animelem = 1
value = S40,2

[State 0, Explod]
type = Explod
trigger1 = anim = 110000
trigger1 = animelem = 1
anim = 1003
ID = 1003
pos = 0,0
angle = -25
postype = p1
bindtime = 0
removetime = -2
sprpriority = 9
ownpal = 1
removeongethit = 0
ignorehitpause = 0

[State 0, Explod]
type = Explod
trigger1 = anim = 110000
trigger1 = animelem = 1
anim = 1003
ID = 1003
pos = 40,0
angle = -25
vfacing = -1
postype = p1
bindtime = 0
removetime = -2
sprpriority = 9
ownpal = 1
removeongethit = 0
ignorehitpause = 0

[State 0, Explod]
type = Explod
trigger1 = anim = 110000
trigger1 = animelem = 1
anim = 1003
ID = 1003
pos = 80,0
angle = -25
postype = p1
bindtime = 0
removetime = -2
sprpriority = 9
ownpal = 1
removeongethit = 0
ignorehitpause = 0

[State 0, Explod]
type = Explod
trigger1 = anim = 110000
trigger1 = animelem = 1
anim = 1003
ID = 1003
pos = 120,0
angle = -25
vfacing = -1
postype = p1
bindtime = 0
removetime = -2
sprpriority = 9
ownpal = 1
removeongethit = 0
ignorehitpause = 0

[State 10038, SE]
type = Null;PlaySnd
trigger1 = !time
value = S40,4

[State 三粒の天滴_R]
type = Varset
trigger1 = ((var(0)+124)*(1280/21))%1536 = [0,255]
trigger1 = fvar(37) := 256-((var(0)+124)*(1280/21))%256
trigger2 = ((var(0)+124)*(1280/21))%1536 = [256,767]
trigger2 = fvar(37) := 0
trigger3 = ((var(0)+124)*(1280/21))%1536 = [768,1023]
trigger3 = fvar(37) := ((var(0)+124)*(1280/21))%256
trigger4 = ((var(0)+124)*(1280/21))%1536 = [1024,1535]
trigger4 = fvar(37) := 256
fvar(37) = fvar(37)

[State 三粒の天滴_G]
type = Varset
trigger1 = ((var(0)+124)*(1280/21))%1536 = [0,512]
trigger1 = fvar(38) := 256
trigger2 = ((var(0)+124)*(1280/21))%1536 = [512,767]
trigger2 = fvar(38) := 256-((var(0)+124)*(1280/21))%256
trigger3 = ((var(0)+124)*(1280/21))%1536 = [768,1279]
trigger3 = fvar(38) := 0
trigger4 = ((var(0)+124)*(1280/21))%1536 = [1280,1535]
trigger4 = fvar(38) := ((var(0)+124)*(1280/21))%256
fvar(38) = fvar(38)

[State 三粒の天滴_B]
type = Varset
trigger1 = (((var(0)+124)*(1280/21))%1536 = [0,255]) + (((var(0)+124)*(1280/21))%1536 = [1280,1535])
trigger1 = fvar(39) := 0
trigger2 = ((var(0)+124)*(1280/21))%1536 = [256,511]
trigger2 = fvar(39) := ((var(0)+124)*(1280/21))%256
trigger3 = ((var(0)+124)*(1280/21))%1536 = [512,1023]
trigger3 = fvar(39) := 256
trigger4 = ((var(0)+124)*(1280/21))%1536 = [1024,1279]
trigger4 = fvar(39) := 256-((var(0)+124)*(1280/21))%256
fvar(39) = fvar(39)

[State 0, VarAdd]
type = VarAdd
trigger1 = 1
var(0) = 1

[State 三粒の天滴_PalFX]
type = PalFX
trigger1 = 1
time = 1
mul = 256+floor(fvar(37)),256+floor(fvar(38)),256+floor(fvar(39))
invertall = 0
color = 0
IgnoreHitPause = 1

[State 10361, HitDef]
type                = HitDef
triggerall = anim = 110000
trigger1            = HitDefAttr != S, HP
attr                = S, HP
hitflag             = MAFDP
guardflag           = MA
damage              = Ceil(180/(root,fvar(0)-root,fvar(1))),Ceil(20/(root,fvar(0)-root,fvar(1)))
animtype            = Back
ground.type         = High
priority            = ifelse(palno = 12,777,7), Hit
p1sprpriority = 8
pausetime           = 0, 24
guard.pausetime = 0, 28
;numhits = 20
sparkno             = -1
sparkxy             = -Random%20, Random%10*Cond(Random%2,-1,1)
guard.sparkno       = S10000
hitsound = s30, 2
guardsound = S10,0
ground.slidetime    = 17 + ((p2movetype=A)*7)
ground.hittime      = 17 + ((p2movetype=A)*7)
guard.slidetime     = 15
guard.hittime       = 15
air.hittime         = 17 + ((p2movetype=A)*7)
ground.velocity     = -12.5, -6.25
guard.velocity      = -18
air.velocity        = -12.5, -6.25
airguard.velocity   = -6, -3
fall                = 1
fall.recover = 0
getpower            = 192, 44
givepower           = 67, 20
id = id
nochainid = id
Ground.CornerPush.VelOff   = 0
Air.CornerPush.VelOff      = 0
Down.CornerPush.VelOff     = 0
Guard.CornerPush.VelOff    = 0
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, RootVarSet]
type = RootVarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, DelegateTarget]
type = DelegateTarget
trigger1 = NumTarget
ignorehitpause = 1

;[State 0, AngleDraw]
;type = AngleDraw
;trigger1 = 1
;value = -90

[State 0, HitAdd]
type = Null;HitAdd
triggerall = time < 26
trigger1 = movehit
value = numtarget-moveguarded

[State 0, VarAdd]
type = Null;VarAdd
trigger1 = time > 20
trigger2 = fvar(0)
trigger3 = parent,movetype = H
fv = 0
value = 256.0/15.0

[State 0, HitDef]
type = Null;HitDef
trigger1 = time > 20
trigger2 = fvar(0)
trigger3 = parent,movetype = H

[State 0, Trans]
type = Null;Trans
trigger1 = 1
trans = addalpha
alpha = 256-floor(fvar(0)),256

[State 0, DestroySelf]
type = DestroySelf
trigger1 = anim = 110000
trigger1 = animelemtime(12) >= 0;fvar(0) > 256
trigger2 = parent,movetype = H && parent,time > 0
removeexplods = parent,movetype = H && parent,time > 0

[statedef 1105]
Type = U
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 1105
value = 1105

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 8
value = S100,cond(random%2,172+(random%2),158+(random%3))
channel = 4

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = cond(Pos Y < 0,0.9,const(movement.stand.friction))
y = 0.9

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 3
x = 12
y = -12.8

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y >= 0
statetype = S

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y < 0
statetype = A

[State 0, PosSet]
type = PosSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 10038, SE]
type = PlaySnd
trigger1 = animelem = 2
value = S40, 0

[State 4701, AD/AADズコーン時の波動エフェ 2]
type = Explod
trigger1 = animelem = 2
anim = 1001
id = 1105
pos = 47, -70
postype = p1
bindtime = -1
angle = random*.359
ownpal = 1
scale = 0.2,0.2
removeongethit = 0
sprpriority = 8
ownpal = 1

[State 0, ModifyExplod]
type = ModifyExplod
triggerall = AnimElemNo(0) = 2
trigger1 = numexplod(1105)
ID = 1105
pos = 47, -70
angle = random*.359

[State 0, ModifyExplod]
type = ModifyExplod
triggerall = AnimElemNo(0) = 3
trigger1 = numexplod(1105)
ID = 1105
pos = 34, -46
angle = random*.359

[State 0, ModifyExplod]
type = ModifyExplod
triggerall = AnimElemNo(0) = 4
trigger1 = numexplod(1105)
ID = 1105
pos = 2, -32
angle = random*.359

[State 0, ModifyExplod]
type = ModifyExplod
triggerall = AnimElemNo(0) = 5
trigger1 = numexplod(1105)
ID = 1105
pos = -42, -54
angle = random*.359

[State 0, ModifyExplod]
type = ModifyExplod
triggerall = AnimElemNo(0) = 6
trigger1 = numexplod(1105)
ID = 1105
pos = -41, -106
angle = random*.359

[State 0, ModifyExplod]
type = ModifyExplod
triggerall = AnimElemNo(0) = 7
trigger1 = numexplod(1105)
ID = 1105
pos = -32, -108
angle = random*.359

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = animelem = 8
id = 1105

[State 0, Helper]
type = Helper
trigger1 = animelem = 8;animelemtime(17) = 0;-6
name = "Starlight Cannon"
ID = 11005
stateno = 11005
pos = 0,0;45,-80
postype = p1    ;p2,front,back,left,right
ownpal = 1

[State 4701, AD/AADズコーン時の波動エフェ 2]
type = Explod
trigger1 = animelem = 8
anim = 10083
id = 10083
pos = 0,0
postype = p1
bindtime = 0
angle = -90
ownpal = 1
scale = 0.5,0.5
removeongethit = 0
sprpriority = 8
ownpal = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = (StateType = A)*50
ctrl = 1

[statedef 11005]
Type = S
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 8
;Anim = 110000;10064

[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,stateno = 3700
recursive = 1
removeexplods = 1
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 110005
value = 110005

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT

[State 10038, SE]
type = PlaySnd
trigger1 = animelem = 1
value = S40,2

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -90

[State 0, Explod]
type = Explod
trigger1 = animelem = 1
anim = 1003
ID = 1003
pos = 0,0
angle = -115
postype = p1
bindtime = -1
removetime = -2
sprpriority = 9
ownpal = 1
removeongethit = 0
ignorehitpause = 0

[State 0, Explod]
type = Explod
trigger1 = animelem = 1
anim = 1003
ID = 1003
pos = 0,40
angle = -115
facing = -1
postype = p1
bindtime = 0
removetime = -2
sprpriority = 9
ownpal = 1
removeongethit = 0
ignorehitpause = 0

[State 0, Explod]
type = Explod
trigger1 = animelem = 1
anim = 1003
ID = 1003
pos = 0,80
angle = -115
postype = p1
bindtime = 0
removetime = -2
sprpriority = 9
ownpal = 1
removeongethit = 0
ignorehitpause = 0

[State 0, Explod]
type = Explod
trigger1 = animelem = 1
anim = 1003
ID = 1003
pos = 0,120
angle = -115
facing = -1
postype = p1
bindtime = 0
removetime = -2
sprpriority = 9
ownpal = 1
removeongethit = 0
ignorehitpause = 0

[State 10038, SE]
type = Null;PlaySnd
trigger1 = !time
value = S40,4

[State 三粒の天滴_R]
type = Varset
trigger1 = ((var(0)+124)*(1280/21))%1536 = [0,255]
trigger1 = fvar(37) := 256-((var(0)+124)*(1280/21))%256
trigger2 = ((var(0)+124)*(1280/21))%1536 = [256,767]
trigger2 = fvar(37) := 0
trigger3 = ((var(0)+124)*(1280/21))%1536 = [768,1023]
trigger3 = fvar(37) := ((var(0)+124)*(1280/21))%256
trigger4 = ((var(0)+124)*(1280/21))%1536 = [1024,1535]
trigger4 = fvar(37) := 256
fvar(37) = fvar(37)

[State 三粒の天滴_G]
type = Varset
trigger1 = ((var(0)+124)*(1280/21))%1536 = [0,512]
trigger1 = fvar(38) := 256
trigger2 = ((var(0)+124)*(1280/21))%1536 = [512,767]
trigger2 = fvar(38) := 256-((var(0)+124)*(1280/21))%256
trigger3 = ((var(0)+124)*(1280/21))%1536 = [768,1279]
trigger3 = fvar(38) := 0
trigger4 = ((var(0)+124)*(1280/21))%1536 = [1280,1535]
trigger4 = fvar(38) := ((var(0)+124)*(1280/21))%256
fvar(38) = fvar(38)

[State 三粒の天滴_B]
type = Varset
trigger1 = (((var(0)+124)*(1280/21))%1536 = [0,255]) + (((var(0)+124)*(1280/21))%1536 = [1280,1535])
trigger1 = fvar(39) := 0
trigger2 = ((var(0)+124)*(1280/21))%1536 = [256,511]
trigger2 = fvar(39) := ((var(0)+124)*(1280/21))%256
trigger3 = ((var(0)+124)*(1280/21))%1536 = [512,1023]
trigger3 = fvar(39) := 256
trigger4 = ((var(0)+124)*(1280/21))%1536 = [1024,1279]
trigger4 = fvar(39) := 256-((var(0)+124)*(1280/21))%256
fvar(39) = fvar(39)

[State 0, VarAdd]
type = VarAdd
trigger1 = 1
var(0) = 1

[State 三粒の天滴_PalFX]
type = PalFX
trigger1 = 1
time = 1
mul = 256+floor(fvar(37)),256+floor(fvar(38)),256+floor(fvar(39))
invertall = 0
color = 0
IgnoreHitPause = 1

[State 10361, HitDef]
type                = HitDef
triggerall = anim = 110005
trigger1            = HitDefAttr != A, HP
attr                = A, HP
hitflag             = MAFDP
guardflag           = HA
damage              = Ceil(180/(root,fvar(0)-root,fvar(1))),Ceil(20/(root,fvar(0)-root,fvar(1)))
animtype            = Back
ground.type         = High
priority            = ifelse(palno = 12,777,7), Hit
p1sprpriority = 8
pausetime           = 0, 14
guard.pausetime = 0, 28
;numhits = 20
sparkno             = -1
sparkxy             = -Random%20, -79+Random%10*Cond(Random%2,-1,1)
guard.sparkno       = -1;S10000
hitsound = s30, 2
guardsound = S10,0
ground.slidetime    = 17 + ((p2movetype=A)*7)
ground.hittime      = 17 + ((p2movetype=A)*7)
guard.slidetime     = 15
guard.hittime       = 15
air.hittime         = 17 + ((p2movetype=A)*7)
ground.velocity     = 0, 18
guard.velocity      = 0
air.velocity        = 0, 18
airguard.velocity   = 0, 18
fall                = 1
fall.recover = 0
getpower            = 192, 44
givepower           = 67, 20
id = id
nochainid = id
Ground.CornerPush.VelOff   = 0
Air.CornerPush.VelOff      = 0
Down.CornerPush.VelOff     = 0
Guard.CornerPush.VelOff    = 0
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, RootVarSet]
type = RootVarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, DelegateTarget]
type = DelegateTarget
trigger1 = NumTarget
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = animelemtime(12) >= 0;fvar(0) > 256
trigger2 = parent,movetype = H && parent,time > 0
removeexplods = parent,movetype = H && parent,time > 0

[statedef 1200]
Type = U
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 1200
value = 1200

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(6) = 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
fvar(10) = pos X + camerapos X

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y >= 0
statetype = S

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y < 0
statetype = A

[State 0, PosSet]
type = PosSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = 0.9

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = 12
y = 0

[State 0, Helper]
type = Helper
trigger1 = animelem = 6
helpertype = normal ;player
name = "ohwhat"
ID = 1201
stateno = 1201
pos = 59,-65
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0

[State 1520, 十字エフェ]
type = Explod
trigger1 = !time
anim = 13500
id = 13500
pos = 0,const(size.mid.pos.y)
postype = p1
vel = 0,0
ownpal = 1
facing = -1
removetime = -2
removeongethit = 0
bindtime = 0;9
sprpriority = 4
scale = .7,.7

[State 1520, 十字エフェ]
type = Explod
trigger1 = animelem = 6
anim = 10049
id = 10049
pos = 65,-64
postype = p1
ownpal = 1
angle = -90
removetime = -2
removeongethit = 0
bindtime = 0
sprpriority = 4
scale = 1,1

[State 0, VelSet]
type = VelSet
trigger1 = HitPauseTime
x = -6
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = AnimElemTime(6) <= 0
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1
dodge = 1
ignoreproj = -1
ignorehelper = -1

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = !time
value = S20,1

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = !time
value = S20,1

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = animelem = 6
value = S40,0

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = animelem = 6
value = S0,0

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = animelem = 6
value = S100,cond(random%3=0,53+random%3,57)
channel = 4

[State 0, PalFX]
type = PalFX
trigger1 = AnimElemTime(6) <= 0
time = 1
add = (128/15)*-AnimElemTime(6),(128/15)*-AnimElemTime(6),(128/15)*-AnimElemTime(6)
mul = 256,256,256
invertall = 0
color = 256

[State 220, 立ちC攻撃 - hitdef定義]
type = HitDef
triggerall = floor(var(0)/10000000)%10 < 2
trigger1 = !movecontact && !movereversed && !moveclash
trigger1 = StateType != A
attr = S, SA
Damage = Ceil(80/(fvar(0)-fvar(1))),5
animtype = hard
ground.type = low
guardflag = M
hitflag = MAFDP
priority = ifelse(palno = 12,777,7), Hit
pausetime = 10,15
guard.pausetime = 13,9
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-73
hitsound = s30, 2
guardsound = S10,0
ground.slidetime = 20
ground.hittime = 20
guard.ctrltime = 15
guard.velocity = -9
ground.velocity = -10,-7
air.velocity = -10,-7
down.velocity = -4,-2
airguard.velocity = -4,-3
getpower = 110,94
givepower = 55, 26
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
fall = 1
ID = 1200
yaccel = .48
fall.recover = 0
p2facing = 1
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 220, 立ちC攻撃 - hitdef定義]
type = HitDef
triggerall = floor(var(0)/10000000)%10 < 2
trigger1 = !movecontact && !movereversed && !moveclash
trigger1 = StateType = A
attr = A, SA
Damage = Ceil(80/(fvar(0)-fvar(1))),5
animtype = hard
ground.type = low
guardflag = HA
hitflag = MAFDP
priority = ifelse(palno = 12,777,7), Hit
pausetime = 10,15
guard.pausetime = 13,9
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-73
hitsound = s30, 2
guardsound = S10,0
ground.slidetime = 20
ground.hittime = 20
guard.ctrltime = 15
guard.velocity = -9
ground.velocity = -10,-7
air.velocity = -10,-7
down.velocity = -4,-2
airguard.velocity = -4,-3
getpower = 110,94
givepower = 55, 26
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
fall = 1
ID = 1200
yaccel = .48
fall.recover = 0
p2facing = 1
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarAdd]
type = VarAdd
triggerall = floor(var(0)/10000000)%10 < 2
trigger1 = MoveHitTrue = 1
var(0) = 10000000
ignorehitpause = 1
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AA,AP
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 7
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

[State 220, ヒット時揺れ]
type = EnvShake
trigger1 = movehit
time = 8
ampl = 3
freq = 110
persistent = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = (StateType = A)*50
ctrl = 1

[statedef 1205]
Type = U
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 1205
value = 1205

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = 0
y = 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(6) = 0

[State 0, Trans]
type = Trans
trigger1 = time >= 14 && time < 24
trans = addalpha
alpha = ifelse(time < 19,256-(256/5)*(time-13),(256/5)*(time-18)),ifelse(time >= 19,256-(256/5)*(time-18),(256/5)*(time-13))

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = time >= 14 && time < 24
text = "alpha = %d,%d"
params = ifelse(time < 19,256-(256/5)*(time-13),(256/5)*(time-18)),ifelse(time >= 19,256-(256/5)*(time-18),(256/5)*(time-13))

[State 0, Turn]
type = Turn
trigger1 = time = 19
trigger1 = facing != enemynear,facing
trigger2 = AnimElem = 9
trigger2 = p2dist X < 0

[State 0, PosSet]
type = PosSet
trigger1 = time >= 19 && animelemtime(9) < 0
x = enemynear,pos X - 50*facing
y = enemynear,pos Y

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y >= 0
statetype = S

[State 0, PosSet]
type = PosSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelSet]
type = Null;VelSet
trigger1 = time = 19
x = enemynear,vel X*facing*enemynear,facing
y = enemynear,vel Y

[State 0, ScreenBound]
type = ScreenBound
trigger1 = AnimElemTime(9) < 0
trigger2 = BackEdgeDist < 0
value = 0
movecamera = 1,1
ignorehitpause = 1

[State 0, VelSet]
type = Null;VelSet
trigger1 = !time
x = ((p2dist X-50)/-animelemtime(9))/0.35
y = 0

[State 1520, 十字エフェ]
type = Explod
trigger1 = !time
anim = 13500
id = 13500
pos = 0,const(size.mid.pos.y)
postype = p1
vel = 0,0
ownpal = 1
facing = cond(vel X < 0,1,-1)
removetime = -2
removeongethit = 0
bindtime = 5
sprpriority = 4
scale = .7,.7

[State 0, Helper]
type = Helper
triggerall = !numhelper(1201)
trigger1 = animelemtime(9) <= 0
trigger1 = time >= 19
helpertype = normal ;player
name = "ohwhat"
ID = 1201
stateno = 1201
pos = 59,-65
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0

[State 0, VelMul]
type = VelMul
trigger1 = animelemtime(9) >= 0
x = 0.9
y = 0.9

[State 0, VelSet]
type = VelSet
trigger1 = BackEdgeDist >= 0
trigger1 = MoveHit || MoveGuarded || MoveClash || MoveClashed
x = ifelse(hitpausetime > 0,-6,vel X)
persistent = 0
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 9
trigger1 = BackEdgeDist < 0
x = ((BackEdgeDist)/animelemtime(14))/0.36

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1;AnimElemTime(9) < 0
value = 0

[State 1520, 十字エフェ]
type = Explod
trigger1 = animelem = 9
anim = 10049
id = 10049
pos = 65,-64
postype = p1
ownpal = 1
angle = -90
removetime = -2
removeongethit = 0
bindtime = 1
sprpriority = 4
scale = 1,1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = time >= 14 && time < 20
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1
dodge = 1
ignoreproj = -1
ignorehelper = -1

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = !time
value = S20,1

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = !time
value = S30,17
pan = floor(p2dist X - 50)

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = animelem = 9
value = S40,0

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = animelem = 9
value = S0,0

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = !time
value = S100,cond(random%2,115+random%2,64+random%2)
channel = 4

[State 0, PalFX]
type = Null;PalFX
trigger1 = AnimElemTime(9) <= 0
time = 1
add = (128/24)*-AnimElemTime(9),(128/24)*-AnimElemTime(9),(128/24)*-AnimElemTime(9)
mul = 256,256,256
invertall = 0
color = 256

[State 220, 立ちC攻撃 - hitdef定義]
type = HitDef
trigger1 = !movecontact && !movereversed && !moveclash
trigger1 = StateType != A
attr = S, SA
Damage = Ceil(80/(fvar(0)-fvar(1))),5
animtype = hard
ground.type = low
guardflag = M
hitflag = MAFDP
priority = ifelse(palno = 12,777,7), Hit
pausetime = 10,15
guard.pausetime = 13,9
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-73
hitsound = s30, 2
guardsound = S10,0
ground.slidetime = 20
ground.hittime = 20
guard.ctrltime = 15
guard.velocity = -9
ground.velocity = -10,-7
air.velocity = -10,-7
down.velocity = -4,-2
airguard.velocity = -4,-3
getpower = 110,94
givepower = 55, 26
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
fall = 1
ID = 1205
yaccel = .48
fall.recover = 0
p2facing = 1
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 220, 立ちC攻撃 - hitdef定義]
type = HitDef
trigger1 = !movecontact && !movereversed && !moveclash
trigger1 = StateType = A
attr = A, SA
Damage = Ceil(80/(fvar(0)-fvar(1))),5
animtype = hard
ground.type = low
guardflag = MA
hitflag = MAFDP
priority = ifelse(palno = 12,777,7), Hit
pausetime = 10,15
guard.pausetime = 13,9
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-73
hitsound = s30, 2
guardsound = S10,0
ground.slidetime = 20
ground.hittime = 20
guard.ctrltime = 15
guard.velocity = -9
ground.velocity = -10,-7
air.velocity = -10,-7
down.velocity = -4,-2
airguard.velocity = -4,-3
getpower = 110,94
givepower = 55, 26
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
fall = 1
ID = 1205
yaccel = .48
fall.recover = 0
p2facing = 1
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarAdd]
type = VarAdd
triggerall = floor(var(0)/10000000)%10 < 2
trigger1 = MoveHitTrue = 1
var(0) = 10000000
ignorehitpause = 1
persistent = 0

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AA,AP
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 7
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

[State 220, ヒット時揺れ]
type = EnvShake
trigger1 = movehit
time = 8
ampl = 3
freq = 110
persistent = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = ifelse(pos Y < 0,50,0)
ctrl = 1

[statedef 1201]
Type = S
MoveType = I
Physics  = N
Ctrl = 0
SprPriority = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT
time = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 99999

[State 0, Turn]
type = Turn
trigger1 = facing != root,facing

[State 0, RootVarSet]
type = RootVarSet
triggerall = root,stateno = 1205 || root,stateno = 2200
trigger1 = anim != 1003
sysfvar(10) = (enemynear,pos X+camerapos X) - 50*facing

[State 0, RootVarSet]
type = RootVarSet
triggerall = root,stateno = 1205 || root,stateno = 2200
trigger1 = anim != 1003
sysfvar(11) = enemynear,pos Y

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Anim != 1003
trigger1 = Root,AnimElemTime(ifelse(Root,StateNo=1205,9,6)) >= 0
value = 1003

[State 0, AngleDraw]
type = AngleDraw
trigger1 = anim = 1003
value = -25
scale = 0.4+(var(1)*0.01),0.4+(var(1)*0.01)

[State 0, VarAdd]
type = VarAdd
trigger1 = anim = 1003
var(1) = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = Anim != 1003
flag = invisible

[State 0, DestroySelf]
type = DestroySelf
trigger1 = parent,stateno != [1200,1205]
trigger1 = parent,stateno != 2200
trigger1 = Anim != 1003
trigger2 = anim = 1003
trigger2 = !animtime

[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 1003 && animelem = 1
x = rootdist X + 59
y = rootdist Y - 65

[statedef 1202]
Type = S
MoveType = I
Physics  = N
Ctrl = 0
SprPriority = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT
time = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = invisible

[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
pos = 0,0

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = parent,stateno != [1200,1205]
trigger1 = parent,stateno != 2200

[statedef 1300]
Type = S
MoveType = I
Physics  = N
Ctrl = 0
SprPriority = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1300

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = time
movetype = A

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(6) = 0

[State 1300, ボイス]
type = PlaySnd
trigger1 = !time
value = S100,cond(random%2,5,147+(random%3))
channel = 4

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 0, Helper]
type = Helper
trigger1 = animelem = 3
name = "Celestial Spire"
ID = 13000
stateno = 13000
pos = 200,0
postype = p1
facing = -1
ownpal = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

[statedef 1310]
Type = S
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1310

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(6) = 0

[State 1300, ボイス]
type = PlaySnd
trigger1 = !time
value = S100,cond(random%2,5,147+(random%3))
channel = 4

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = const(movement.stand.friction)

[State 0, Helper]
type = Helper
trigger1 = animelem = 3
name = "Celestial Spire"
ID = 13000
stateno = 13000
pos = 100,0
postype = p1
ownpal = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

[statedef 13000]
Type = S
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 2
Anim = 10023

[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,stateno = 3700
recursive = 1
removeexplods = 1
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S40, 1

[State 1300, 岩エフェクト]
type = Null;Explod
trigger1 = !time
anim = 10024
id = 10024
pos = 0,0
postype = p1
ownpal = 1
sprpriority = 3

[State 1300, Aなみ - hitdef定義]
type = HitDef
triggerall = floor(root,var(0)/100000000)%10 < 2
trigger1 = !time
attr = S, SP
damage = Ceil(70/(root,fvar(0)-root,fvar(1))),Ceil(5/(root,fvar(0)-root,fvar(1)))
animtype = hard
ground.type = low
guardflag = M
hitflag = MAFDP
priority = ifelse(palno = 12,777,3), Hit
pausetime = 0,12
guard.pausetime = 0,12
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-50
hitsound = s5, 5
guardsound = S10,0
ground.slidetime = 17
ground.hittime = 17
guard.velocity = -6
ground.velocity = -6,-6
air.velocity = -6,-6
airguard.velocity = -4,-4
getpower = 30,12
givepower = 35, 29
ground.cornerpush.veloff = 0
fall = 1
fall.recover = 0
yaccel = .52
guard.kill = 0
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, RootVarAdd]
type = RootVarAdd
trigger1 = MoveHitTrue = 1
fvar(0) = .33
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = RootVarAdd
trigger1 = MoveHitTrue = 1
var(0) = 100000000
ignorehitpause = 1
persistent = 0

[State 0, RootVarSet]
type = RootVarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, DelegateTarget]
type = DelegateTarget
trigger1 = NumTarget
ignorehitpause = 1

[State 220, ヒット時揺れ]
type = EnvShake
trigger1 = movehit
time = 8
ampl = 3
freq = 110
persistent = 0
ignorehitpause = 1

[State 三粒の天滴_R]
type = Varset
trigger1 = ((time+124)*72)%1536 = [0,255]
trigger1 = fvar(37) := 256-((time+124)*72)%256
trigger2 = ((time+124)*72)%1536 = [256,767]
trigger2 = fvar(37) := 0
trigger3 = ((time+124)*72)%1536 = [768,1023]
trigger3 = fvar(37) := ((time+124)*72)%256
trigger4 = ((time+124)*72)%1536 = [1024,1535]
trigger4 = fvar(37) := 256
fvar(37) = fvar(37)

[State 三粒の天滴_G]
type = Varset
trigger1 = ((time+124)*72)%1536 = [0,512]
trigger1 = fvar(38) := 256
trigger2 = ((time+124)*72)%1536 = [512,767]
trigger2 = fvar(38) := 256-((time+124)*72)%256
trigger3 = ((time+124)*72)%1536 = [768,1279]
trigger3 = fvar(38) := 0
trigger4 = ((time+124)*72)%1536 = [1280,1535]
trigger4 = fvar(38) := ((time+124)*72)%256
fvar(38) = fvar(38)

[State 三粒の天滴_B]
type = Varset
trigger1 = (((time+124)*72)%1536 = [0,255]) + (((time+124)*72)%1536 = [1280,1535])
trigger1 = fvar(39) := 0
trigger2 = ((time+124)*72)%1536 = [256,511]
trigger2 = fvar(39) := ((time+124)*72)%256
trigger3 = ((time+124)*72)%1536 = [512,1023]
trigger3 = fvar(39) := 256
trigger4 = ((time+124)*72)%1536 = [1024,1279]
trigger4 = fvar(39) := 256-((time+124)*72)%256
fvar(39) = fvar(39)

[State 三粒の天滴_PalFX]
type = PalFX
trigger1 = 1
time = 1
mul = 256+floor(fvar(37)),256+floor(fvar(38)),256+floor(fvar(39))
invertall = 0
color = 0
IgnoreHitPause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime

[statedef 2000]
Type = U
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 2

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 2000

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(6) = 0

[State 0, PowerAdd]
type = PowerAdd
triggerall = !var(12)
triggerall = fighting
trigger1 = !time
value = -1000

[State 0, VarAdd]
type = VarAdd
trigger1 = !time
var(21) = ifelse(var(12) > 5999,-500,-1000)

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y >= 0
statetype = S

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y < 0
statetype = A

[State 0, PosSet]
type = PosSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = cond(Pos Y < 0,0.9,const(movement.stand.friction))
y = 0.9

[State 1520, ボイス 1]
type = PlaySnd
trigger1 = !time
value = S100, 219+random%3
channel = 4

[State 1520, 十字エフェ]
type = Explod
trigger1 = !time
anim = 10220
id = 10220
pos = -5,-80
postype = p1
ownpal = 1
removeongethit = 0
bindtime = -1
sprpriority = 4
scale = 0.53,0.53

[State 1520, 超必時背景ヘルパー呼び出し (1P)]
type = Helper
trigger1 = !time
id = 10210
stateno = 10210
postype = p1
pos = 0,-195
supermovetime = 99
pausemovetime = 99
size.xscale = 0.50
size.yscale = 0.50
ignorehitpause = 1
persistent = 0

[State 0, Helper]
type = Helper
trigger1 = animelemtime(7) = -10
helpertype = normal ;player
name = "eh"
ID = 1007
stateno = 1003
pos = 40,-80+(random%40*cond(random%2,-1,1))
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0

[State 0, Helper]
type = Helper
trigger1 = animelemtime(7) >= -2
trigger1 = (animelemtime(7)+2)%8 = 0
trigger1 = animelemtime(25) < -14
helpertype = normal ;player
name = "eh"
ID = 1007
stateno = 1003
pos = 40+(random%40*cond(random%2,-1,1)),-80+(random%40*cond(random%2,-1,1))
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = 0+(StateType = A)*50
ctrl = 1

[statedef 2200]
Type = U
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 2200

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(6) = 0

[State 0, PowerAdd]
type = PowerAdd
triggerall = !var(12)
triggerall = fighting
trigger1 = !time
value = -3000

[State 0, VarAdd]
type = VarAdd
trigger1 = !time
var(21) = ifelse(var(12) > 5999,-1500,-3000)

[State 0, Trans]
type = Trans
trigger1 = time >= 5 && time < 15
trans = addalpha
alpha = ifelse(time < 10,256-(256/5)*(time-4),(256/5)*(time-9)),ifelse(time >= 10,256-(256/5)*(time-9),(256/5)*(time-4))

[State 0, Turn]
type = Turn
trigger1 = time = 10
trigger1 = facing != enemynear,facing
trigger2 = AnimElem = 6
trigger2 = p2dist X < 0

[State 0, PosSet]
type = PosSet
trigger1 = time >= 10 && animelemtime(6) < 0
x = enemynear,pos X - 50*facing
y = enemynear,pos Y

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y >= 0
statetype = S

[State 0, PosSet]
type = PosSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = AnimElemTime(6) < 0
trigger2 = BackEdgeDist < 0
value = 0
movecamera = 1,1
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = 0
y = 0

[State 1520, 十字エフェ]
type = Explod
trigger1 = !time
anim = 13500
id = 13500
pos = 0,const(size.mid.pos.y)
postype = p1
vel = 0,0
ownpal = 1
facing = cond(vel X < 0,1,-1)
removetime = -2
removeongethit = 0
bindtime = 3
sprpriority = 4
scale = .7,.7

[State 1520, 十字エフェ]
type = Explod
trigger1 = !time
anim = 10220
id = 10220
pos = -5,-64
postype = p1
ownpal = 1
removeongethit = 0
bindtime = -1
sprpriority = 4
scale = 0.53,0.53

[State 1520, 超必時背景ヘルパー呼び出し (1P)]
type = Helper
trigger1 = !time
id = 10211
stateno = 10211
postype = p1
pos = 0,-195
supermovetime = 99
pausemovetime = 99
size.xscale = 0.50
size.yscale = 0.50
ignorehitpause = 1
persistent = 0

[State 0, Helper]
type = Helper
trigger1 = animelem = 6
helpertype = normal ;player
name = "ohwhat"
ID = 1201
stateno = 1201
pos = 59,-65
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0

[State 1520, 十字エフェ]
type = Explod
trigger1 = animelem = 6
anim = 10050
id = 10050
pos = 99,-59
postype = p1
ownpal = 1
angle = -90
removetime = -2
removeongethit = 0
bindtime = 1
sprpriority = 4
scale = 1,1

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = 0.9

[State 0, VelSet]
type = VelSet
trigger1 = BackEdgeDist >= 0
trigger1 = MoveHit = 1 || MoveGuarded = 1
x = -12
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 6
trigger1 = BackEdgeDist < 0
x = ((BackEdgeDist)/animelemtime(11))/0.5

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1;AnimElemTime(9) < 0
value = 0

[State 0, Helper]
type = Helper
trigger1 = !numhelper(1203)
trigger1 = animelemtime(6) >= 0
helpertype = normal ;player
name = "ohwhat"
ID = 1203
stateno = 1202
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1
dodge = 1
ignoreproj = -1
ignorehelper = -1

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = !time
value = S20,2

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = animelem = 6
value = S40,0

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = animelem = 6
value = S0,0

[State 220, 立ちC素振り音]
type = PlaySnd
trigger1 = animelem = 6
value = S100,cond(random%3=0,53+random%3,57)
channel = 4

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(10) = 0

[State 0, VarAdd]
type = VarAdd
trigger1 = 1
var(10) = 1
ignorehitpause = 1

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 1
add = 128*(var(10)%2),128*(var(10)%2),128*(var(10)%2)
mul = 256,256,256
invertall = 0
color = 256
ignorehitpause = 1

[State 220, 立ちC攻撃 - hitdef定義]
type = HitDef
trigger1 = !movecontact && !movereversed && !moveclash
trigger1 = StateType != A
attr = S, HA
damage = Ceil(240/(fvar(0)-fvar(1))),Ceil(30/(fvar(0)-fvar(1)))
animtype = hard
ground.type = low
guardflag = M
hitflag = MAFDP
priority = ifelse(palno = 12,777,7), Hit
pausetime = 10,15
guard.pausetime = 13,13
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-73
hitsound = s30, 2
guardsound = S10,0
ground.slidetime = 20
ground.hittime = 20
guard.ctrltime = 15
guard.velocity = -9
ground.velocity = -10,-7
air.velocity = -10,-7
down.velocity = -4,-2
airguard.velocity = -4,-3
getpower = 0,0
givepower = 55, 26
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
fall = 1
ID = 2200
yaccel = .48
fall.recover = 0
p2facing = 1
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 220, 立ちC攻撃 - hitdef定義]
type = HitDef
trigger1 = !movecontact && !movereversed && !moveclash
trigger1 = StateType = A
attr = A, HA
damage = Ceil(240/(fvar(0)-fvar(1))),Ceil(30/(fvar(0)-fvar(1)))
animtype = hard
ground.type = low
guardflag = MA
hitflag = MAFDP
priority = ifelse(palno = 12,777,7), Hit
pausetime = 10,15
guard.pausetime = 13,13
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-73
hitsound = s30, 2
guardsound = S10,0
ground.slidetime = 20
ground.hittime = 20
guard.ctrltime = 15
guard.velocity = -9
ground.velocity = -10,-7
air.velocity = -10,-7
down.velocity = -4,-2
airguard.velocity = -4,-3
getpower = 0,0
givepower = 55, 26
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
fall = 1
ID = 2200
yaccel = .48
fall.recover = 0
p2facing = 1
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, VarSet]
type = VarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = (!MoveClash && !MoveClashed) || hitpausetime
attr = ,AA,AP
slot = 1
time = 1
forceair = 0
hitsound = S901,random%2
sparkno = S12030
pausetime = 0,0
ignorehitpause = 1
clashpriority = 7
nothitstate = 1
hotype = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = (MoveClash || MoveClashed) && HitPauseTime
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

[State 220, ヒット時揺れ]
type = EnvShake
trigger1 = movehit
time = 8
ampl = 9
freq = 110
persistent = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = ifelse(pos Y < 0,50,0)
ctrl = 1

[statedef 2300]
Type = U
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 2300

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(6) = 0

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = 0
y = 0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y >= 0
statetype = S

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Vel Y + Pos Y < 0
statetype = A

[State 0, PosSet]
type = PosSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = Vel Y + Pos Y >= 0
y = 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = ifelse(Pos Y < 0,0.9,const(movement.stand.friction))
y = 0.9

[State 0, PowerAdd]
type = PowerAdd
triggerall = !var(12)
triggerall = fighting
trigger1 = !time
value = -2000

[State 0, VarAdd]
type = VarAdd
trigger1 = !time
var(21) = ifelse(var(12) > 5999,-1000,-2000)

[State 1220, ボイス 1]
type = PlaySnd
trigger1 = !time
value = S100, 203+random%5
channel = 4

[State 1520, 十字エフェ]
type = Explod
trigger1 = !time
anim = 10220
id = 10220
pos = -5,-80
postype = p1
ownpal = 1
removeongethit = 0
bindtime = -1
sprpriority = 4
scale = 0.53,0.53

[State 1520, 超必時背景ヘルパー呼び出し (1P)]
type = Helper
trigger1 = !time
id = 10210
stateno = 10210
postype = p1
pos = 0,-195
supermovetime = 99
pausemovetime = 99
size.xscale = 0.50
size.yscale = 0.50
ignorehitpause = 1
persistent = 0

[State 0, Helper]
type = Helper
trigger1 = animelem = 7
name = "Celestial Spire"
ID = 23000
stateno = 23000
pos = 0,-pos Y
postype = p1
facing = -1
ownpal = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !AnimTime
value = ifelse(statetype = A,50,0)
ctrl = 1

[statedef 23000]
Type = S
MoveType = A
Physics  = N
Ctrl = 0
SprPriority = 7
Anim = 1209

[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,stateno = 3700
recursive = 1
removeexplods = 1
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = !time
x = enemynear,pos X

[State 0, SprPriority]
type = SprPriority
trigger1 = 1
value = 7

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = 1,cond(topedge < -360,-topedge/360.0,1)

[State 10034, 影なし]
type = AssertSpecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 10034, SE]
type = PlaySnd
trigger1 = !time
value = S40, 4
volumescale = 160
persistent = 0

[State 1300, Aなみ - hitdef定義]
type = HitDef
triggerall = animelemtime(40) < 0
trigger1 = AnimElemTime(3) >= 0
trigger1 = AnimElemTime(3)%6 = 0
attr = S, HP
damage = Ceil(40/(root,fvar(0)-root,fvar(1))),Ceil(15/(root,fvar(0)-root,fvar(1)))
animtype = hard
ground.type = low
air.type = high
guardflag = MA
hitflag = MAFDP
priority = ifelse(palno = 12,777,3), Hit
pausetime = 0,3
guard.pausetime = 0,8
sparkno = -1
guard.sparkno = S10000
sparkxy = -5,-50
p1sprpriority = 7
hitsound = -1;s30, 2
guardsound = S10,0
ground.slidetime = 17
ground.hittime = 17
guard.velocity = 0
ground.velocity = 0,-5.7
air.velocity = 0,-5.7
airguard.velocity = 0,-4
getpower = 30,12
givepower = 35, 29
ground.cornerpush.veloff = 0
fall = 1
fall.recover = 0
yaccel = .52
guard.kill = 0
abshit = enemynear,authorname = "nns" && enemynear,movetype = H

[State 0, RootVarSet]
type = RootVarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, DelegateTarget]
type = DelegateTarget
trigger1 = NumTarget
ignorehitpause = 1

[State 0, HitDefClear]
type = HitDefClear
trigger1 = animelem = 40

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = 1
movetype = A

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = enemy,name = "ARCHETYPE:ALCERIS" && enemy,stateno = 900 && enemy,var(0)
movetype = I

[State 220, ヒット時揺れ]
type = Null;EnvShake
trigger1 = movehittrue = 1
time = 8
ampl = 3
freq = 110
ignorehitpause = 1

[State 三粒の天滴_R]
type = Varset
trigger1 = ((time+124)*72)%1536 = [0,255]
trigger1 = fvar(37) := 256-((time+124)*72)%256
trigger2 = ((time+124)*72)%1536 = [256,767]
trigger2 = fvar(37) := 0
trigger3 = ((time+124)*72)%1536 = [768,1023]
trigger3 = fvar(37) := ((time+124)*72)%256
trigger4 = ((time+124)*72)%1536 = [1024,1535]
trigger4 = fvar(37) := 256
fvar(37) = fvar(37)

[State 三粒の天滴_G]
type = Varset
trigger1 = ((time+124)*72)%1536 = [0,512]
trigger1 = fvar(38) := 256
trigger2 = ((time+124)*72)%1536 = [512,767]
trigger2 = fvar(38) := 256-((time+124)*72)%256
trigger3 = ((time+124)*72)%1536 = [768,1279]
trigger3 = fvar(38) := 0
trigger4 = ((time+124)*72)%1536 = [1280,1535]
trigger4 = fvar(38) := ((time+124)*72)%256
fvar(38) = fvar(38)

[State 三粒の天滴_B]
type = Varset
trigger1 = (((time+124)*72)%1536 = [0,255]) + (((time+124)*72)%1536 = [1280,1535])
trigger1 = fvar(39) := 0
trigger2 = ((time+124)*72)%1536 = [256,511]
trigger2 = fvar(39) := ((time+124)*72)%256
trigger3 = ((time+124)*72)%1536 = [512,1023]
trigger3 = fvar(39) := 256
trigger4 = ((time+124)*72)%1536 = [1024,1279]
trigger4 = fvar(39) := 256-((time+124)*72)%256
fvar(39) = fvar(39)

[State 三粒の天滴_PalFX]
type = PalFX
trigger1 = 1
time = 1
mul = 256+floor(fvar(37)),256+floor(fvar(38)),256+floor(fvar(39))
invertall = 0
color = 0
IgnoreHitPause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime

[Statedef 3000]
Type = S
MoveType = A
Physics = N
Ctrl = 0
velset = 0,0
SprPriority = 2

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 3000

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

[State 0, PowerAdd]
type = PowerAdd
triggerall = !var(12)
triggerall = fighting
trigger1 = !time
value = -6000

[State 0, VarAdd]
type = VarSet
trigger1 = !time
var(21) = 0

[State 1220, ボイス 1]
type = Null;PlaySnd
trigger1 = !time
value = S100, 203+random%5
channel = 4

[State 1520, 十字エフェ]
type = Explod
trigger1 = !time
anim = 10220
id = 10220
pos = -5,-80
postype = p1
ownpal = 1
removeongethit = 0
supermovetime = -1
pausemovetime = -1
bindtime = -1
sprpriority = 4
scale = 0.53,0.53

[State 1520, 超必時背景ヘルパー呼び出し (1P)]
type = Helper
trigger1 = !time
id = 10211
stateno = 10211
postype = p1
pos = 0,-195
supermovetime = -1
pausemovetime = -1
size.xscale = 0.50
size.yscale = 0.50

[State 0, ChangeAnim]
type = Null;ChangeAnim
triggerall = numhelper(3001)
triggerall = animelemtime(6) >= 0
trigger1 = anim = 3000
value = 3000
elem = 6

[State 0, SuperPause]
type = SuperPause
trigger1 = animelemtime(5) < 0
time = 1
anim = -1
sound = -1
movetime = 1
darken = 0
p2defmul = 1
unhittable = 1
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S3000,0
volumescale = 200

[State 0, EnvShake]
type = EnvShake
trigger1 = !time
time = -animelemtime(5)
freq = 60
ampl = -12
phase = 90

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelemtime(4) = 10 
value = S100,170
channel = 4

[State 0, Helper]
type = Helper
trigger1 = !time
name = "Celestial Judgement Bomb"
ID = 3001
stateno = 3001
pos = 22,-277
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = -animelemtime(5)
pausemovetime = -animelemtime(5)

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = ifelse(pos Y < 0,50,0)
ctrl = 1

[Statedef 3050]
Type = S
MoveType = A
Physics = N
Ctrl = 0
velset = 0,0
SprPriority = 2

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 3050

[State 0, Turn]
type = Turn
triggerall = !time
trigger1 = p2dist X < 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

[State 0, PowerAdd]
type = PowerSet
triggerall = !var(12)
triggerall = fighting
trigger1 = !time
value = 0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 1,1

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 5
x = -116
y = -243

[State 0, Trans]
type = Trans
trigger1 = time >= 187 && time < 197
trans = addalpha
alpha = ifelse(time < 192,256-(256/5)*(time-186),(256/5)*(time-191)),ifelse(time >= 192,256-(256/5)*(time-191),(256/5)*(time-186))

[State 0, VarAdd]
type = VarSet
trigger1 = !time
var(21) = 0

[State 1220, ボイス 1]
type = Null;PlaySnd
trigger1 = !time
value = S100, 203+random%5
channel = 4

[State 1520, 十字エフェ]
type = Explod
trigger1 = !time
anim = 10220
id = 10220
pos = -5,-80
postype = p1
ownpal = 1
removeongethit = 0
supermovetime = -1
pausemovetime = -1
bindtime = -1
sprpriority = 4
scale = 0.53,0.53

[State 1520, 超必時背景ヘルパー呼び出し (1P)]
type = Helper
trigger1 = !time
id = 10211
stateno = 10211
postype = p1
pos = 0,-195
supermovetime = -1
pausemovetime = -1
size.xscale = 0.50
size.yscale = 0.50

[State 0, ChangeAnim]
type = Null;ChangeAnim
triggerall = numhelper(3001)
triggerall = animelemtime(6) >= 0
trigger1 = anim = 3000
value = 3000
elem = 6

[State 0, SuperPause]
type = SuperPause
trigger1 = animelemtime(6) < 0
time = 1
anim = -1
sound = -1
movetime = 1
darken = 0
p2defmul = 1
unhittable = 1
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelemtime(5) = 5
value = S100,170
channel = 4

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S3000,0
volumescale = 200

[State 0, EnvShake]
type = EnvShake
trigger1 = !time
time = -animelemtime(6)
freq = 60
ampl = -12
phase = 90

[State 0, Helper]
type = Helper
trigger1 = !time
name = "Celestial Judgement Bomb"
ID = 3051
stateno = 3001
pos = 22,-277
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = -animelemtime(6)
pausemovetime = -animelemtime(6)

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 50
ctrl = 1

[Statedef 3001]
Type = S
MoveType = A
Physics = N
Ctrl = 0
SprPriority = 777

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 3001

[State 0, ScreenBound]
type = ScreenBound
trigger1 = time < 213
value = 0
movecamera = 1,1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = var(1) = 30
trigger2 = pos Y >= 0
value = 1004

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, PosFreeze]
type = PosFreeze
trigger1 = Anim = 1004
value = 1
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = Anim = 1004
movetype = I
ignorehitpause = 1

[State 10361, 変数] ;相殺強度
type     = Varadd
Trigger1 = anim = 1004
var(0)   = 1
ignorehitpause = 1

[state 11201, 透過]
type     = Trans
trigger1 = 1
trans    = add
alpha    = 256-(16*var(0)), 256
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = ifelse(anim = 3001,random*.36,0)
scale = ifelse(time < 160,(time+1)/160.0,1.0+(var(0)*0.1)),ifelse(time < 160,(time+1)/160.0,1.0+(var(0)*0.1))
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 213
value = S40,4
volumescale = 200

[State 0, PlaySnd]
type = PlaySnd
trigger1 = var(0) = 1
value = S40,6
volumescale = 200

[State -2]
Type = Helper
trigger1 = var(0) = 1
StateNo = 1003
ID = 3002
PosType = P1
Pos = 0,0
Ownpal = 1
ignorehitpause = 1

[State 0, HitDef]
type = HitDef
triggerall = time >= 213
triggerall = hitpausetime < 2
trigger1 = var(1) < 30
attr = SCA,HP
hitflag = MAFDP
guardflag = MA
animtype = back
priority = 777,Hit
damage = ceil(ifelse(ishelper(3051),23,12)/(root,fvar(0)-root,fvar(1))),Ceil(5/(root,fvar(0)-root,fvar(1)))
pausetime = 2,5
helperpausetime = 0,1
sparkno = -1
guard.sparkno = -1
sparkxy = 0,0
hitsound = -1
guardsound = -1
ground.type = High
ground.hittime = 20
ground.slidetime = 20
air.hittime = 20
guard.hittime = 20
guard.ctrltime = 20
airguard.hittime = 20
airguard.ctrltime = 20
guard.velocity = -20
ground.velocity = -3,-7
air.velocity = -3,-7
airguard.velocity = -9,-7
p1sprpriority = 777
p2facing = 1
fall = 1
fall.recover = 0
id = 3000
kill = 1
guard.kill = 1
numhits = 1
getpower = 0,0
givepower = 13,2
abshit = enemynear,authorname = "nns" && enemynear,movetype = H
ignorehitpause = 1

[State 0, RootVarSet]
type = RootVarSet
trigger1 = MoveHit || MoveGuarded
var(1) = 1
ignorehitpause = 1

[State 0, DelegateTarget]
type = DelegateTarget
trigger1 = NumTarget
ignorehitpause = 1

[State -1]
Type     = VarSet
Trigger1 = time = 213
fvar(4) = Pi*(facing = -1)

[State 0, VarSet]
type = VarSet
triggerall = anim = 3001
trigger1 = time >= 213
fvar(0) = pos X+7*Cos(fvar(4))

[State 0, VarSet]
type = VarSet
triggerall = anim = 3001
trigger1 = time >= 213
fvar(1) = pos Y-7*Sin(fvar(4))

[State -1]
Type = VarSet
triggerall = anim = 3001
trigger1 = time >= 213
fvar(2) = EnemyNear,Pos Y-EnemyNear,spritecenter.y

[State 0, VarSet]
type = VarSet
triggerall = anim = 3001
trigger1 = time >= 213
fvar(3) = ((enemynear,pos X-pos X)*(fvar(1)-pos Y))-(fvar(2) - pos Y)*(fvar(0)-pos X)

[State 0, VarSet]
type = VarSet
triggerall = anim = 3001
trigger1 = time >= 213
fvar(5) = ATan((enemynear,pos X-pos X)/(fvar(2)-pos Y))-((.5*Pi)*IfElse(((fvar(2)-pos Y)<0),-1,1))
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
triggerall = ishelper(3051)
triggerall = anim = 3001
trigger1 = time >= 213
var(2) = ifelse(abs(fvar(5) - fvar(4)) <= 14*(Pi/180.0),1,0)

[State 0, VarSet]
type = VarSet
trigger1 = var(2)
fvar(4) = fvar(5)

[State 0, VarAdd]
type = VarAdd
triggerall = !var(2)
triggerall = roundstate = 2
triggerall = ishelper(3051)
triggerall = anim = 3001
trigger1 = time >= 213
fvar(4) = ifelse(fvar(3) < 0,-7,7)*(Pi/180.0)

[State 0, VarAdd]
type = VarAdd
trigger1 = fvar(4) > Pi
fvar(4) = -2*Pi

[State 0, VarAdd]
type = VarAdd
trigger1 = fvar(4) < -Pi
fvar(4) = 2*Pi

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "fvar(5) = %f  fvar(4) = %f"
params = fvar(5),fvar(4)
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
triggerall = anim = 3001
triggerall = !ishelper(3051)
trigger1 = time >= 213
x = 6*Sin(45*(Pi/180.0))
y = 6*Sin(45*(Pi/180.0))
ignorehitpause = 1

[State -1]
Type     = VelSet
triggerall = !var(0)
triggerall = ishelper(3051)
triggerall = anim = 3001
trigger1 = time >= 213
X        = 6*Cos(FVar(4))*facing
Y        = -6*Sin(FVar(4))

[State -1]
Type     = VelSet
triggerall = hitpausetime && !var(0)
triggerall = anim = 3001
trigger1 = time >= 213
X        = 6*Cos(FVar(5))*facing
Y        = -6*Sin(FVar(5))
ignorehitpause = 1

[State 0, Offset]
type = Offset
trigger1 = hitpausetime
x = vel X * facing
y = vel Y
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = time >= 213 && !numexplod(3002)
anim = 3002
ID = 3002
pos = 120*Cos(-atan((vel y) / (vel x))),-120*Sin(-atan((vel y) / (vel x)))
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = -1
removetime = -1
pausemovetime = 0
scale = 3,3
angle = (-180/pi * atan((vel y) / (vel x)))-90
sprpriority = 778
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = MoveHitTrue = 1 || MoveGuardedTrue = 1
anim = 1005
ID = 1005
pos = 120*Cos(fvar(5))*facing,-120*Sin(fvar(5))
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 0
removetime = -2
pausemovetime = 0
scale = .3,2
angle = fvar(5)*(180/Pi)*facing
sprpriority = 7779
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 0
ignorehitpause = 1

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHitTrue = 1 || MoveGuardedTrue = 1
var(1) = 1
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = anim = 1004
id = 3002

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = numexplod(3002)
ID = 3002
pos = 120*Cos(-atan((vel y) / (vel x)))*ifelse(vel X < 0,-1,1),-120*Sin(-atan((vel y) / (vel x)))*ifelse(vel X < 0,-1,1)
angle = (-180/pi * atan((vel y) / (vel x)))+ifelse(vel X < 0,90,-90)
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
Trigger1 = Anim = 1004
Trigger1 = var(0) = 16

[Statedef 3400]
Type = S
MoveType = A
Physics = N
Ctrl = 0
velset = 0,0
SprPriority = 777

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT
time = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 3400
value = 3400
elem = 1

[State 0, Turn]
type = Turn
trigger1 = p2dist X < 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S100,70+random%2
channel = 4

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(12) = 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(21) = 0

[State 0, PowerSet]
type = PowerSet
trigger1 = !time
value = 0

[State 3400,Hit]
Type=HitDef
Trigger1 = clsn1
Attr=
AnimType=hard
Air.AnimType=hard
Hitflag=MAFDP
Guardflag=
SparkNo=-1
Guard.SparkNo=-1
HitSound=-1
GuardSound=-1
Damage=0
NumHits = 0
GetPower=0,0
GivePower=-9999999,0
PauseTime=0,0
P1SprPriority = 777
Priority = 7777777,Hit
Ground.velocity=0,0
Guard.velocity=0
Air.velocity=0,0
AirGuard.velocity=0,0
Ground.cornerpush.veloff = 0
Guard.cornerpush.veloff = 0
Air.cornerpush.veloff = 0
AirGuard.cornerpush.veloff = 0
Guard.Dist = 0
ID=3400
P1StateNo = 3401
P2StateNo = 3410
P2Facing = 1
snap = 50,-85
yaccel = .52
IgnoreHitPause=1
AbsHit = 2
NoBox = (abs(p2bodydist X)-15 <= 50 && p2dist Y >= -85)
NoHelper = 1
NoMinus = 1

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

[Statedef 3401]
Type = S
MoveType = A
Physics = N
Ctrl = 0
velset = 0,0
SprPriority = 3

[State 0, StopSnd]
type = StopSnd
trigger1 = time < 12
channel = -2

[State 0, AllPalFX]
type = AllPalFX
trigger1 = 1
time = -1
add = 0,0,0
mul = 256,256,256
sinadd = 0,0,0,0
invertall = 0
color = 256

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 1
time = -1
add = 0,0,0
mul = 256,256,256
sinadd = 0,0,0,0
invertall = 0
color = 256

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time

[State 0, EnvShake]
type = EnvShake
trigger1 = 1
time = 0
freq = 0
ampl = 0
phase = 0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = time < 101
value = 0
movecamera = 0,0

[State 0, Turn]
type = Null;Turn
trigger1 = facing != 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 3401

[State 0, VarSet]
type = VarSet
trigger1 = 1
sysvar(46) = 1
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = 1
sysvar(47) = 1
ignorehitpause = 1

[State 4800, 影消去]
type = AssertSpecial
trigger1 = 1
flag = globalnoshadow
flag2 = nofg
flag3 = nobg
ignorehitpause = 1

[State 4800, 影消去]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = timerfreeze
flag3 = nobardisplay
ignorehitpause = 1

[State 4800, 影消去]
type = AssertSpecial
trigger1 = 1
flag = noko
ignorehitpause = 1

[State 0, EnvColor]
type = EnvColor
trigger1 = time < 12
value = 255,255,255
time = 1
under = 0

[State 1520, 十字エフェ]
type = Explod
trigger1 = time = 12
anim = 10220
id = 10220
pos = -5,-64
postype = p1
ownpal = 1
removeongethit = 0
bindtime = -1
sprpriority = 4
scale = 0.75,0.75

[State 1520, 十字エフェ]
type = Explod
trigger1 = time = 12
anim = 10213
id = 10213
pos = 0,0
postype = back
ownpal = 1
removeongethit = 0
bindtime = -1
sprpriority = -99
scale = 240.0/490.0,240.0/490.0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 12
value = S30,3

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 60
value = S100,95
channel = 4

[State 4800, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT
ignorehitpause = 1

[State 4800, ノープッシュ]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 3700,Hit]
Type=HitDef
Trigger1=time < 141
Attr=
AnimType=hard
Air.AnimType=hard
Hitflag=MAFDP
Guardflag=
SparkNo=-1
Guard.SparkNo=-1
HitSound=-1
GuardSound=-1
Damage=0
NumHits = 0
GetPower=0,0
GivePower=-9999999,0
PauseTime=0,0
Ground.SlideTime=28
Guard.SlideTime=0
Ground.HitTime=26
Guard.HitTime=0
Guard.CtrlTime=24
P1SprPriority = 3
Priority = 7777777,Hit
Air.HitTime=24
Ground.velocity=0,0
Guard.velocity=0
Air.velocity=0,0
AirGuard.velocity=0,0
Ground.cornerpush.veloff = 0
Guard.cornerpush.veloff = 0
Air.cornerpush.veloff = 0
AirGuard.cornerpush.veloff = 0
ID=3400
P2Facing = 1
P2StateNo = 3410
snap = 50,-85
yaccel = .52
IgnoreHitPause=1
AbsHit = 2
NoBox = 1
NoMinus = 1

[State 0, HitDefClear]
type = HitDefClear
trigger1 = time = 141

[State 0, PosSet]
type = PosSet
trigger1 = time < 141
x = -50*facing
y = (gameheight/2.0)-(groundlevel/camerazoom)+85+camerapos Y

[State 0, PosSet]
type = PosSet
trigger1 = time = 141
y = 0

[State 0, TargetBind]
type = TargetBind
trigger1 = time <= 141
time = 1
id = 3400
pos = abs(pos X),-85
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 28
anim = 4702
ID = 3400
pos = 0,0
postype = p1
bindtime = -1
removetime = -1
pausemovetime = -1
supermovetime = -1
sprpriority = 4
ontop = 0
ownpal = 0
removeongethit = 0

[State 0, Explod]
type = Explod
trigger1 = time = 141
anim = 3403
ID = 3403
pos = 60,-85
postype = p1  ;p2,front,back,left,right
bindtime = 0
angle = -90
removetime = -1
pausemovetime = -1
supermovetime = -1
scale = 1,1
sprpriority = 10
shadow = 0,0,0
ownpal = 1
removeongethit = 0

[State 0, VarSet]
type = VarSet
trigger1 = time = 152
var(10) = 10

[State 0, VarAdd]
type = VarAdd
trigger1 = var(10) > 0
var(10) = -1

[State 0, RemoveExplod]
type = RemoveExplod
triggerall = numexplod(3403)
triggerall = time > 152
trigger1 = var(10) = 0
id = 3403

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 182
value = 3402

[State 0, RemoveExplod]
type = RemoveExplod
triggerall = numexplod(3400)
trigger1 = anim = 3402
id = 3400

[State 0, ModifyExplod]
type = ModifyExplod
triggerall = numexplod(3403)
trigger1 = time >= 152
ID = 3403
bindtime = 1
scale = (var(10)/10.0),1

[State 10034, SE]
type = PlaySnd
trigger1 = time = 141
value = S40, 4
volumescale = 160

[State 0, TargetVarSet]
type = TargetVarSet
trigger1 = time >= 141
sysvar(56) = 4
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
triggerall = !animtime
trigger1 = anim = 3402
value = 0
ctrl = 1

[Statedef 3410]
Type = S
MoveType = I
Physics = N
Ctrl = 0
SprPriority = 1
NoMinus = 1

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 0
add = 0,0,0
mul = 256,256,256
invertall = 0
color = 256
ignorehitpause = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1

[State 0, StopSnd]
type = StopSnd
trigger1 = alive
channel = -1
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = ishelper
recursive = 1
removeexplods = 1
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = 1
ignorehitpause = 1

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = 1
value = 3410
elem = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = !alive
y = -const(size.head.pos.y)

[State 0, VelSet]
type = VelSet
trigger1 = !alive
x = -7
y = -7

[State 0, SelfState]
type = SelfState
trigger1 = !alive
value = 5050
ctrl = 0

[Statedef 3700]
Type = S
MoveType = A
Physics = N
Ctrl = 0
velset = 0,0
SprPriority = 777

[State 0, Zoom]
type = Zoom
trigger1 = 1
pos = 0,-camerapos Y
scale = 1

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(12) = 0

[State 0, VarSet]
type = VarSet
trigger1 = !time
var(21) = 0

[State 0, PowerSet]
type = PowerSet
trigger1 = !time
value = 0

[State 0, StopSnd]
type = StopSnd
trigger1 = time < 12
channel = -2

[State 0, AllPalFX]
type = AllPalFX
trigger1 = 1
time = -1
add = 0,0,0
mul = 256,256,256
sinadd = 0,0,0,0
invertall = 0
color = 256

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 1
time = -1
add = 0,0,0
mul = 256,256,256
sinadd = 0,0,0,0
invertall = 0
color = 256

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time

[State 0, EnvShake]
type = EnvShake
trigger1 = 1
time = 0
freq = 0
ampl = 0
phase = 0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0, Turn]
type = Null;Turn
trigger1 = facing != 1

[State 0, PosSet]
type = PosSet
trigger1 = time < 70
x = -100*facing

[State 0, PosAdd]
type = PosSet
trigger1 = 1
y = (screenheight/2.0)-(groundlevel)+79

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 4800
value = 4800

[State 0, VarSet]
type = VarSet
trigger1 = 1
sysvar(46) = 1
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = 1
sysvar(47) = 1
ignorehitpause = 1

[State 4800, 影消去]
type = AssertSpecial
trigger1 = 1
flag = globalnoshadow
flag2 = nofg
flag3 = nobg
ignorehitpause = 1

[State 4800, 影消去]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = timerfreeze
flag3 = nobardisplay
ignorehitpause = 1

[State 4800, 影消去]
type = AssertSpecial
trigger1 = 1
flag = noko
flag2 = nokosnd
ignorehitpause = 1

[State 0, EnvColor]
type = EnvColor
trigger1 = time < 12
value = 255,255,255
time = 1
under = 0

[State 4800, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT
ignorehitpause = 1

[State 4800, ノープッシュ]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 3700,Hit]
Type=HitDef
Trigger1=1
Attr=
AnimType=hard
Air.AnimType=hard
Hitflag=MAFDP
Guardflag=
SparkNo=-1
Guard.SparkNo=-1
HitSound=-1
GuardSound=-1
Damage=0
NumHits = 0
GetPower=0,0
GivePower=-9999999,0
PauseTime=0,0
Ground.SlideTime=28
Guard.SlideTime=0
Ground.HitTime=26
Guard.HitTime=0
Guard.CtrlTime=24
P1SprPriority = 777
Priority = 7777777,Hit
Air.HitTime=24
Ground.velocity=0,0
Guard.velocity=0
Air.velocity=0,0
AirGuard.velocity=0,0
Ground.cornerpush.veloff = 0
Guard.cornerpush.veloff = 0
Air.cornerpush.veloff = 0
AirGuard.cornerpush.veloff = 0
ID=3700
P2Facing = 1
P2StateNo = 3710
snap = 52,-79
IgnoreHitPause=1
AbsHit = 2
NoBox = 1
NoMinus = 1

[State 0, ChangeAnim2]
type = TargetChangeAnim2
trigger1 = 1
value = ifelse(time < 78,4810,99999)
id = 3700

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "enemynear,spriteheight = %d"
params = enemynear,spriteheight
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = numtarget(3700) && !numexplod(3700) && time < 12
anim = 9000
ID = 3700
pos = 100,-79
postype = p1
facing = 1
vfacing = 1
bindtime = -1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -1
pausemovetime = -1
supermovetime = -1
scale = ifelse(enemynear,spriteheight > 14,enemynear,spriteheight/142.0,1.0),ifelse(enemynear,spriteheight > 14,enemynear,spriteheight/142.0,1.0)
sprpriority = 776
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = numexplod(3700) && time < 70
ID = 3700
pos = 100,-79
scale = ifelse(enemynear,spriteheight > 14,enemynear,spriteheight/142.0,1.0),ifelse(enemynear,spriteheight > 14,enemynear,spriteheight/142.0,1.0)

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 12
value = S100,171
channel = 4

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 12
value = S40,5

[State 0, Explod]
type = Explod
trigger1 = numtarget(3700) && time = 42
anim = 9001
ID = 3701
pos = 100,-79
postype = p1
facing = 1
vfacing = 1
bindtime = -1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -2
pausemovetime = -1
supermovetime = -1
scale = ifelse(enemynear,spriteheight > 14,enemynear,spriteheight/142.0,1.0),ifelse(enemynear,spriteheight > 14,enemynear,spriteheight/142.0,1.0)
sprpriority = 777
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time = 50
id = 3700

[State 0, Explod]
type = Explod
trigger1 = numtarget(3700) && time = 70
anim = 9002
ID = 3700
pos = screenwidth/2.0,screenheight/2.0
postype = back
facing = 1
vfacing = 1
bindtime = -1
vel = 0,0
accel = 0,0
random = 0,0
removetime = -1
pausemovetime = -1
supermovetime = -1
scale = 1,1
sprpriority = 778
ontop = 1
shadow = 0,0,0
ownpal = 1
removeongethit = 0

[State 0, Trans]
type = Trans
trigger1 = time >= 70 && time < 80
trans = addalpha
alpha = ifelse(time < 75,256-(256/5)*(time-69),(256/5)*(time-74)),ifelse(time >= 75,256-(256/5)*(time-74),(256/5)*(time-69))

[State 0, PosSet]
type = PosSet
trigger1 = time = 75
x = -38*facing

[State 0, TargetBind]
type = TargetBind
trigger1 = 1
time = 1
id = 3700
pos = abs(pos X),ifelse(time < 78,-enemynear,spritecenter.y,0)-79
ignorehitpause = 1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = numexplod(3701)
ID = 3701
pos = abs(pos X),-79

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 70
value = S40,4

[State 0, Explod]
type = Explod
trigger1 = time = 78
anim = 10069
ID = 3702
pos = 0,0
postype = back
facing = 1
vfacing = 1
bindtime = -1
removetime = -2
pausemovetime = -1
supermovetime = -1
scale = .91,.91
sprpriority = 0
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0

[State 0, Explod]
type = Explod
trigger1 = animelem = 55
anim = 4801
ID = 4801
pos = 0,0
postype = p1
facing = 1
vfacing = 1
bindtime = -1
removetime = -animtime
pausemovetime = -1
supermovetime = -1
scale = 1,1
sprpriority = 778
ontop = 0
shadow = 0,0,0
ownpal = 1
removeongethit = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 55
value = S100,173
channel = 4

[State 0, DestroySelf]
type = DestroyTarget
trigger1 = 1
recursive = 1
removeexplods = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelemtime(55) = 20
value = S40,6

[State 4801, 光の球破裂前エフェ（生空投げサークルエフェ流用版）]
type = Explod
trigger1 = animelemtime(55) = 20
anim = 15023
id = 15023
pos = abs(pos X),-79
postype = p1
ownpal = 1
sprpriority = 5
scale = 0.2,0.2
ignorehitpause = 1

[State 0, TargetLifeAdd]
type = TargetVarSet
trigger1 = animelemtime(55) >= 19
sysvar(10) = 0
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = animelemtime(55) >= 20
id = 3700
ignorehitpause = 1

[State 4802, ホワイトアウト白いExplod表示]
type = Explod
trigger1 = animelemtime(55) = 39
anim = 10217
id = 10217
pos = 0,0
postype = back
bindtime = -1
ownpal = 1
ontop = 1
sprpriority = 7777

[State 4802, ホワイトアウトと同時に出す背景（十字架）]
type = Explod
trigger1 = animelemtime(55) = 21
anim = 9005
id = 9005
pos = screenwidth/2.0,screenheight/2.0
postype = back
bindtime = -1
ownpal = 1
scale = 1,1
sprpriority = 1

[State 4802, ホワイトアウトと同時に出す背景]
type = Explod
trigger1 = animelemtime(55) = 21
anim = 9006
id = 9006
pos = screenwidth/2.0,screenheight/2.0
postype = back
bindtime = -1
ownpal = 1
ontop = 1
scale = 1,1
sprpriority = 777

[State 4802, ズコーンSE]
type = PlaySnd
trigger1 = animelemtime(55) = 21
value = S30, 18

[State 0, TargetPowerAdd]
type = TargetPowerAdd
trigger1 = 1
value = -9999999

[State 0, TargetVarSet]
type = TargetVarSet
trigger1 = animelemtime(55) >= 19
sysvar(56) = 4
ignorehitpause = 1

[State 0, WinAdd]
type = WinAdd
triggerall = animelemtime(55) >= 19
trigger1 = enemy,teammode != turns
trigger2 = teammode != turns
p1 = ifelse(teamside = 1,ifelse(enemy,teammode != turns,99,0),ifelse(teammode != turns,-99,0))
p2 = ifelse(teamside = 2,ifelse(enemy,teammode != turns,99,0),ifelse(teammode != turns,-99,0))

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !animtime
id = 3702

[State 0, PosSet]
type = PosSet
trigger1 = !animtime
x = 0
y = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

[Statedef 3710]
Type = S
MoveType = I
Physics = N
Ctrl = 0
SprPriority = 775
NoMinus = 1

[State 0, PalFX]
type = PalFX
trigger1 = 1
time = 0
add = 0,0,0
mul = 256,256,256
invertall = 0
color = 256
ignorehitpause = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0
ignorehitpause = 1

[State 0, StopSnd]
type = StopSnd
trigger1 = 1
channel = -1
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = ishelper
recursive = 1
removeexplods = 1
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = 1
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = !alive
x = gamewidth
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !alive
value = 5150
ctrl = 0

;---------------------------------------------------------------------------
; 立ち食らい（食らい中）
[Statedef 5000]
type    = S
movetype= H
physics = N
velset = 0,0

[State 5000, アニメ指定（アルク画像）]
type = ChangeAnim
trigger1 = anim != [50300,50303]
trigger1 = !time
trigger1 = Roundno >= 3
trigger1 = life <= GetHitVar(damage)
trigger1 = enemy,alive
value = 50300
persistent = 0
ignorehitpause = 1

[State 5000, アルク画像変更時 - キラキラエフェクト]
type = Explod
trigger1 = !NumExplod(10056)
trigger1 = anim = [50300,50303]
anim = 10056
id = 10056
pos = 0,-50
postype = p1
ownpal = 1
sprpriority = 2
persistent = 0
ignorehitpause = 1

[State 5000, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = anim != 50300	;アルク画像でない場合
trigger1 = !time
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(groundtype) = 1),5000,5010) + GetHitVar(animtype)

[State 5000, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = anim != 50300	;アルク画像でない場合
trigger1 = !time
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 5000, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = anim != 50300	;アルク画像でない場合
trigger1 = !time
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5000, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5000, 5] ;State type gets set to aerial if getting hit up
type = StateTypeSet
trigger1 = !time
trigger1 = GetHitVar(yvel) != 0 || GetHitVar(fall)
trigger2 = Pos Y != 0
statetype = a

[State 5000, 6]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0 && !GetHitVar(fall)
value = 5001 ;Stand get-hit (knocked back)

[State 5000, 7]
type = ChangeState
trigger1 = HitShakeOver
value = 5030

;---------------------------------------------------------------------------
; 空中食らい
[Statedef 5020]
type    = A
movetype= H
physics = N
velset = 0,0

[State 5020, 地面にめり込む場合はY=0まで戻す]
type = PosSet
trigger1 = !time
trigger1 = pos Y > 0
y = 0
ignorehitpause = 1

[State 5020, アルク画像変更時 - キラキラエフェクト]
type = Explod
trigger1 = !NumExplod(10056)
trigger1 = anim = [50300,50303]
anim = 10056
id = 10056
pos = 0,-50
postype = p1
ownpal = 1
sprpriority = 2
persistent = 0
ignorehitpause = 1

[State 5020, アニメ指定]
type = ChangeAnim
trigger1 = !time
trigger1 = anim != 50300	;アルク画像でない場合
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 5020, アニメ指定（空中食らい時？）]
type = ChangeAnim
trigger1 = !time
trigger1 = anim != 50300	;アルク画像でない場合
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 5020, 錐揉みとか特殊やられ？]
type = ChangeAnim
trigger1 = !time
trigger1 = anim != 50300	;アルク画像でない場合
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5020, アニメエレメントを固定]
type = ChangeAnim
trigger1 = time > 0
value = anim

[State 5020, 落下とかへ]
type = ChangeState
trigger1 = HitShakeOver
value = 5030

;---------------------------------------------------------------------------
; 空中食らい（ノックダウン）
[Statedef 5030]
type    = A
movetype= H
physics = N
ctrl = 0

[State 5030, アルク画像以外]
type = ChangeAnim
trigger1 = !time
value = 5030

[State 5030, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5030, 3]
type = HitVelSet
trigger1 = !time
x = 1
y = 1

[State 5030, 4]
type = ChangeState
triggerall = !HitFall
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= Const(movement.air.gethit.groundlevel)
value = 5040 ;HITA_RECOV

[State 5030, 5]
type = ChangeState
triggerall = HitFall
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= Const(movement.air.gethit.groundlevel)
value = 5050 ;HITA_FALL

[State 5030, 6]
type = ChangeState
trigger1 = Vel Y >= 0
value = 5035 ;Air get-hit (transition)

;---------------------------------------------------------------------------
; 空中食らい後の落下ステ
[Statedef 5035]
type    = A
movetype= H
physics = N

[State 5035, 1]
type = ChangeAnim
trigger1 = !time
value = 5035

[State 5035, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5035, 3]
type = ChangeState
triggerall = !HitFall
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Animation over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= Const(movement.air.gethit.groundlevel)
trigger4 = !time     ;No transition anim
trigger4 = Anim != 5035 ;.
value = 5040 ;Air get-hit (recovering in air, not falling)

[State 5035, 4]
type = ChangeState
triggerall = HitFall
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Anim is over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= Const(movement.air.gethit.groundlevel)
trigger4 = !time     ;No transition anim
trigger4 = Anim != 5035 ;.
value = 5050 ;Air get-hit (falling)

;---------------------------------------------------------------------------
; ダウン（地面接触直後）
[Statedef 5100]
type    = L
movetype= H
physics = N

[State 5100, フェール]
type = DestroySelf
trigger1 = !time
trigger1 = Ishelper

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0

[State 5100, 5]
type = VelSet
trigger1 = !time
y = 0

[State 5100, 揺れ]
type = EnvShake
trigger1 = !time
time = 10
freq = 80
ampl = 4

[State 5100, 砂煙]
type = Explod
trigger1 = !time
anim = 10080
id = 10080
pos = 0,0
postype = p1
ownpal = 1
bindtime = 1
persistent = 0
supermovetime = 999
sprpriority = 3

[State 5100, 砂煙（影）]
type = Explod
trigger1 = !time
anim = 12190
id = 12190
pos = 0,0
postype = p1
ownpal = 1
bindtime = 1
persistent = 0
supermovetime = 999
sprpriority = 2

[State 5100, ダウンエフェクト]
type = Explod
trigger1 = !time
anim = 13501
id = 13501
pos = 0,0
postype = p1
ownpal = 1
scale = 0.5,0.5
persistent = 0
supermovetime = 999
sprpriority = -1

[State 5100, 1]
type = Null;VelSet
trigger1 = !time
trigger1 = anim != 5070	;足払いやられ
trigger1 = GetHitVar(fall.yvel) = 0
trigger1 = vel x > 1
x = 1

[State 5100, Var]
type = VarSet
trigger1 = !time
sysvar(1) = floor(vel y)

[State 5100, アニメ変更（アルク画像）]
type = ChangeAnim
trigger1 = anim = 50301		;アルク画像の場合
trigger1 = !time
trigger2 = anim != 50301	;アルク画像でない場合（ステ取られてアルクになってない場合のフェール的な処理）
trigger2 = !time
trigger2 = Roundno >= 3
trigger2 = roundstate != 2
value = 50302

[State 5100, 垂直やられから来た場合]
type = ChangeAnim
triggerall = anim != 50302	;アルク画像でない場合
triggerall = !time
trigger1 = anim = 5061
trigger2 = anim = 877
value = 5111

[State 5100, 足払いやられから来た場合はターン]
type = Turn
trigger1 = !time
trigger1 = anim = 5070

[State 5100, アニメ変更（通常）]
type = ChangeAnim
triggerall = anim != 50302	;アルク画像でない場合
triggerall = anim != 5111
triggerall = !time
trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
trigger2 = !SelfAnimExist(5100 + (anim % 10))
value = 5100

[State 5100, アニメ変更（仰向け？）]
type = ChangeAnim
trigger1 = anim != 50302	;アルク画像でない場合
triggerall = anim != 5111
trigger1 = !time
trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
trigger1 = SelfAnimExist(5100 + (anim % 10))
value = 5100 + (anim % 10)

[State 5100, アルク画像変更時 - キラキラエフェクト]
type = Explod
trigger1 = !NumExplod(10056)
trigger1 = anim = [50300,50303]
anim = 10056
id = 10056
pos = 0,-50
postype = p1
ownpal = 1
sprpriority = 2
persistent = 0
ignorehitpause = 1

[State 5100, 6] ;Reduce speed
type = VelMul
trigger1 = !time
trigger1 = anim != 5070	;足払いやられ
x = 0.75

[State 5100, 7]
type = ChangeState
trigger1 = anim != 5111
trigger1 = !time
trigger1 = GetHitVar(fall.yvel) = 0
value = 5110

[State 5100, ダウンSE]
type = PlaySnd
trigger1 = !time
value = S30,1

[State 5100, 11]
type = PosFreeze
trigger1 = 1

[State 5100, 垂直やられの場合はゴニョゴニョ位置調整]
type = Null;PosAdd
trigger1 = AnimTime = 0
x = -8
persistent = 0

[State 0, ChangeState]
type = SelfState
triggerall = alive
trigger1 = Command = "recovery"
trigger2 = Command = "地上受け身専用"
value = 5200

[State 5100, 12]
type = ChangeState
trigger1 = AnimTime = 0
value = 5101

;---------------------------------------------------------------------------
; ダウン後バウンド
[Statedef 5101]
type    = L
movetype= H
physics = N

[State 5101, 1]
type = ChangeAnim
trigger1 = !time
value = 5160

[State 5101, 3]
type = HitFallVel
trigger1 = !time

[State 5101, 6] ;Acceleration
type = VelAdd
trigger1 = 1
y = Const(movement.down.bounce.yaccel)

[State 5101, 1]
type = ChangeAnim
trigger1 = vel Y > 0
value = 5161

[State 5101, 4]
type = Null;PosSet
trigger1 = !time
y = Const(movement.down.bounce.offset.y)

[State 5101, 5]
type = Null;PosAdd
trigger1 = !time
x = Const(movement.down.bounce.offset.x)

[State 5101, 5]
type = VelMul
trigger1 = !time
x = .50

[State 0, ChangeState]
type = SelfState
triggerall = alive
trigger1 = Command = "recovery"
trigger2 = Command = "地上受け身専用"
value = 5200

[State 5101, 6] ;Hit ground
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5110

;---------------------------------------------------------------------------
; ダウン中（死亡時以外）
[Statedef 5110]
type    = L
movetype= I
physics = N

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = !time

[State 5110, ダウンSE]
type = PlaySnd
trigger1 = prevstateno = 5050 || prevstateno = 5071 || prevstateno = 5030
trigger1 = !time
value = S30,1

[State 5110, 揺れ]
type = EnvShake
trigger1 = prevstateno = 5050 || prevstateno = 5071 || prevstateno = 5030
trigger1 = !time
time = 10
freq = 80
ampl = 4

[State 5110, 砂煙]
type = Explod
trigger1 = prevstateno = 5050 || prevstateno = 5071 || prevstateno = 5030
trigger1 = !time
anim = 10080
id = 10080
pos = 0,-22
postype = p1
ownpal = 1
bindtime = 1
persistent = 0
sprpriority = 3

[State 5110, 砂煙（影）]
type = Explod
trigger1 = prevstateno = 5050 || prevstateno = 5071 || prevstateno = 5030
trigger1 = !time
anim = 12190
id = 12190
pos = 0,-22
postype = p1
ownpal = 1
bindtime = 1
persistent = 0
sprpriority = 2

[State 5110, ダウンエフェクト]
type = Explod
trigger1 = prevstateno = 5050 || prevstateno = 5071 || prevstateno = 5030
trigger1 = !time
anim = 13501
id = 13501
pos = 0,10
postype = p1
ownpal = 1
persistent = 0
scale = 0.5,0.5
sprpriority = -1

[State 5110, 足払いからのダウンは逆向きへ]
type = Turn
trigger1 = anim = 5070
trigger1 = !time

[State 5110, アニメ変更（アルク画像）]
type = ChangeAnim
trigger1 = !time
trigger1 = anim = 50304
value = 50303

[State 5110, 垂直やられから来た場合]
type = ChangeAnim
trigger1 = !time
trigger1 = anim != 50303	;アルク画像でない場合
trigger1 = anim = 5112
value = 5113

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim != 50303	;アルク画像でない場合
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = !time
triggerall = anim != 50303	;アルク画像でない場合
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = !time
triggerall = anim != 50303	;アルク画像でない場合
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 5]
type = PosSet
trigger1 = !time
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = !time
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

[State 5110, 8]
type = VelSet
trigger1 = !time
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim != 50303	;アルク画像でない場合
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = anim != 50303	;アルク画像でない場合
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 0, ChangeState]
type = SelfState
triggerall = alive
trigger1 = Command = "recovery"
trigger2 = Command = "地上受け身専用"
value = 5200

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = !time
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = .50

[State -I1, Getup2]
type = VarAdd
trigger1 = 1
sysvar(54) = 1

;---------------------------------------------------------------------------
; 起き上がり
[Statedef 5120]
type    = L
movetype= I
physics = N

[State 0, ChangeState]
type = SelfState
triggerall = alive
trigger1 = Command = "recovery"
trigger2 = Command = "地上受け身専用"
value = 5200

[state 5120, 起き上がりボイス 1]
type = PlaySnd
trigger1 = !time
value = S100,cond(random%10 < 2,135,96+(random%9))
channel = 4

[State 5120, 垂直やられから来た場合]
type = ChangeAnim
trigger1 = !time
trigger1 = anim = 5113
value = 5121

[State 5120, 1a] ;Get up anim (normal)
type = ChangeAnim
triggerall = !time
triggerall = anim != 5121
trigger1 = anim != [5111,5119]
trigger2 = !SelfAnimExist(5120 + (anim % 10))
value = 5120

[State 5120, 1b] ;Get up anim (for hit up/diag-up)
type = ChangeAnim
triggerall = !time
triggerall = anim != 5121
trigger1 = anim = [5111,5119]
trigger1 = SelfAnimExist(5120 + (anim % 10))
value = 5120 + (anim % 10)

[State 5120, 2]
type = VelSet
trigger1 = !time
x = 0

[State 5120, 3]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT
time = 1

[State 5120, 4]
type = HitFallSet
trigger1 = !AnimTime
value = 1

[State 5120, 5] ;Can't be thrown right after getting up
type = NotHitBy
trigger1 = !AnimTime
value = SCA, NT,ST,HT
time = 12

[State 5120, 6] ;Can't be hit right after getting up (short time)
type = NotHitBy
trigger1 = !AnimTime
value2 = SCA,AA,AP,AT
time = 3

[State 5120, 7]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; ダウン中（死亡時）
[Statedef 5150]
type    = L
movetype= H
physics = N
sprpriority = -3
ctrl = 0
nominus = anim = 99999

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = anim = 99999
flag = invisible
flag2 = noshadow
flag3 = nomusic

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = anim = 99999
flag = noko

[State 0, ScreenBound]
type = ScreenBound
trigger1 = anim = 99999
value = 0
movecamera = 0,0

[State 5150, アニメ変更（アルク画像）]
type = ChangeAnim
triggerall = anim != 99999
triggerall = enemy,alive
trigger1 = !time
trigger1 = anim = 50302
trigger2 = anim != 50302	;アルク画像でない場合（ステ取られてアルクになってない場合のフェール的な処理）
trigger2 = !time
trigger2 = Roundno >= 3
trigger2 = roundstate != 2
value = 50303

[State 5150, アルク画像変更時 - キラキラエフェクト]
type = Explod
triggerall = anim != 99999
trigger1 = !NumExplod(10056)
trigger1 = anim = [50300,50303]
anim = 10056
id = 10056
pos = 0,-50
postype = p1
ownpal = 1
sprpriority = 2
persistent = 0
ignorehitpause = 1

[State 5150, 1] ;Normal anim
type = ChangeAnim
triggerall = anim != 99999
triggerall = !time
triggerall = anim != 50303	;アルク画像でない場合
triggerall = SelfAnimExist(5140)
trigger1 = (anim != [5111,5119]) && (anim != [5171,5179])
trigger2 = !SelfAnimExist(5140 + (anim % 10))
value = 5140

[State 5150, 3] ;Hit up type anim
type = ChangeAnim
triggerall = anim != 99999
trigger1 = !time
trigger1 = anim != 50303	;アルク画像でない場合
trigger1 = (anim = [5111,5119]) || (anim = [5171,5179])
trigger1 = SelfAnimExist(5140 + (anim % 10))
value = 5140 + (anim % 10)

[State 5150, 4] ;Match over anim
type = ChangeAnim
triggerall = anim != 99999
trigger1 = anim != 50303	;アルク画像でない場合
trigger1 = MatchOver = 1
trigger1 = Anim = [5140,5149]
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5150, 5] ;Switch to 5110 if liedead anim does not exist
type = ChangeAnim
triggerall = anim != 99999
trigger1 = !time
trigger1 = anim != 50303	;アルク画像でない場合
trigger1 = Anim != [5140,5159]
trigger1 = Anim != [5110,5119]
value = 5110

[State 5150, 6] ;Friction
type = VelMul
trigger1 = anim != 99999
x = .50

[State 5150, 7] ;Friction
type = VelSet
trigger1 = anim != 99999
persistent = 0
x = 0

[State 5150, 8]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT
time = 1

;---------------------------------------------------------------------------
; 地上受け身 - 1
[Statedef 5200]
type    = A
movetype= I
physics = N
ctrl = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 5200

[State 5200, 設定]
type = PosSet
trigger1 = !time
y = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S5200,0

[State 5200, ターン]
type = Turn
trigger1 = !time
trigger1 = p2dist X < -5

[State 5200, NHB]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT
time = 10

[State 5200, ノープッシュ]
type = PlayerPush
trigger1 = 1
value = 0

[State 5200, 点滅]
type = PalFX
trigger1 = time <= 10
trigger1 = time%2 = 0
time = 1
add = 222,222,222

[State 5200, 砂煙]
type = Explod
trigger1 = !time
anim = 10080
id = 10080
pos = 0,0
postype = p1
ownpal = 1
bindtime = 0
persistent = 0
sprpriority = 3

[State 5200, 砂煙（影）]
type = Explod
trigger1 = !time
anim = 12190
id = 12190
pos = 0,0
postype = p1
ownpal = 1
bindtime = 0
persistent = 0
sprpriority = 2

[State 5200, 衝撃波]
type = Explod
trigger1 = !NumExplod(12220)
trigger1 = !time
anim = 12220
id = 12220
pos = 0,-40
postype = p1
ownpal = 1
bindtime = 0
scale = 0.54,0.54
sprpriority = 2

[State 5200, 移動]
type = VelSet
trigger1 = !time
x = ifelse((command="holdright" && facing = 1) || (command="holdleft" && facing = -1),5.5, ifelse((command="holdright" && facing = -1) || (command="holdleft" && facing = 1),-5.5, 0))
y = -5.4

[State 5200, 2]
type = VelAdd
trigger1 = 1
y = .64

[State 5200, 揺れ]
type = EnvShake
trigger1 = !time
time = 10
freq = 80
ampl = 3

[State 5200, 1] ;Change anim if done with transition
type = ChangeAnim
trigger1 = Anim = 5035
trigger1 = AnimTime = 0
value = 5050

[State 5200, 3]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52

;---------------------------------------------------------------------------
; 空中自動復帰
[Statedef 5040]
type    = A
movetype= I
physics = A
ctrl = 1

[State 5040, 1]
type = ChangeState
trigger1 = !Alive
value = 5050

[State 5040, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim != 5040
trigger2 = !time
trigger2 = Anim != 5035
value = 5040

[State 5040, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52 ;JUMPLAND

;---------------------------------------------------------------------------
; 空中落下
[Statedef 5050]
type    = A
movetype= H
physics = N

[State 5050, 1]
type = ChangeAnim
triggerall = gethitvar(animtype) = 4
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = !time     ;If no transition anim
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090 ;Not if hit off ground anim
value = 5061

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "gethitvar(animtype) = %d"
params = gethitvar(animtype)
ignorehitpause = 1

[State 5050, 1] ;Change anim when done with transition
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = !time     ;If no transition anim
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090 ;Not if hit off ground anim
value = 5050

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = anim != 50301	;アルク画像でない場合
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, Const720p(4), Const720p(-8))
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5050, ガードブレイク対処　ブレイクSE]
type = PlaySnd
trigger1 = Numhelper(11300)
trigger1 = helper(11300),fvar(1) <= 0
trigger1 = !time
value = S20,6
persistent = 0
ignorehitpause = 1

[State 5050, ガードブレイク対処　※暫定]
type = PlaySnd
trigger1 = Numhelper(11300)
trigger1 = helper(11300),fvar(1) <= 0
trigger1 = random%2
trigger1 = !time
value = S100,88
channel = 0
persistent = 0
ignorehitpause = 1

[State 5050, ガードブレイク対処　※暫定]
Type = EnvShake
trigger1 = Numhelper(11300)
trigger1 = helper(11300),fvar(1) <= 0
Trigger1 = !time
time = 11
ampl = 9
freq = 58
persistent = 0
ignorehitpause = 1

[State 5050, ガードブレイク対処　※暫定]
Type = VelSet
trigger1 = Numhelper(11300)
trigger1 = helper(11300),fvar(1) <= 0
Trigger1 = !time
x = -1.1
y = -7.8
persistent = 0
ignorehitpause = 1

[State 5050, ガードブレイク対処　※暫定]
type = Explod
trigger1 = Numhelper(11300)
trigger1 = helper(11300),fvar(1) <= 0
Trigger1 = !time
anim = 13070
id = 13070
pos = 9, -66
postype = p1
ownpal = 1
bindtime = 1
sprpriority = 3
scale = 0.9,0.9
pausemovetime = 999
supermovetime = 999
persistent = 0
ignorehitpause = 1

[State 5050, 死亡時の重力]
Type = VelAdd
trigger1 = lose
trigger1 = anim = 50301	;アルクアニメ
trigger1 = 1
y = .52

[State 5050, 3] ;Gravity
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5050, 空中受け身]
type = ChangeState
triggerall = alive
triggerall = CanRecover
trigger1 = Command = "recovery"
value = 5210

[State 5050, ダウン]
type = ChangeState
trigger1 = anim != 5061
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 25
trigger2 = anim = 5061
trigger2 = Vel Y > 0
trigger2 = Pos Y >= 0
value = 5100 ;HIT_BOUNCE

;---------------------------------------------------------------------------
; ダウン時食らい
[Statedef 5080]
type    = L
movetype= H
physics = N
anim = 5030
velset = 0,0

[State 5080, 地面にめり込む場合はY=0まで戻す]
type = PosSet
trigger1 = !time
trigger1 = pos Y = 0
y = -10
ignorehitpause = 1

[State 5080, 1] ;Set default anim
type = VarSet
trigger1 = !time
sysvar(2) = ifelse (GetHitVar(yvel) = 0, 5080, 5090)

[State 5080, 2]
type = VarAdd
trigger1 = !time
trigger1 = (anim = [5081,5089]) || (anim = [5111,5119])
trigger1 = SelfAnimExist(sysvar(2) + (anim % 10))
sysvar(2) = anim % 10

[State 5080, 3] ;If 5090 doesn't exist, default to 5030
type = VarSet
trigger1 = !time
trigger1 = sysvar(2) = 5090
trigger1 = !SelfAnimExist(5090)
sysvar(2) = 5030

[State 5080, 4]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0
value = 5081 ;HITL_SLIDE

[State 5080, 5]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) != 0
value = 5030 ;HITA_UP

;---------------------------------------------------------------------------
; 空中受け身
[Statedef 5210]
type    = A
movetype= I
physics = N
ctrl = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 5210

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S5200,0

[State 5210, 2]
type = Turn
trigger1 = !time
trigger1 = p2dist X < -20

[State 5210, 点滅]
type = PalFX
trigger1 = time <= 10
trigger1 = time%2 = 0
time = 1
add = 222,222,222

[State 5210, 衝撃波]
type = Explod
trigger1 = !NumExplod(12220)
trigger1 = !time
anim = 12220
id = 12220
pos = 0,-40
postype = p1
ownpal = 1
scale = 0.54,0.54
pausemovetime = 99
sprpriority = 2

[State 5210, 1]
type = PosFreeze
trigger1 = Time < 4

[State 5210, ワイヤーから来た場合or低空の場合の位置補正] 
type = PosAdd
trigger1 = pos Y > -10
trigger1 = !time
y = -10

[State 5210, 通常] 
type = VelSet
trigger1 = time = 4
x = ifelse(command="holdfwd",2.4, ifelse(command="holdback",-2.4, -0.8))
y = -11

[State 5210, 1]
type = VelAdd
trigger1 = time >= 4
y = .51

[State 5200, NHB]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT
time = 10

[State 5210, 5] ;Land on ground
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52 ;JUMP_LAND
ctrl = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 50
ctrl = 1

[StateDef 5900]
type = S
movetype= I
physics = N
velset = 0,0
ctrl = 0
anim = 0

[State 0, RemapPal]
type = RemapPal
trigger1 = roundsexisted = 0
source = 1,1
dest = 1,palno

[State 0, VarRangeSet]
type = VarRangeSet
trigger1 = roundsexisted = 0
value = 0
first = 0
last = 59

[State 0, VarRangeSet]
type = VarRangeSet
trigger1 = 1
fvalue = 0
first = 0
last = 39

[State 0, VarRangeSet]
type = VarRangeSet
trigger1 = roundsexisted > 0
value = 0
first = 0
last = 11

[State 0, VarRangeSet]
type = VarRangeSet
trigger1 = roundsexisted > 0
value = 0
first = 13
last = 59

[State 0, ChangeState]
type = ChangeState
trigger1 = roundsexisted = 0
value = 191
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = 1
value = 0
ctrl = 1

[StateDef 10210]
type = S
anim = 99999
velset = 0,0
ctrl = 0
sprpriority = -1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,stateno = 3700
recursive = 1
removeexplods = 1
ignorehitpause = 1

[State 10210, 影消去]
type = AssertSpecial
trigger1 = 1
flag = noshadow
flag2 = nofg
flag3 = nobg
ignorehitpause = 1

[State 10210, SE]
type = PlaySnd
trigger1 = !time
value = S30, 3
persistent = 0

[State 10210, カットイン]
type = Explod
trigger1 = !NumExplod(10212)
trigger1 = !time
anim = 10212
id = 10212
pos = -70,0
postype = back
ownpal = 1
;facing = ifelse(root,facing=1,1,-1)
supermovetime = 999
pausemovetime = 999
bindtime = -1
removeongethit = 0
scale = 0.5,0.5
sprpriority = -50;-2
persistent = 0

[State 10210, 背景ハレーション]
type = Explod
trigger1 = !NumExplod(10210)
trigger1 = !time
anim = 10210
id = 10210
pos = -30,0;ifelse(root,facing=1,-30,350),0
postype = back
ownpal = 1
;facing = ifelse(root,facing=1,1,-1)
supermovetime = 999
pausemovetime = 999
bindtime = -1
removeongethit = 0
scale = 0.55,0.55
sprpriority = -51;-2
persistent = 0

[State 10210, 消去]
type = DestroySelf
trigger1 = time >= 62

[StateDef 10211]
type = S
anim = 99999
velset = 0,0
ctrl = 0
sprpriority = -1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,stateno = 3700
recursive = 1
removeexplods = 1
ignorehitpause = 1

[State 10210, 影消去]
type = AssertSpecial
trigger1 = 1
flag = noshadow
flag2 = nofg
flag3 = nobg
ignorehitpause = 1

[State 10210, SE]
type = PlaySnd
trigger1 = !time
value = S30, 3
persistent = 0

[State 10210, カットイン]
type = Explod
trigger1 = !NumExplod(10213)
trigger1 = !time
anim = 10213
id = 10213
pos = -40,10
postype = back
ownpal = 1
;facing = ifelse(root,facing=1,1,-1)
supermovetime = 999
pausemovetime = 999
bindtime = -1
removeongethit = 0
scale = 0.5,0.5
sprpriority = -50;-2
persistent = 0

[State 10210, 背景ハレーション]
type = Explod
trigger1 = !NumExplod(10210)
trigger1 = !time
anim = 10210
id = 10210
pos = -30,0;ifelse(root,facing=1,-30,350),0
postype = back
ownpal = 1
;facing = ifelse(root,facing=1,1,-1)
supermovetime = 999
pausemovetime = 999
bindtime = -1
removeongethit = 0
scale = 0.55,0.55
sprpriority = -51;-2
persistent = 0

[State 10210, 消去]
type = DestroySelf
trigger1 = time >= 58

[Statedef 30000]
anim = 99999;アニメなし
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
triggerall = root,stateno != 3700
trigger1 = !time
value = S30,7
volumescale = 400

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic

[Statedef 30001]
anim = 99999;アニメなし
ctrl = 0

[State 0, DestroySelf]
type = DestroySelf
trigger1 = root,stateno = 3700
recursive = 1
removeexplods = 1
ignorehitpause = 1

[State 30001];
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power < 1000
trigger1 = var(10) > 999
anim = 77700
ID = 77700
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0))),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)))
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 298
scale = .2,.2
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power < 1000
trigger1 = var(10) > power
anim = 77701
ID = 77701
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0))),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)))
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 298
scale = ifelse(var(10) < 1000,var(10)/5000.0,.2),ifelse(var(10) < 1000,var(10)/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = power < 1000 && numexplod(7770) > 0
id = 7770
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power > 0
trigger1 = numexplod(7770) = 0
anim = 7770
ID = 7770
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0))),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)))
postype = left
bindtime = -1
removetime = -1
supermovetime = -1
pausemovetime = -1
sprpriority = 298
scale = ifelse(power < 1000,power/5000.0,.2),ifelse(power < 1000,power/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = power > 999
ID = 7770
scale = .2,.2
sprpriority = 298
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
trigger1 = power < 2000 && var(10) > 1999
anim = 77710
ID = 77710
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*2.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*2.0))
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 299
scale = .2,.2
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power < 2000 && var(10) > 1000
trigger1 = var(10) > power
anim = 77711
ID = 77711
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*2.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*2.0))
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 299
scale = ifelse(var(10) < 2000,(var(10)-1000)/5000.0,.2),ifelse(var(10) < 2000,(var(10)-1000)/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = power < 2000 && numexplod(7771) > 0
id = 7771
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power > 1000
trigger1 = numexplod(7771) = 0
anim = 7771
ID = 7771
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*2.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*2.0))
postype = left
bindtime = -1
removetime = -1
supermovetime = -1
pausemovetime = -1
sprpriority = 299
scale = ifelse(power < 2000,(power-1000)/5000.0,.2),ifelse(power < 2000,(power-1000)/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = power > 1999
ID = 7771
scale = .2,.2
sprpriority = 299
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
trigger1 = power < 3000 && var(10) > 2999
anim = 77720
ID = 77720
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*3.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*3.0))
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 300
scale = .2,.2
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power < 3000 && var(10) > 2000
trigger1 = var(10) > power
anim = 77721
ID = 77721
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*3.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*3.0))
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 300
scale = ifelse(var(10) < 3000,(var(10)-2000)/5000.0,.2),ifelse(var(10) < 3000,(var(10)-2000)/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = power < 3000 && numexplod(7772) > 0
id = 7772
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power > 2000
trigger1 = numexplod(7772) = 0
anim = 7772
ID = 7772
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*3.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*3.0))
postype = left
bindtime = -1
removetime = -1
supermovetime = -1
pausemovetime = -1
sprpriority = 300
scale = ifelse(power < 3000,(power-2000)/5000.0,.2),ifelse(power < 3000,(power-2000)/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = power > 2999
ID = 7772
scale = .2,.2
sprpriority = 300
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
trigger1 = power < 4000 && var(10) > 3999
anim = 77730
ID = 77730
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*4.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*4.0))
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 300
scale = .2,.2
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power < 4000 && var(10) > 3000
trigger1 = var(10) > power
anim = 77731
ID = 77731
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*4.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*4.0))
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 300
scale = ifelse(var(10) < 4000,(var(10)-3000)/5000.0,.2),ifelse(var(10) < 4000,(var(10)-3000)/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = power < 4000 && numexplod(7773) > 0
id = 7773
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power > 3000
trigger1 = numexplod(7773) = 0
anim = 7773
ID = 7773
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*4.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*4.0))
postype = left
bindtime = -1
removetime = -1
supermovetime = -1
pausemovetime = -1
sprpriority = 300
scale = ifelse(power < 4000,(power-3000)/5000.0,.2),ifelse(power < 4000,(power-3000)/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = power > 3999
ID = 7773
scale = .2,.2
sprpriority = 300
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
trigger1 = power < 5000 && var(10) > 4999
anim = 77740
ID = 77740
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*5.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*5.0))
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 299
scale = .2,.2
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power < 5000 && var(10) > 4000
trigger1 = var(10) > power
anim = 77741
ID = 77741
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*5.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*5.0))
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 299
scale = ifelse(var(10) < 5000,(var(10)-4000)/5000.0,.2),ifelse(var(10) < 5000,(var(10)-4000)/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = power < 5000 && numexplod(7774) > 0
id = 7774
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power > 4000
trigger1 = numexplod(7774) = 0
anim = 7774
ID = 7774
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*5.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*5.0))
postype = left
bindtime = -1
removetime = -1
supermovetime = -1
pausemovetime = -1
sprpriority = 299
scale = ifelse(power < 5000,(power-4000)/5000.0,.2),ifelse(power < 5000,(power-4000)/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = power > 4999
ID = 7774
scale = .2,.2
sprpriority = 299
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
trigger1 = power < 6000 && var(10) > 5999
anim = 77750
ID = 77750
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*6.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*6.0))
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 298
scale = .2,.2
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power < 6000 && var(10) > 5000
trigger1 = var(10) > power
anim = 77751
ID = 77751
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*6.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*6.0))
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 298
scale = ifelse(var(10) < 6000,(var(10)-5000)/5000.0,.2),ifelse(var(10) < 6000,(var(10)-5000)/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = power < 6000 && numexplod(7775) > 0
id = 7775
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power > 5000
trigger1 = numexplod(7775) = 0
anim = 7775
ID = 7775
pos = 30.0+(20.0*sin((360.0/7.0)*(pi/180.0)*6.0)),210.0-(20.0*cos((360.0/7.0)*(pi/180.0)*6.0))
postype = left
bindtime = -1
removetime = -1
supermovetime = -1
pausemovetime = -1
sprpriority = 298
scale = ifelse(power < 6000,(power-5000)/5000.0,.2),ifelse(power < 6000,(power-5000)/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = power > 5999
ID = 7775
scale = .2,.2
sprpriority = 298
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
trigger1 = power < 7000 && var(10) > 6999
anim = 77760
ID = 77760
pos = 30,190
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 297
scale = .2,.2
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power < 7000 && var(10) > 6000
trigger1 = var(10) > power
anim = 77761
ID = 77761
pos = 30,190
postype = left
bindtime = -1
removetime = -2
supermovetime = -1
pausemovetime = -1
sprpriority = 297
scale = ifelse(var(10) < 7000,(var(10)-6000)/5000.0,.2),ifelse(var(10) < 7000,(var(10)-6000)/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = power < 7000 && numexplod(7776) > 0
id = 7776
ignorehitpause = 1

[State 30000];ゲージ枠
type = Explod
triggerall = teamside = 1 && playerno = 1
triggerall = power > 6000
trigger1 = numexplod(7776) = 0
anim = 7776
ID = 7776
pos = 30,190
postype = left
bindtime = -1
removetime = -1
supermovetime = -1
pausemovetime = -1
sprpriority = 297
scale = ifelse(power < 7000,(power-6000)/5000.0,.2),ifelse(power < 7000,(power-6000)/5000.0,.2)
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = power > 6999
ID = 7776
scale = .2,.2
sprpriority = 297
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = !numexplod(7777) && parent,var(12) > 0; && parent,var(12) < 6000
anim = 7777
ID = 7777
pos = 30,210
postype = left
bindtime = -1
removetime = -1
supermovetime = -1
pausemovetime = -1
sprpriority = 299
scale = .5,.5
ownpal = 1
ontop = 1
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = parent,var(21) <= 0
id = 7777
ignorehitpause = 1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = numexplod(7777)
ID = 7777
scale = (parent,var(21)*1.0/parent,var(12)*1.0)*.5,(parent,var(21)*1.0/parent,var(12)*1.0)*.5
sprpriority = 299
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = 1
var(10) = power
ignorehitpause = 1

[Statedef -2]

[State -2];タイマー呼び出し
	type = Helper
triggerall = stateno != 3700
	triggerall = !ishelper
	trigger1 = Numhelper(30001) = 0
	stateno = 30001
	ID = 30001
	pos = 0,0
	postype = left
	helpertype = normal
	name = "timers"
	keyctrl = 0
	ownpal = 1
	pausemovetime = -1
	supermovetime = -1

[State 0, StopSnd]
type = StopSnd
trigger1 = movetype = H && time = 1 && stateno != [150,155]
channel = 4

[State 0, VarSet]
type = VarSet
trigger1 = 1
sysvar(4) = ifelse(ctrlover,0,ifelse(stateno = 130 || stateno = 131,1,ctrl))

[State 0, VarSet]
type = VarSet
triggerall = stateowner = playerno
triggerall = !ctrlover
trigger1 = movetype = H
trigger1 = !hitfall
trigger1 = hitover
sysvar(4) = 1

[State 0, AssertSpecial]
type = Null;AssertSpecial
trigger1 = 1
flag = noautoturn

[State 0, PosAdd]
type = Null;PosAdd
triggerall = p2name != "ARCHETYPE:ALCERIS" || (p2stateno != 1205 && p2stateno != 2200)
trigger1 = StateNo = 1205
trigger1 = AnimElemTime(9) <= 0
trigger2 = StateNo = 2200
trigger2 = AnimElemTime(6) <= 0
x = (fvar(0)-(enemynear,pos X+camerapos X))*-facing
ignorehitpause = 1

[State 0, Turn]
type = Turn
trigger1 = ishelper(910)
trigger1 = parent,movetype != H
trigger1 = facing != parent,facing
ignorehitpause = 1 

[State 0, HitOverride]
type = HitOverride
trigger1 = ishelper(910)
attr = ,AA,AP,AT
slot = 0
stateno = -1
time = -1
forceair = 0
ignorehitpause = 1
nothitstate = 1
allproj = 1
allhelpers = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = ishelper(910)
value = 0
movecamera = 0,0
ignorehitpause = 1

[State 0, BindToParent]
type = BindToParent
trigger1 = ishelper(910)
time = 1
pos = 10,0
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = ishelper(910)
x = parent,pos X + (10*facing)
y = parent,pos Y
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = ishelper(910)
flag = invisible

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = ishelper(910)
trigger1 = anim != 910
value = 910
ignorehitpause = 1

[State 0, HitOverride]
type = Null;HitOverride
trigger1 = 1
attr = SCA,AA,AP,AT
slot = 0
stateno = 910
time = 1
forceair = 0
ignorehitpause = 1
persistent = 1

[State 0, ParentVarSet]
type = ParentVarSet
triggerall = ishelper(910)
trigger1 = !hitshakeover
trigger2 = gethitvar(hitcount) > var(7)
var(0) = 10

[State 0, Turn]
type = Turn
trigger1 = !ishelper
trigger1 = anim = 900
trigger1 = var(0)
trigger1 = facing != helper(910),facing

[State 0, PowerAdd]
type = PowerAdd
triggerall = ishelper(910)
trigger1 = GetHitVar(damage)
value = abs(GetHitVar(damage))*7
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
triggerall = ishelper(910)
triggerall = !parent,var(0) || parent,anim != 900 || parent,stateno != 900
trigger1 = parent,anim != 900 || parent,stateno != 900
trigger2 = parent,facing = 1
trigger2 = fvar(0) < parent,pos X+camerapos X
trigger3 = parent,facing = -1
trigger3 = parent,pos X+camerapos X < fvar(0)
value = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

[State 0, VarSet]
type = Null;VarSet
trigger1 = !ishelper
trigger1 = stateno != 900
trigger2 = ishelper(910)
fvar(0) = enemynear,pos X+camerapos X
ignorehitpause = 1

[State 0, Offset]
type = Offset
trigger1 = ishelper(910)
y = -70
ignorehitpause = 1

[State 0, SprPriority]
type = SprPriority
triggerall = ishelper(910)
trigger1 = parent,anim != 900
value = 2
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
triggerall = ishelper(910)
trigger1 = parent,anim = 900
value = 1
ignorehitpause = 1

[State 0, VarAdd]
type = VarAdd
triggerall = ishelper(910)
trigger1 = var(0) < 10
trigger1 = parent,anim = 900
trigger1 = !pause && !super
var(0) = 1
ignorehitpause = 1

[State 0, VarAdd]
type = VarAdd
triggerall = ishelper(910)
triggerall = var(0) > 0
triggerall = !pause && !super
trigger1 = parent,anim != 900
trigger2 = parent,stateno != 900
var(0) = -1
ignorehitpause = 1

[State 200, 剣閃エフェ]
type = Explod
trigger1 = ishelper(910)
trigger1 = !numexplod(910)
anim = 910
id = 910
pos = 10,0
postype = p1
ownpal = 1
bindtime = -1
removetime = -1
bindid = parent,id
yangle = 45
removeongethit = 0
ignorehitpause = 1

[State 0, VarAdd]
type = VarSet
trigger1 = ishelper(910)
trigger1 = !pause && !super
var(4) = (var(4)-6)%360

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = ishelper(910)
trigger1 = numexplod(910)
id = 910
angle = var(4)
yangle = 45
scale = var(0)*0.04,var(0)*0.04

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = ishelper(910)
trigger1 = numexplod(910)
trigger1 = parent,anim != 900
id = 910
sprpriority = 2

[State 0, AngleDraw]
type = AngleDraw
trigger1 = ishelper(910)
scale = var(0)*0.04,var(0)*0.04
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = ishelper(910)
movetype = I

[State 0, DestroySelf]
type = DestroySelf
triggerall = ishelper(910)
triggerall = var(0) = 0
trigger1 = parent,anim != 900
trigger2 = parent,stateno != 900
removeexplods = 1
ignorehitpause = 1

[State 0, SelfState]
type = SelfState
trigger1 = ishelper(910)
value = 910
ignorehitpause = 1

[State 0, SelfState]
type = SelfState
trigger1 = ishelper(11000)
trigger1 = stateno != 11000
value = 11000
ignorehitpause = 1

[State 0, VarSet]
type = Null;VarSet
triggerall = !ishelper
triggerall = !inguarddist
trigger1 = enemy(0),movetype != A && cond(numenemy = 2,enemy(1),movetype != A,1)
var(4) = 0

[State 0, NotHitBy]
type = Null;NotHitBy
triggerall = !ishelper
trigger1 = var(0)
value2 = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

[State 0, VarAdd]
type = Null;VarAdd
triggerall = var(0) > 0
trigger1 = stateno != 900
var(0) = -1
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
triggerall = !ishelper
trigger1 = !fighting && !lose
value2 = SCA,AA,AP,AT
time = 1
ignorehitpause = 1

[State 0, SelfState]
type = Null;SelfState
triggerall = !ishelper
trigger1 = var(3) != gametime
value = var(20)
ctrl = (var(20) = [0,20]) || (var(20) = [50,52]) || (var(20) = [100,101]) || (var(20) = [120,132])

[State 0, RemoveExplod]
type = RemoveExplod
triggerall = !ishelper
trigger1 = NumExplod(1006)
trigger1 = stateno != 1050
id = 1006

[State 0, RemoveExplod]
type = RemoveExplod
triggerall = !ishelper
trigger1 = NumExplod(700)
trigger1 = stateno != 700
id = 700

[State 0, RemoveExplod]
type = RemoveExplod
triggerall = !ishelper
trigger1 = NumExplod(1101)
trigger1 = stateno != 1100
id = 1101

[State 0, RemoveExplod]
type = RemoveExplod
triggerall = !ishelper
trigger1 = NumExplod(1105)
trigger1 = stateno != 1105
id = 1105

[State 0, SelfState]
type = SelfState
trigger1 = !ishelper
trigger1 = anim = 900
trigger1 = var(0)
value = 900

;=============================================================================
; ダメージボイス
;=============================================================================
[state -2, 弱]
type = PlaySnd
triggerall = !ishelper
triggerall = stateno = 5000 ||  stateno = 5010 || stateno = 5020
triggerall = !time
triggerall = alive = 1
trigger1 = GetHitVar(animtype) = 0
trigger2 = GetHitVar(animtype) = 1
trigger3 = GetHitVar(animtype) = 2
value = S100,cond(GetHitVar(animtype) = 0,81 + (random%2),83 + (random%2))
channel = 0

[state -2, 強]
type = PlaySnd
triggerall = !ishelper
triggerall = prevstateno != [5000,5900]
triggerall = stateno = 5000 ||  stateno = 5010 || stateno = 5020
triggerall = !time
triggerall = alive = 1
trigger1 = GetHitVar(animtype) = 3
trigger2 = GetHitVar(animtype) = 4
trigger3 = GetHitVar(fall)
value = S100,85+random%2
channel = 0

[state -2, ガードボイス]
type = PlaySnd
triggerall = !ishelper
triggerall = stateno = 150 || stateno = 152 || stateno = 154
triggerall = hitshakeover
trigger1 = random%2
value = S100,cond((random%8 = 0),56,45+(random%7))
channel = 4
lowpriority = 1
ignorehitpause = 1

;[Statedef -3]
;
;[State 0, VarSet]
;type = VarSet
;trigger1 = !ishelper
;trigger1 = movetype != H
;v = 3
;value = gametime
;ignorehitpause = 1
;
;[State 0, VarSet]
;type = VarSet
;trigger1 = !ishelper
;trigger1 = movetype != H
;v = 20
;value = stateno
